local _, ns = ...
--- @type NAG|AceAddon
local NAG = LibStub("AceAddon-3.0"):GetAddon("NAG")
local L = LibStub("AceLocale-3.0"):GetLocale("NAG", true)
--- @type Version
local Version = ns.Version
--- @type SpellTrackingManager|AceModule|ModuleBase
local SpellTracker = NAG:GetModule("SpellTrackingManager")
local SpecializationCompat = ns.SpecializationCompat

-- Dynamically build spec table for WARLOCK
local specNames = { "AFFLICTION", "DEMONOLOGY", "DESTRUCTION" }
local CLASS_SPECS = {}
for i, name in ipairs(specNames) do
    CLASS_SPECS[name] = SpecializationCompat:GetSpecID("WARLOCK", i)
end

local defaults = ns.InitializeClassDefaults()

-- MoP Warlock spec spell locations
defaults.class.specSpellLocations = {
    [CLASS_SPECS.AFFLICTION] = {
        ABOVE = { 1454, 28176, 80398 },
        BELOW = { 691 },
        RIGHT = { 47897, 27243, 74434 },
        LEFT = { 77801, 18540, 33702, 26297, 86121 },
        AOE = {}
    },
    [CLASS_SPECS.DEMONOLOGY] = {
        ABOVE = { 1454, 28176, 80398 },
        BELOW = { 30146, 691 },
        RIGHT = { 47897, 50589, 1122, 89751, 1949 },
        LEFT = { 77801, 47241, 74434, 18540, 33702, 26297 },
        AOE = {}
    },
    [CLASS_SPECS.DESTRUCTION] = {
        ABOVE = { 1454, 28176, 80398 },
        BELOW = { 688 },
        RIGHT = { 47897, 1122, 5740 },
        LEFT = { 77801, 18540, 74434, 33702, 26297 },
        AOE = {}
    }
}

-- ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ 
-- Leave below as is

if UnitClassBase('player') ~= "WARLOCK" then return end

-- START OF GENERATED_ROTATIONS

ns.AddRotationToDefaults(defaults,
    SpecializationCompat:GetSpecID("Warlock", "Destruction"),
    "Warlock Destruction - Default by APLParser",
    {
        -- Required parameters
        default = false,
        enabled = true,
        experimental = false,
        gameType = Version.GAME_TYPES.CLASSIC_MISTS,
        prePull = {
            { NAG:Cast(76093), -1750 }, { NAG:Cast(29722), -1750 }
        },
        rotationString = [[
            NAG:AutocastOtherCooldowns()
    or NAG:StrictSequence("someName449", NAG:Cast(113858), NAG:Cast(26297), NAG:Cast(348), NAG:Cast(104232))
    or (NAG:RemainingTime() <= 61) and NAG:Cast(18540)
    or ((NAG:IsExecutePhase(20) and ((NAG:AuraRemainingTime(113858) > 5) or NAG:AllTrinketStatProcsActive(3) or ((NAG:RemainingTime() < 55) and NAG:AuraIsActiveWithReactionTime(126577)) or (NAG:AuraRemainingTime(126577) > 18))) or (NAG:RemainingTime() < 22)) and NAG:Cast(76093)
    or ((NAG:RemainingTime() <= 22.0) or (NAG:SpellTimeToCharge(113858) == 0.0) or ((NAG:SpellNumCharges(113858) >= 1) and (NAG:SpellTimeToCharge(113858) <= 57.0) and (NAG:RemainingTime() <= 77.0)) or (NAG:AuraRemainingTime(76093) >= 20.0)) and NAG:Cast(113858)
    or (NAG:AuraIsActive(113858) or NAG:AuraIsActive(126577) or NAG:AuraIsActive(76093)) and NAG:Cast(33697)
    or (NAG:AuraIsActive(113858) or NAG:AuraIsActive(76093)) and NAG:Cast(26297)
    or ((NAG:RemainingTime() > 66) or (NAG:AuraIsActive(113858) or NAG:AuraIsActive(76093))) and NAG:Cast(126734)
    or NAG:Cast(111897)
    or ((not NAG:DotIsActive(104232)) and (NAG:AuraICDIsReadyWithReactionTime(126577) or (NAG:NumberTargets() > 1))) and NAG:Cast(104232)
    or ((NAG:RemainingTime() < 6.0)) and NAG:Cast(17877)
    or ((NAG:CurrentGenericResource() > 36) and (NAG:AuraNumStacks(117828) < 3)) and NAG:Cast(116858)
    or (NAG:SpellNumCharges(17962) == 2) and NAG:Cast(17962)
    or ((not NAG:DotIsActive(348)) and NAG:Cast(348))
    or ((NAG:DotIsActive(348) and NAG:ShouldMultidot(348, 3, (NAG:DotTickFrequency(348) + NAG:SpellCastTime(348)))) and NAG:Cast(348, "RIGHT"))
    or ((NAG:DotRemainingTime(348) <= NAG:DotTickFrequency(348)) or (((NAG:SpellCastTime(348) < NAG:AuraRemainingTime(113858))) and (NAG:DotRemainingTime(348) < 7.5))) and NAG:Cast(348)
    or ((((NAG:SpellCastTime(116858) < NAG:AuraRemainingTime(76093)) or (NAG:SpellCastTime(116858) < NAG:AuraRemainingTime(114206)) or (NAG:SpellCastTime(116858) < NAG:AuraRemainingTime(126734)) or (NAG:SpellCastTime(116858) < NAG:AuraRemainingTime(113858))) or ((NAG:SpellCastTime(116858) < NAG:AuraRemainingTime(104993)) and (((NAG:CurrentGenericResource() + (NAG:AuraInternalCooldown(126577) * 0.8)) > 30) or ((NAG:CurrentGenericResource() + (NAG:AuraInternalCooldown(125487) * 0.8)) > 30) or ((NAG:CurrentGenericResource() + (NAG:SpellTimeToReady(114207) * 0.8)) > 30) or ((NAG:CurrentGenericResource() + (NAG:SpellTimeToReady(126734) * 0.8)) > 30) or ((NAG:SpellNumCharges(113858) >= 1) and ((NAG:CurrentGenericResource() + (NAG:SpellTimeToCharge(113858) * 0.8)) > 30))))) and (NAG:AuraNumStacks(117828) < 3)) and NAG:Cast(116858)
    or (NAG:IsExecutePhase(20) and (NAG:AuraIsActiveWithReactionTime(113858) or NAG:AuraIsActiveWithReactionTime(76093) or NAG:AuraIsActiveWithReactionTime(126577) or NAG:AuraIsActiveWithReactionTime(126734))) and NAG:Cast(17877)
    or NAG:AuraIsInactiveWithReactionTime(117828) and NAG:Cast(17962)
    or NAG:AuraIsActive(117828) and NAG:Cast(29722)
    or NAG:Cast(17962)
    or NAG:Cast(29722)
        ]],
        
        -- New action-based format
        --prePullActions = {{action = {castSpell = {spellId = {otherId = "OtherActionPotion"}}}, doAtValue = {const = {val = "-1.75s"}}}, {action = {castSpell = {spellId = {spellId = 29722}}}, doAtValue = {const = {val = "-1.75s"}}}},
        --aplActions = {{action = {autocastOtherCooldowns = {}}}, {action = {strictSequence = {actions = {{castSpell = {spellId = {spellId = 113858}}}, {castSpell = {spellId = {spellId = 26297}}}, {castSpell = {spellId = {spellId = 348}}}, {castSpell = {spellId = {spellId = 104232}}}}, name = "someName449"}}}, {action = {condition = {cmp = {op = "OpLe", lhs = {remainingTime = {}}, rhs = {const = {val = "61"}}}}, castSpell = {spellId = {spellId = 18540}}}}, {action = {condition = {or = {vals = {{and = {vals = {{isExecutePhase = {threshold = "E20"}}, {or = {vals = {{cmp = {op = "OpGt", lhs = {auraRemainingTime = {auraId = {spellId = 113858}}}, rhs = {const = {val = "5"}}}}, {allTrinketStatProcsActive = {statType1 = 3, statType2 = -1, statType3 = -1}}, {and = {vals = {{cmp = {op = "OpLt", lhs = {remainingTime = {}}, rhs = {const = {val = "55"}}}}, {auraIsActiveWithReactionTime = {auraId = {spellId = 126577}}}}}}, {cmp = {op = "OpGt", lhs = {auraRemainingTime = {auraId = {spellId = 126577}}}, rhs = {const = {val = "18"}}}}}}}}}}, {cmp = {op = "OpLt", lhs = {remainingTime = {}}, rhs = {const = {val = "22"}}}}}}}, castSpell = {spellId = {itemId = 76093}}}}, {action = {condition = {or = {vals = {{cmp = {op = "OpLe", lhs = {remainingTime = {}}, rhs = {const = {val = "22s"}}}}, {cmp = {op = "OpEq", lhs = {spellTimeToCharge = {spellId = {spellId = 113858}}}, rhs = {const = {val = "0s"}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {spellNumCharges = {spellId = {spellId = 113858}}}, rhs = {const = {val = "1"}}}}, {cmp = {op = "OpLe", lhs = {spellTimeToCharge = {spellId = {spellId = 113858}}}, rhs = {const = {val = "57s"}}}}, {cmp = {op = "OpLe", lhs = {remainingTime = {}}, rhs = {const = {val = "77s"}}}}}}}, {cmp = {op = "OpGe", lhs = {auraRemainingTime = {auraId = {itemId = 76093}}}, rhs = {const = {val = "20s"}}}}}}}, castSpell = {spellId = {spellId = 113858}}}}, {action = {condition = {or = {vals = {{auraIsActive = {auraId = {spellId = 113858}}}, {auraIsActive = {auraId = {spellId = 126577}}}, {auraIsActive = {auraId = {itemId = 76093}}}}}}, castSpell = {spellId = {spellId = 33697}}}}, {action = {condition = {or = {vals = {{auraIsActive = {auraId = {spellId = 113858}}}, {auraIsActive = {auraId = {itemId = 76093}}}}}}, castSpell = {spellId = {spellId = 26297}}}}, {action = {condition = {or = {vals = {{cmp = {op = "OpGt", lhs = {remainingTime = {}}, rhs = {const = {val = "66"}}}}, {or = {vals = {{auraIsActive = {auraId = {spellId = 113858}}}, {auraIsActive = {auraId = {itemId = 76093}}}}}}}}}, castSpell = {spellId = {spellId = 126734}}}}, {action = {castSpell = {spellId = {spellId = 111897}}}}, {action = {condition = {and = {vals = {{not = {val = {dotIsActive = {spellId = {spellId = 104232}}}}}, {or = {vals = {{auraIcdIsReadyWithReactionTime = {auraId = {spellId = 126577}}}, {cmp = {op = "OpGt", lhs = {numberTargets = {}}, rhs = {const = {val = "1"}}}}}}}}}}, castSpell = {spellId = {spellId = 104232}}}}, {action = {condition = {or = {vals = {{cmp = {op = "OpLt", lhs = {remainingTime = {}}, rhs = {const = {val = "6s"}}}}}}}, castSpell = {spellId = {spellId = 17877}}}}, {action = {condition = {and = {vals = {{cmp = {op = "OpGt", lhs = {currentGenericResource = {}}, rhs = {const = {val = "36"}}}}, {cmp = {op = "OpLt", lhs = {auraNumStacks = {auraId = {spellId = 117828}}}, rhs = {const = {val = "3"}}}}}}}, castSpell = {spellId = {spellId = 116858}}}}, {action = {condition = {cmp = {op = "OpEq", lhs = {spellNumCharges = {spellId = {spellId = 17962}}}, rhs = {const = {val = "2"}}}}, castSpell = {spellId = {spellId = 17962}}}}, {action = {multidot = {spellId = {spellId = 348}, maxDots = 3, maxOverlap = {math = {op = "OpAdd", lhs = {dotTickFrequency = {spellId = {spellId = 348}}}, rhs = {spellCastTime = {spellId = {spellId = 348}}}}}}}}, {action = {condition = {or = {vals = {{cmp = {op = "OpLe", lhs = {dotRemainingTime = {spellId = {spellId = 348}}}, rhs = {dotTickFrequency = {spellId = {spellId = 348}}}}}, {and = {vals = {{or = {vals = {{cmp = {op = "OpLt", lhs = {spellCastTime = {spellId = {spellId = 348}}}, rhs = {auraRemainingTime = {auraId = {spellId = 113858}}}}}}}}, {cmp = {op = "OpLt", lhs = {dotRemainingTime = {spellId = {spellId = 348}}}, rhs = {const = {val = "7.5"}}}}}}}}}}, castSpell = {spellId = {spellId = 348}}}}, {action = {condition = {and = {vals = {{}, {or = {vals = {{or = {vals = {{cmp = {op = "OpLt", lhs = {spellCastTime = {spellId = {spellId = 116858}}}, rhs = {auraRemainingTime = {auraId = {itemId = 76093}}}}}, {cmp = {op = "OpLt", lhs = {spellCastTime = {spellId = {spellId = 116858}}}, rhs = {auraRemainingTime = {auraId = {spellId = 114206, tag = -1}}}}}, {cmp = {op = "OpLt", lhs = {spellCastTime = {spellId = {spellId = 116858}}}, rhs = {auraRemainingTime = {auraId = {spellId = 126734}}}}}, {cmp = {op = "OpLt", lhs = {spellCastTime = {spellId = {spellId = 116858}}}, rhs = {auraRemainingTime = {auraId = {spellId = 113858}}}}}}}}, {and = {vals = {{cmp = {op = "OpLt", lhs = {spellCastTime = {spellId = {spellId = 116858}}}, rhs = {auraRemainingTime = {auraId = {spellId = 104993, tag = 1}}}}}, {or = {vals = {{cmp = {op = "OpGt", lhs = {math = {op = "OpAdd", lhs = {currentGenericResource = {}}, rhs = {math = {op = "OpMul", lhs = {auraInternalCooldown = {auraId = {spellId = 126577}}}, rhs = {const = {val = "0.8"}}}}}}, rhs = {const = {val = "30"}}}}, {cmp = {op = "OpGt", lhs = {math = {op = "OpAdd", lhs = {currentGenericResource = {}}, rhs = {math = {op = "OpMul", lhs = {auraInternalCooldown = {auraId = {spellId = 125487}}}, rhs = {const = {val = "0.8"}}}}}}, rhs = {const = {val = "30"}}}}, {cmp = {op = "OpGt", lhs = {math = {op = "OpAdd", lhs = {currentGenericResource = {}}, rhs = {math = {op = "OpMul", lhs = {spellTimeToReady = {spellId = {spellId = 114207, tag = -1}}}, rhs = {const = {val = "0.8"}}}}}}, rhs = {const = {val = "30"}}}}, {cmp = {op = "OpGt", lhs = {math = {op = "OpAdd", lhs = {currentGenericResource = {}}, rhs = {math = {op = "OpMul", lhs = {spellTimeToReady = {spellId = {spellId = 126734}}}, rhs = {const = {val = "0.8"}}}}}}, rhs = {const = {val = "30"}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {spellNumCharges = {spellId = {spellId = 113858}}}, rhs = {const = {val = "1"}}}}, {cmp = {op = "OpGt", lhs = {math = {op = "OpAdd", lhs = {currentGenericResource = {}}, rhs = {math = {op = "OpMul", lhs = {spellTimeToCharge = {spellId = {spellId = 113858}}}, rhs = {const = {val = "0.8"}}}}}}, rhs = {const = {val = "30"}}}}}}}}}}}}}}}}, {cmp = {op = "OpLt", lhs = {auraNumStacks = {auraId = {spellId = 117828}}}, rhs = {const = {val = "3"}}}}}}}, castSpell = {spellId = {spellId = 116858}}}}, {action = {condition = {and = {vals = {{isExecutePhase = {threshold = "E20"}}, {or = {vals = {{auraIsActiveWithReactionTime = {auraId = {spellId = 113858}}}, {auraIsActiveWithReactionTime = {auraId = {itemId = 76093}}}, {auraIsActiveWithReactionTime = {auraId = {spellId = 126577}}}, {auraIsActiveWithReactionTime = {auraId = {spellId = 126734}}}}}}}}}, castSpell = {spellId = {spellId = 17877}}}}, {action = {condition = {auraIsInactiveWithReactionTime = {auraId = {spellId = 117828}}}, castSpell = {spellId = {spellId = 17962}}}}, {action = {condition = {auraIsActive = {auraId = {spellId = 117828}}}, castSpell = {spellId = {spellId = 29722}}}}, {action = {castSpell = {spellId = {spellId = 17962}}}}, {action = {castSpell = {spellId = {spellId = 29722}}}}},

        -- Tracked IDs for optimization
        spells = {348, 17877, 17962, 18540, 26297, 29722, 33697, 104232, 104993, 111897, 113858, 114206, 114207, 116858, 117828, 125487, 126577, 126734},
        items = {76093},
        auras = {},
        runes = {},

        -- Optional metadata
        glyphs = {},
        lastModified = "07/03/2025",
        author = "APLParser",

        -- Serialized JSON for straight APL reading
        --rotation_json = [[[{"action":{"autocastOtherCooldowns":{}}},{"action":{"strictSequence":{"actions":[{"castSpell":{"spellId":{"spellId":113858}}},{"castSpell":{"spellId":{"spellId":26297}}},{"castSpell":{"spellId":{"spellId":348}}},{"castSpell":{"spellId":{"spellId":104232}}}],"name":"someName449"}}},{"action":{"condition":{"cmp":{"op":"OpLe","lhs":{"remainingTime":{}},"rhs":{"const":{"val":"61"}}}},"castSpell":{"spellId":{"spellId":18540}}}},{"action":{"condition":{"or":{"vals":[{"and":{"vals":[{"isExecutePhase":{"threshold":"E20"}},{"or":{"vals":[{"cmp":{"op":"OpGt","lhs":{"auraRemainingTime":{"auraId":{"spellId":113858}}},"rhs":{"const":{"val":"5"}}}},{"allTrinketStatProcsActive":{"statType1":3,"statType2":-1,"statType3":-1}},{"and":{"vals":[{"cmp":{"op":"OpLt","lhs":{"remainingTime":{}},"rhs":{"const":{"val":"55"}}}},{"auraIsActiveWithReactionTime":{"auraId":{"spellId":126577}}}]}},{"cmp":{"op":"OpGt","lhs":{"auraRemainingTime":{"auraId":{"spellId":126577}}},"rhs":{"const":{"val":"18"}}}}]}}]}},{"cmp":{"op":"OpLt","lhs":{"remainingTime":{}},"rhs":{"const":{"val":"22"}}}}]}},"castSpell":{"spellId":{"itemId":76093}}}},{"action":{"condition":{"or":{"vals":[{"cmp":{"op":"OpLe","lhs":{"remainingTime":{}},"rhs":{"const":{"val":"22s"}}}},{"cmp":{"op":"OpEq","lhs":{"spellTimeToCharge":{"spellId":{"spellId":113858}}},"rhs":{"const":{"val":"0s"}}}},{"and":{"vals":[{"cmp":{"op":"OpGe","lhs":{"spellNumCharges":{"spellId":{"spellId":113858}}},"rhs":{"const":{"val":"1"}}}},{"cmp":{"op":"OpLe","lhs":{"spellTimeToCharge":{"spellId":{"spellId":113858}}},"rhs":{"const":{"val":"57s"}}}},{"cmp":{"op":"OpLe","lhs":{"remainingTime":{}},"rhs":{"const":{"val":"77s"}}}}]}},{"cmp":{"op":"OpGe","lhs":{"auraRemainingTime":{"auraId":{"itemId":76093}}},"rhs":{"const":{"val":"20s"}}}}]}},"castSpell":{"spellId":{"spellId":113858}}}},{"action":{"condition":{"or":{"vals":[{"auraIsActive":{"auraId":{"spellId":113858}}},{"auraIsActive":{"auraId":{"spellId":126577}}},{"auraIsActive":{"auraId":{"itemId":76093}}}]}},"castSpell":{"spellId":{"spellId":33697}}}},{"action":{"condition":{"or":{"vals":[{"auraIsActive":{"auraId":{"spellId":113858}}},{"auraIsActive":{"auraId":{"itemId":76093}}}]}},"castSpell":{"spellId":{"spellId":26297}}}},{"action":{"condition":{"or":{"vals":[{"cmp":{"op":"OpGt","lhs":{"remainingTime":{}},"rhs":{"const":{"val":"66"}}}},{"or":{"vals":[{"auraIsActive":{"auraId":{"spellId":113858}}},{"auraIsActive":{"auraId":{"itemId":76093}}}]}}]}},"castSpell":{"spellId":{"spellId":126734}}}},{"action":{"castSpell":{"spellId":{"spellId":111897}}}},{"action":{"condition":{"and":{"vals":[{"not":{"val":{"dotIsActive":{"spellId":{"spellId":104232}}}}},{"or":{"vals":[{"auraIcdIsReadyWithReactionTime":{"auraId":{"spellId":126577}}},{"cmp":{"op":"OpGt","lhs":{"numberTargets":{}},"rhs":{"const":{"val":"1"}}}}]}}]}},"castSpell":{"spellId":{"spellId":104232}}}},{"action":{"condition":{"or":{"vals":[{"cmp":{"op":"OpLt","lhs":{"remainingTime":{}},"rhs":{"const":{"val":"6s"}}}}]}},"castSpell":{"spellId":{"spellId":17877}}}},{"action":{"condition":{"and":{"vals":[{"cmp":{"op":"OpGt","lhs":{"currentGenericResource":{}},"rhs":{"const":{"val":"36"}}}},{"cmp":{"op":"OpLt","lhs":{"auraNumStacks":{"auraId":{"spellId":117828}}},"rhs":{"const":{"val":"3"}}}}]}},"castSpell":{"spellId":{"spellId":116858}}}},{"action":{"condition":{"cmp":{"op":"OpEq","lhs":{"spellNumCharges":{"spellId":{"spellId":17962}}},"rhs":{"const":{"val":"2"}}}},"castSpell":{"spellId":{"spellId":17962}}}},{"action":{"multidot":{"spellId":{"spellId":348},"maxDots":3,"maxOverlap":{"math":{"op":"OpAdd","lhs":{"dotTickFrequency":{"spellId":{"spellId":348}}},"rhs":{"spellCastTime":{"spellId":{"spellId":348}}}}}}}},{"action":{"condition":{"or":{"vals":[{"cmp":{"op":"OpLe","lhs":{"dotRemainingTime":{"spellId":{"spellId":348}}},"rhs":{"dotTickFrequency":{"spellId":{"spellId":348}}}}},{"and":{"vals":[{"or":{"vals":[{"cmp":{"op":"OpLt","lhs":{"spellCastTime":{"spellId":{"spellId":348}}},"rhs":{"auraRemainingTime":{"auraId":{"spellId":113858}}}}}]}},{"cmp":{"op":"OpLt","lhs":{"dotRemainingTime":{"spellId":{"spellId":348}}},"rhs":{"const":{"val":"7.5"}}}}]}}]}},"castSpell":{"spellId":{"spellId":348}}}},{"action":{"condition":{"and":{"vals":[{},{"or":{"vals":[{"or":{"vals":[{"cmp":{"op":"OpLt","lhs":{"spellCastTime":{"spellId":{"spellId":116858}}},"rhs":{"auraRemainingTime":{"auraId":{"itemId":76093}}}}},{"cmp":{"op":"OpLt","lhs":{"spellCastTime":{"spellId":{"spellId":116858}}},"rhs":{"auraRemainingTime":{"auraId":{"spellId":114206,"tag":-1}}}}},{"cmp":{"op":"OpLt","lhs":{"spellCastTime":{"spellId":{"spellId":116858}}},"rhs":{"auraRemainingTime":{"auraId":{"spellId":126734}}}}},{"cmp":{"op":"OpLt","lhs":{"spellCastTime":{"spellId":{"spellId":116858}}},"rhs":{"auraRemainingTime":{"auraId":{"spellId":113858}}}}}]}},{"and":{"vals":[{"cmp":{"op":"OpLt","lhs":{"spellCastTime":{"spellId":{"spellId":116858}}},"rhs":{"auraRemainingTime":{"auraId":{"spellId":104993,"tag":1}}}}},{"or":{"vals":[{"cmp":{"op":"OpGt","lhs":{"math":{"op":"OpAdd","lhs":{"currentGenericResource":{}},"rhs":{"math":{"op":"OpMul","lhs":{"auraInternalCooldown":{"auraId":{"spellId":126577}}},"rhs":{"const":{"val":"0.8"}}}}}},"rhs":{"const":{"val":"30"}}}},{"cmp":{"op":"OpGt","lhs":{"math":{"op":"OpAdd","lhs":{"currentGenericResource":{}},"rhs":{"math":{"op":"OpMul","lhs":{"auraInternalCooldown":{"auraId":{"spellId":125487}}},"rhs":{"const":{"val":"0.8"}}}}}},"rhs":{"const":{"val":"30"}}}},{"cmp":{"op":"OpGt","lhs":{"math":{"op":"OpAdd","lhs":{"currentGenericResource":{}},"rhs":{"math":{"op":"OpMul","lhs":{"spellTimeToReady":{"spellId":{"spellId":114207,"tag":-1}}},"rhs":{"const":{"val":"0.8"}}}}}},"rhs":{"const":{"val":"30"}}}},{"cmp":{"op":"OpGt","lhs":{"math":{"op":"OpAdd","lhs":{"currentGenericResource":{}},"rhs":{"math":{"op":"OpMul","lhs":{"spellTimeToReady":{"spellId":{"spellId":126734}}},"rhs":{"const":{"val":"0.8"}}}}}},"rhs":{"const":{"val":"30"}}}},{"and":{"vals":[{"cmp":{"op":"OpGe","lhs":{"spellNumCharges":{"spellId":{"spellId":113858}}},"rhs":{"const":{"val":"1"}}}},{"cmp":{"op":"OpGt","lhs":{"math":{"op":"OpAdd","lhs":{"currentGenericResource":{}},"rhs":{"math":{"op":"OpMul","lhs":{"spellTimeToCharge":{"spellId":{"spellId":113858}}},"rhs":{"const":{"val":"0.8"}}}}}},"rhs":{"const":{"val":"30"}}}}]}}]}}]}}]}},{"cmp":{"op":"OpLt","lhs":{"auraNumStacks":{"auraId":{"spellId":117828}}},"rhs":{"const":{"val":"3"}}}}]}},"castSpell":{"spellId":{"spellId":116858}}}},{"action":{"condition":{"and":{"vals":[{"isExecutePhase":{"threshold":"E20"}},{"or":{"vals":[{"auraIsActiveWithReactionTime":{"auraId":{"spellId":113858}}},{"auraIsActiveWithReactionTime":{"auraId":{"itemId":76093}}},{"auraIsActiveWithReactionTime":{"auraId":{"spellId":126577}}},{"auraIsActiveWithReactionTime":{"auraId":{"spellId":126734}}}]}}]}},"castSpell":{"spellId":{"spellId":17877}}}},{"action":{"condition":{"auraIsInactiveWithReactionTime":{"auraId":{"spellId":117828}}},"castSpell":{"spellId":{"spellId":17962}}}},{"action":{"condition":{"auraIsActive":{"auraId":{"spellId":117828}}},"castSpell":{"spellId":{"spellId":29722}}}},{"action":{"castSpell":{"spellId":{"spellId":17962}}}},{"action":{"castSpell":{"spellId":{"spellId":29722}}}}]]],
        --prepull_json = [[[{"action":{"castSpell":{"spellId":{"otherId":"OtherActionPotion"}}},"doAtValue":{"const":{"val":"-1.75s"}}},{"action":{"castSpell":{"spellId":{"spellId":29722}}},"doAtValue":{"const":{"val":"-1.75s"}}}]]]
    }
)

ns.AddRotationToDefaults(defaults,
    SpecializationCompat:GetSpecID("Warlock", "Demonology"),
    "Warlock Demonology - Default by APLParser",
    {
        -- Required parameters
        default = false,
        enabled = true,
        experimental = false,
        gameType = Version.GAME_TYPES.CLASSIC_MISTS,
        prePull = {
            { NAG:Cast(76093), -1000 }, { NAG:Cast(6353), -1000 }, { NAG:Cast(105174), -750 }
        },
        rotationString = [[
            NAG:AutocastOtherCooldowns()
    or NAG:Cast(126734)
    or (((NAG:SpellTimeToCharge(113861) <= 20.0) and (NAG:SpellNumCharges(113861) >= 1)) or ((NAG:SpellNumCharges(113861) == 1) and NAG:AnyTrinketStatProcsActive(3) and (NAG:NumEquippedStatProcTrinkets(3) > 2)) or (NAG:RemainingTime() <= 22.0) or ((not NAG:AuraIsActive(113858)) and (NAG:AuraRemainingTime(2825) >= 15.0))) and NAG:Cast(113861)
    or NAG:AuraIsActive(113858) and NAG:Cast(76093)
    or NAG:AuraIsActive(113858) and NAG:Cast(111898)
    or (NAG:AuraIsActive(114925) or (NAG:CurrentTime() <= 10.0)) and NAG:Cast(104316)
    or NAG:AuraIsActive(113858) and NAG:Cast(18540)
    or (NAG:AuraIsActive(103958) and (((NAG:DotPercentIncrease(603) >= 0.25)) or ((NAG:DotPercentIncrease(603) >= 0.0) and (NAG:DotRemainingTime(603) <= 62.0) and NAG:AuraIsActive(2825)))) and NAG:Cast(603)
    or ((not NAG:DotIsActive(603)) and NAG:Cast(603))
    or ((NAG:AuraIsActive(103958)) and ((NAG:DotIsActive(603) and NAG:ShouldMultidot(603, 4, NAG:DotTickFrequency(603))) and NAG:Cast(603, "RIGHT")))
    or (NAG:AuraIsActive(103958) and (not NAG:AuraIsActive(113858)) and (NAG:CurrentGenericResource() <= 750) and (NAG:RemainingTime() > 30) and ((NAG:SpellTimeToReady(103958) <= 2.0) or (NAG:CurrentGenericResource() <= 400))) and NAG:CancelAura(103958)
    or (NAG:AuraIsActive(103958) and NAG:AuraIsActive(122355) and (NAG:AuraRemainingTime(113858) > NAG:SpellCastTime(6353)) and (NAG:CurrentGenericResource() >= 104)) and NAG:Cast(6353)
    or NAG:AuraIsActive(103958) and NAG:Cast(103964)
    or ((NAG:AuraIsActive(113858) and (NAG:AuraRemainingTime(113858) > 10.0) and (NAG:CurrentTime() > 5.0)) or ((NAG:CurrentGenericResource() > 200) and (NAG:CurrentTime() > 5.0))) and NAG:Cast(103958)
    or (NAG:SequenceIsComplete("hand") and (NAG:SpellTimeToCharge(105174) < 12.0)) and NAG:ResetSequence("hand")
    or ((not NAG:DotIsActive(172)) and NAG:Cast(172))
    or (((NAG:RemainingTime() > 6.0)) and ((NAG:DotIsActive(172) and NAG:ShouldMultidot(172, 4, NAG:DotTickFrequency(172))) and NAG:Cast(172, "RIGHT")))
    or (NAG:DotRemainingTime(47960) < (1.3 + NAG:SpellCastTime(686))) and NAG:Sequence("hand", NAG:Cast(105174))
    or (((NAG:AuraNumStacks(122355) > 1) or NAG:IsExecutePhase(25)) and NAG:AuraIsInactiveWithReactionTime(103958)) and NAG:Cast(6353)
    or ((NAG:CurrentManaPercent() < 0.3) and NAG:AuraIsInactiveWithReactionTime(103958)) and NAG:Cast(1454)
    or NAG:Cast(686)
    or NAG:Cast(1454)
        ]],
        
        -- New action-based format
        --prePullActions = {{action = {castSpell = {spellId = {otherId = "OtherActionPotion"}}}, doAtValue = {const = {val = "-4"}}}, {action = {castSpell = {spellId = {spellId = 6353}}}, doAtValue = {const = {val = "-4"}}}, {action = {castSpell = {spellId = {spellId = 105174}}}, doAtValue = {const = {val = "-0.75s"}}}},
        --aplActions = {{action = {autocastOtherCooldowns = {}}}, {action = {castSpell = {spellId = {spellId = 126734}}}}, {action = {condition = {or = {vals = {{and = {vals = {{cmp = {op = "OpLe", lhs = {spellTimeToCharge = {spellId = {spellId = 113861}}}, rhs = {const = {val = "20s"}}}}, {cmp = {op = "OpGe", lhs = {spellNumCharges = {spellId = {spellId = 113861}}}, rhs = {const = {val = "1"}}}}}}}, {and = {vals = {{cmp = {op = "OpEq", lhs = {spellNumCharges = {spellId = {spellId = 113861}}}, rhs = {const = {val = "1"}}}}, {anyTrinketStatProcsActive = {statType1 = 3, statType2 = -1, statType3 = -1}}, {cmp = {op = "OpGt", lhs = {numEquippedStatProcTrinkets = {statType1 = 3, statType2 = -1, statType3 = -1}}, rhs = {const = {val = "2"}}}}}}}, {cmp = {op = "OpLe", lhs = {remainingTime = {}}, rhs = {const = {val = "22s"}}}}, {and = {vals = {{not = {val = {auraIsActive = {auraId = {spellId = 113858}}}}}, {cmp = {op = "OpGe", lhs = {auraRemainingTime = {auraId = {spellId = 2825, tag = -1}}}, rhs = {const = {val = "15s"}}}}}}}}}}, castSpell = {spellId = {spellId = 113861}}}}, {action = {condition = {auraIsActive = {auraId = {spellId = 113858}}}, castSpell = {spellId = {otherId = "OtherActionPotion"}}}}, {action = {condition = {auraIsActive = {auraId = {spellId = 113858}}}, castSpell = {spellId = {spellId = 111898}}}}, {action = {condition = {or = {vals = {{auraIsActive = {auraId = {spellId = 114925}}}, {cmp = {op = "OpLe", lhs = {currentTime = {}}, rhs = {const = {val = "10s"}}}}}}}, castSpell = {spellId = {spellId = 104316}}}}, {action = {condition = {auraIsActive = {auraId = {spellId = 113858}}}, castSpell = {spellId = {spellId = 18540}}}}, {action = {condition = {and = {vals = {{auraIsActive = {auraId = {spellId = 103958}}}, {or = {vals = {{and = {vals = {{cmp = {op = "OpGe", lhs = {dotPercentIncrease = {spellId = {spellId = 603}}}, rhs = {const = {val = "25%"}}}}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {dotPercentIncrease = {spellId = {spellId = 603}}}, rhs = {const = {val = "0%"}}}}, {cmp = {op = "OpLe", lhs = {dotRemainingTime = {spellId = {spellId = 603}}}, rhs = {const = {val = "62s"}}}}, {auraIsActive = {auraId = {spellId = 2825, tag = -1}}}}}}}}}}}}, castSpell = {spellId = {spellId = 603}}}}, {action = {condition = {auraIsActive = {auraId = {spellId = 103958}}}, multidot = {spellId = {spellId = 603}, maxDots = 4, maxOverlap = {dotTickFrequency = {spellId = {spellId = 603}}}}}}, {action = {condition = {and = {vals = {{auraIsActive = {auraId = {spellId = 103958}}}, {not = {val = {auraIsActive = {auraId = {spellId = 113858}}}}}, {cmp = {op = "OpLe", lhs = {currentGenericResource = {}}, rhs = {const = {val = "750"}}}}, {cmp = {op = "OpGt", lhs = {remainingTime = {}}, rhs = {const = {val = "30"}}}}, {or = {vals = {{cmp = {op = "OpLe", lhs = {spellTimeToReady = {spellId = {spellId = 103958}}}, rhs = {const = {val = "2s"}}}}, {cmp = {op = "OpLe", lhs = {currentGenericResource = {}}, rhs = {const = {val = "400"}}}}}}}}}}, cancelAura = {auraId = {spellId = 103958}}}}, {action = {condition = {and = {vals = {{auraIsActive = {auraId = {spellId = 103958}}}, {auraIsActive = {auraId = {spellId = 122355}}}, {cmp = {op = "OpGt", lhs = {auraRemainingTime = {auraId = {spellId = 113858}}}, rhs = {spellCastTime = {spellId = {spellId = 6353}}}}}, {cmp = {op = "OpGe", lhs = {currentGenericResource = {}}, rhs = {const = {val = "104"}}}}}}}, castSpell = {spellId = {spellId = 6353}}}}, {action = {condition = {auraIsActive = {auraId = {spellId = 103958}}}, castSpell = {spellId = {spellId = 103964}}}}, {action = {condition = {or = {vals = {{and = {vals = {{auraIsActive = {auraId = {spellId = 113858}}}, {cmp = {op = "OpGt", lhs = {auraRemainingTime = {auraId = {spellId = 113858}}}, rhs = {const = {val = "10s"}}}}, {cmp = {op = "OpGt", lhs = {currentTime = {}}, rhs = {const = {val = "5s"}}}}}}}, {and = {vals = {{cmp = {op = "OpGt", lhs = {currentGenericResource = {}}, rhs = {const = {val = "200"}}}}, {cmp = {op = "OpGt", lhs = {currentTime = {}}, rhs = {const = {val = "5s"}}}}}}}}}}, castSpell = {spellId = {spellId = 103958}}}}, {action = {condition = {and = {vals = {{sequenceIsComplete = {sequenceName = "hand"}}, {cmp = {op = "OpLt", lhs = {spellTimeToCharge = {spellId = {spellId = 105174}}}, rhs = {const = {val = "12s"}}}}}}}, resetSequence = {sequenceName = "hand"}}}, {action = {condition = {cmp = {op = "OpGt", lhs = {remainingTime = {}}, rhs = {const = {val = "6s"}}}}, multidot = {spellId = {spellId = 172}, maxDots = 4, maxOverlap = {dotTickFrequency = {spellId = {spellId = 172}}}}}}, {action = {condition = {cmp = {op = "OpLt", lhs = {dotRemainingTime = {spellId = {spellId = 47960}}}, rhs = {math = {op = "OpAdd", lhs = {const = {val = "1.3s"}}, rhs = {spellCastTime = {spellId = {spellId = 686}}}}}}}, sequence = {name = "hand", actions = {{castSpell = {spellId = {spellId = 105174}}}}}}}, {action = {condition = {and = {vals = {{or = {vals = {{cmp = {op = "OpGt", lhs = {auraNumStacks = {auraId = {spellId = 122355}}}, rhs = {const = {val = "1"}}}}, {isExecutePhase = {threshold = "E25"}}}}}, {auraIsInactiveWithReactionTime = {auraId = {spellId = 103958}}}}}}, castSpell = {spellId = {spellId = 6353}}}}, {action = {condition = {and = {vals = {{cmp = {op = "OpLt", lhs = {currentManaPercent = {}}, rhs = {const = {val = "30%"}}}}, {auraIsInactiveWithReactionTime = {auraId = {spellId = 103958}}}}}}, castSpell = {spellId = {spellId = 1454}}}}, {action = {castSpell = {spellId = {spellId = 686}}}}, {action = {castSpell = {spellId = {spellId = 1454}}}}},

        -- Tracked IDs for optimization
        spells = {172, 603, 686, 1454, 2825, 6353, 18540, 47960, 103958, 103964, 104316, 105174, 111898, 113858, 113861, 114925, 122355, 126734},
        items = {76093},
        auras = {},
        runes = {},

        -- Optional metadata
        glyphs = {42470, 45785, 42465, 43389},
        lastModified = "07/03/2025",
        author = "APLParser",

        -- Serialized JSON for straight APL reading
        --rotation_json = [[[{"action":{"autocastOtherCooldowns":{}}},{"action":{"castSpell":{"spellId":{"spellId":126734}}}},{"action":{"condition":{"or":{"vals":[{"and":{"vals":[{"cmp":{"op":"OpLe","lhs":{"spellTimeToCharge":{"spellId":{"spellId":113861}}},"rhs":{"const":{"val":"20s"}}}},{"cmp":{"op":"OpGe","lhs":{"spellNumCharges":{"spellId":{"spellId":113861}}},"rhs":{"const":{"val":"1"}}}}]}},{"and":{"vals":[{"cmp":{"op":"OpEq","lhs":{"spellNumCharges":{"spellId":{"spellId":113861}}},"rhs":{"const":{"val":"1"}}}},{"anyTrinketStatProcsActive":{"statType1":3,"statType2":-1,"statType3":-1}},{"cmp":{"op":"OpGt","lhs":{"numEquippedStatProcTrinkets":{"statType1":3,"statType2":-1,"statType3":-1}},"rhs":{"const":{"val":"2"}}}}]}},{"cmp":{"op":"OpLe","lhs":{"remainingTime":{}},"rhs":{"const":{"val":"22s"}}}},{"and":{"vals":[{"not":{"val":{"auraIsActive":{"auraId":{"spellId":113858}}}}},{"cmp":{"op":"OpGe","lhs":{"auraRemainingTime":{"auraId":{"spellId":2825,"tag":-1}}},"rhs":{"const":{"val":"15s"}}}}]}}]}},"castSpell":{"spellId":{"spellId":113861}}}},{"action":{"condition":{"auraIsActive":{"auraId":{"spellId":113858}}},"castSpell":{"spellId":{"otherId":"OtherActionPotion"}}}},{"action":{"condition":{"auraIsActive":{"auraId":{"spellId":113858}}},"castSpell":{"spellId":{"spellId":111898}}}},{"action":{"condition":{"or":{"vals":[{"auraIsActive":{"auraId":{"spellId":114925}}},{"cmp":{"op":"OpLe","lhs":{"currentTime":{}},"rhs":{"const":{"val":"10s"}}}}]}},"castSpell":{"spellId":{"spellId":104316}}}},{"action":{"condition":{"auraIsActive":{"auraId":{"spellId":113858}}},"castSpell":{"spellId":{"spellId":18540}}}},{"action":{"condition":{"and":{"vals":[{"auraIsActive":{"auraId":{"spellId":103958}}},{"or":{"vals":[{"and":{"vals":[{"cmp":{"op":"OpGe","lhs":{"dotPercentIncrease":{"spellId":{"spellId":603}}},"rhs":{"const":{"val":"25%"}}}}]}},{"and":{"vals":[{"cmp":{"op":"OpGe","lhs":{"dotPercentIncrease":{"spellId":{"spellId":603}}},"rhs":{"const":{"val":"0%"}}}},{"cmp":{"op":"OpLe","lhs":{"dotRemainingTime":{"spellId":{"spellId":603}}},"rhs":{"const":{"val":"62s"}}}},{"auraIsActive":{"auraId":{"spellId":2825,"tag":-1}}}]}}]}}]}},"castSpell":{"spellId":{"spellId":603}}}},{"action":{"condition":{"auraIsActive":{"auraId":{"spellId":103958}}},"multidot":{"spellId":{"spellId":603},"maxDots":4,"maxOverlap":{"dotTickFrequency":{"spellId":{"spellId":603}}}}}},{"action":{"condition":{"and":{"vals":[{"auraIsActive":{"auraId":{"spellId":103958}}},{"not":{"val":{"auraIsActive":{"auraId":{"spellId":113858}}}}},{"cmp":{"op":"OpLe","lhs":{"currentGenericResource":{}},"rhs":{"const":{"val":"750"}}}},{"cmp":{"op":"OpGt","lhs":{"remainingTime":{}},"rhs":{"const":{"val":"30"}}}},{"or":{"vals":[{"cmp":{"op":"OpLe","lhs":{"spellTimeToReady":{"spellId":{"spellId":103958}}},"rhs":{"const":{"val":"2s"}}}},{"cmp":{"op":"OpLe","lhs":{"currentGenericResource":{}},"rhs":{"const":{"val":"400"}}}}]}}]}},"cancelAura":{"auraId":{"spellId":103958}}}},{"action":{"condition":{"and":{"vals":[{"auraIsActive":{"auraId":{"spellId":103958}}},{"auraIsActive":{"auraId":{"spellId":122355}}},{"cmp":{"op":"OpGt","lhs":{"auraRemainingTime":{"auraId":{"spellId":113858}}},"rhs":{"spellCastTime":{"spellId":{"spellId":6353}}}}},{"cmp":{"op":"OpGe","lhs":{"currentGenericResource":{}},"rhs":{"const":{"val":"104"}}}}]}},"castSpell":{"spellId":{"spellId":6353}}}},{"action":{"condition":{"auraIsActive":{"auraId":{"spellId":103958}}},"castSpell":{"spellId":{"spellId":103964}}}},{"action":{"condition":{"or":{"vals":[{"and":{"vals":[{"auraIsActive":{"auraId":{"spellId":113858}}},{"cmp":{"op":"OpGt","lhs":{"auraRemainingTime":{"auraId":{"spellId":113858}}},"rhs":{"const":{"val":"10s"}}}},{"cmp":{"op":"OpGt","lhs":{"currentTime":{}},"rhs":{"const":{"val":"5s"}}}}]}},{"and":{"vals":[{"cmp":{"op":"OpGt","lhs":{"currentGenericResource":{}},"rhs":{"const":{"val":"200"}}}},{"cmp":{"op":"OpGt","lhs":{"currentTime":{}},"rhs":{"const":{"val":"5s"}}}}]}}]}},"castSpell":{"spellId":{"spellId":103958}}}},{"action":{"condition":{"and":{"vals":[{"sequenceIsComplete":{"sequenceName":"hand"}},{"cmp":{"op":"OpLt","lhs":{"spellTimeToCharge":{"spellId":{"spellId":105174}}},"rhs":{"const":{"val":"12s"}}}}]}},"resetSequence":{"sequenceName":"hand"}}},{"action":{"condition":{"cmp":{"op":"OpGt","lhs":{"remainingTime":{}},"rhs":{"const":{"val":"6s"}}}},"multidot":{"spellId":{"spellId":172},"maxDots":4,"maxOverlap":{"dotTickFrequency":{"spellId":{"spellId":172}}}}}},{"action":{"condition":{"cmp":{"op":"OpLt","lhs":{"dotRemainingTime":{"spellId":{"spellId":47960}}},"rhs":{"math":{"op":"OpAdd","lhs":{"const":{"val":"1.3s"}},"rhs":{"spellCastTime":{"spellId":{"spellId":686}}}}}}},"sequence":{"name":"hand","actions":[{"castSpell":{"spellId":{"spellId":105174}}}]}}},{"action":{"condition":{"and":{"vals":[{"or":{"vals":[{"cmp":{"op":"OpGt","lhs":{"auraNumStacks":{"auraId":{"spellId":122355}}},"rhs":{"const":{"val":"1"}}}},{"isExecutePhase":{"threshold":"E25"}}]}},{"auraIsInactiveWithReactionTime":{"auraId":{"spellId":103958}}}]}},"castSpell":{"spellId":{"spellId":6353}}}},{"action":{"condition":{"and":{"vals":[{"cmp":{"op":"OpLt","lhs":{"currentManaPercent":{}},"rhs":{"const":{"val":"30%"}}}},{"auraIsInactiveWithReactionTime":{"auraId":{"spellId":103958}}}]}},"castSpell":{"spellId":{"spellId":1454}}}},{"action":{"castSpell":{"spellId":{"spellId":686}}}},{"action":{"castSpell":{"spellId":{"spellId":1454}}}}]]],
        --prepull_json = [[[{"action":{"castSpell":{"spellId":{"otherId":"OtherActionPotion"}}},"doAtValue":{"const":{"val":"-4"}}},{"action":{"castSpell":{"spellId":{"spellId":6353}}},"doAtValue":{"const":{"val":"-4"}}},{"action":{"castSpell":{"spellId":{"spellId":105174}}},"doAtValue":{"const":{"val":"-0.75s"}}}]]]
    }
)


ns.AddRotationToDefaults(defaults,
    SpecializationCompat:GetSpecID("Warlock", "Affliction"),
    "Warlock Affliction - Default by APLParser",
    {
        -- Required parameters
        default = true,
        enabled = true,
        experimental = true,
        gameType = Version.GAME_TYPES.CLASSIC_MISTS,
        prePull = {
            { NAG:Cast(74434), -20000 }, { NAG:Cast(76093), -1600 }, { NAG:Cast(48181), -1600 }
        },
        rotationString = [[
            NAG:AutocastOtherCooldowns()
    or (NAG:RemainingTime() <= 61.0) and NAG:Cast(18540)
    or ((NAG:IsExecutePhase(20) and ((NAG:AuraRemainingTime(113860) > 5.0) or NAG:AllTrinketStatProcsActive(3, 7) or ((NAG:RemainingTime() < 55.0) and NAG:AuraIsActive(126577)) or (NAG:AuraRemainingTime(126577) > 18.0))) or (NAG:RemainingTime() <= 27.0)) and NAG:Cast(76093)
    or NAG:AuraIsActive(113860) and NAG:Cast(26297)
    or (((NAG:DotPercentIncrease(172) + (NAG:DotPercentIncrease(980) + NAG:DotPercentIncrease(30108))) >= 0.5) and NAG:AuraIsActive(74434)) and NAG:Cast(86121)
    or (((NAG:RemainingTime() > 66.0) or NAG:AuraIsActive(113860) or (not NAG:AuraIsActive(74434))) and NAG:SpellIsKnown(126734)) and NAG:StrictSequence("someName959", NAG:Cast(126734), NAG:Cast(74434), NAG:Cast(86121))
    or (((NAG:DotRemainingTime(980) <= 12.0) and (NAG:DotRemainingTime(172) <= 9.0) and (NAG:DotRemainingTime(30108) <= 7.0)) and ((NAG:AuraRemainingTime(113860) <= (NAG:GCDTimeToReady() + 2.0)) or (NAG:AuraRemainingTime(126659) <= (NAG:GCDTimeToReady() + 2.0)) or (NAG:AuraRemainingTime(126577) <= (NAG:GCDTimeToReady() + 2.0))) and ((NAG:SpellTimeToReady(126734) >= 10.0) or (not NAG:SpellIsKnown(126734)))) and NAG:StrictSequence("someName734", NAG:Cast(74434), NAG:Cast(86121))
    or (((NAG:DotPercentIncrease(172) + (NAG:DotPercentIncrease(980) + NAG:DotPercentIncrease(30108))) >= 0.5) and (not NAG:AuraIsActive(74434))) and NAG:StrictSequence("someName66", NAG:Cast(74434), NAG:Cast(86121))
    or ((not NAG:AuraIsActive(48181, "target")) and (NAG:CurrentGenericResource() <= 0)) and NAG:Channel(1120, function() return (NAG:GCDIsReady() and (NAG:SpellChanneledTicks(1120) >= 2)) end)
    or ((NAG:AuraRemainingTime(48181, "target") < (NAG:SpellCastTime(48181) + NAG:SpellTravelTime(48181))) and false) and NAG:Cast(48181)
    or ((NAG:DotPercentIncrease(980) >= 0.15) or ((NAG:DotRemainingTime(980) <= 12.0) and (NAG:DotPercentIncrease(980) >= 0.05)) or (NAG:DotRemainingTime(980) <= (NAG:GCDTimeToReady() + 0.5))) and NAG:Cast(980)
    or ((NAG:DotPercentIncrease(30108) >= 0.15) or ((NAG:DotRemainingTime(30108) <= 7.0) and (NAG:DotPercentIncrease(30108) >= 0.05))) and NAG:Cast(30108)
    or ((NAG:DotPercentIncrease(172) >= 0.15) or ((NAG:DotRemainingTime(172) <= 9.0) and (NAG:DotPercentIncrease(172) >= 0.05))) and NAG:Cast(172)
    or ((not NAG:DotIsActive(172)) and (not NAG:DotIsActive(980)) and (not NAG:DotIsActive(30108))) and NAG:StrictSequence("someName568", NAG:Cast(74434), NAG:Cast(86121))
    or (not NAG:DotIsActive(172)) and NAG:Cast(172)
    or (NAG:DotRemainingTime(30108) <= (NAG:SpellCastTime(30108) + NAG:GCDTimeToReady())) and NAG:Cast(30108)
    or (not NAG:DotIsActive(980)) and NAG:Cast(980)
    or (NAG:CurrentManaPercent() <= 0.15) and NAG:Cast(1454)
    or NAG:IsExecutePhase(20) and NAG:Channel(1120, function() return (NAG:GCDIsReady() and ((NAG:SpellChanneledTicks(1120) >= 2) or (NAG:CurrentGenericResource() == 4))) end)
    or NAG:Channel(103103, function() return NAG:GCDIsReady() end)
    or NAG:Cast(1454)
        ]],
        
        -- New action-based format
        --prePullActions = {{action = {castSpell = {spellId = {spellId = 74434}}}, doAtValue = {const = {val = "-20s"}}}, {action = {castSpell = {spellId = {otherId = "OtherActionPotion"}}}, doAtValue = {const = {val = "-1.6s"}}}, {action = {castSpell = {spellId = {spellId = 48181}}}, doAtValue = {const = {val = "-1.6s"}}}},
        --aplActions = {{action = {autocastOtherCooldowns = {}}}, {action = {condition = {cmp = {op = "OpLe", lhs = {remainingTime = {}}, rhs = {const = {val = "61s"}}}}, castSpell = {spellId = {spellId = 18540}}}}, {action = {condition = {or = {vals = {{and = {vals = {{isExecutePhase = {threshold = "E20"}}, {or = {vals = {{cmp = {op = "OpGt", lhs = {auraRemainingTime = {auraId = {spellId = 113860}}}, rhs = {const = {val = "5s"}}}}, {allTrinketStatProcsActive = {statType1 = 3, statType2 = 7, statType3 = -1}}, {and = {vals = {{cmp = {op = "OpLt", lhs = {remainingTime = {}}, rhs = {const = {val = "55s"}}}}, {auraIsActive = {auraId = {spellId = 126577}}}}}}, {cmp = {op = "OpGt", lhs = {auraRemainingTime = {auraId = {spellId = 126577}}}, rhs = {const = {val = "18s"}}}}}}}}}}, {cmp = {op = "OpLe", lhs = {remainingTime = {}}, rhs = {const = {val = "27s"}}}}}}}, castSpell = {spellId = {itemId = 76093}}}}, {action = {condition = {auraIsActive = {auraId = {spellId = 113860}}}, castSpell = {spellId = {spellId = 26297}}}}, {action = {condition = {and = {vals = {{cmp = {op = "OpGe", lhs = {math = {op = "OpAdd", lhs = {dotPercentIncrease = {spellId = {spellId = 172}}}, rhs = {math = {op = "OpAdd", lhs = {dotPercentIncrease = {spellId = {spellId = 980}}}, rhs = {dotPercentIncrease = {spellId = {spellId = 30108}}}}}}}, rhs = {const = {val = "50%"}}}}, {auraIsActive = {auraId = {spellId = 74434}}}}}}, castSpell = {spellId = {spellId = 86121}}}}, {action = {condition = {and = {vals = {{or = {vals = {{cmp = {op = "OpGt", lhs = {remainingTime = {}}, rhs = {const = {val = "66s"}}}}, {auraIsActive = {auraId = {spellId = 113860}}}, {not = {val = {auraIsActive = {auraId = {spellId = 74434}}}}}}}}, {spellIsKnown = {spellId = {spellId = 126734}}}}}}, strictSequence = {actions = {{castSpell = {spellId = {spellId = 126734}}}, {castSpell = {spellId = {spellId = 74434}}}, {castSpell = {spellId = {spellId = 86121}}}}, name = "someName959"}}}, {action = {condition = {and = {vals = {{and = {vals = {{cmp = {op = "OpLe", lhs = {dotRemainingTime = {spellId = {spellId = 980}}}, rhs = {const = {val = "12s"}}}}, {cmp = {op = "OpLe", lhs = {dotRemainingTime = {spellId = {spellId = 172}}}, rhs = {const = {val = "9s"}}}}, {cmp = {op = "OpLe", lhs = {dotRemainingTime = {spellId = {spellId = 30108}}}, rhs = {const = {val = "7s"}}}}}}}, {or = {vals = {{cmp = {op = "OpLe", lhs = {auraRemainingTime = {auraId = {spellId = 113860}}}, rhs = {math = {op = "OpAdd", lhs = {gcdTimeToReady = {}}, rhs = {const = {val = "2s"}}}}}}, {cmp = {op = "OpLe", lhs = {auraRemainingTime = {auraId = {spellId = 126659}}}, rhs = {math = {op = "OpAdd", lhs = {gcdTimeToReady = {}}, rhs = {const = {val = "2s"}}}}}}, {cmp = {op = "OpLe", lhs = {auraRemainingTime = {auraId = {spellId = 126577}}}, rhs = {math = {op = "OpAdd", lhs = {gcdTimeToReady = {}}, rhs = {const = {val = "2s"}}}}}}}}}, {or = {vals = {{cmp = {op = "OpGe", lhs = {spellTimeToReady = {spellId = {spellId = 126734}}}, rhs = {const = {val = "10s"}}}}, {not = {val = {spellIsKnown = {spellId = {spellId = 126734}}}}}}}}}}}, strictSequence = {actions = {{castSpell = {spellId = {spellId = 74434}}}, {castSpell = {spellId = {spellId = 86121}}}}, name = "someName734"}}}, {action = {condition = {and = {vals = {{cmp = {op = "OpGe", lhs = {math = {op = "OpAdd", lhs = {dotPercentIncrease = {spellId = {spellId = 172}}}, rhs = {math = {op = "OpAdd", lhs = {dotPercentIncrease = {spellId = {spellId = 980}}}, rhs = {dotPercentIncrease = {spellId = {spellId = 30108}}}}}}}, rhs = {const = {val = "50%"}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 74434}}}}}}}}, strictSequence = {actions = {{castSpell = {spellId = {spellId = 74434}}}, {castSpell = {spellId = {spellId = 86121}}}}, name = "someName66"}}}, {action = {condition = {and = {vals = {{not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 48181}}}}}, {cmp = {op = "OpLe", lhs = {currentGenericResource = {}}, rhs = {const = {val = "0"}}}}}}}, channelSpell = {spellId = {spellId = 1120}, interruptIf = {and = {vals = {{gcdIsReady = {}}, {cmp = {op = "OpGe", lhs = {spellChanneledTicks = {spellId = {spellId = 1120}}}, rhs = {const = {val = "2"}}}}}}}}}}, {action = {condition = {and = {vals = {{cmp = {op = "OpLt", lhs = {auraRemainingTime = {sourceUnit = {type = "Target"}, auraId = {spellId = 48181}}}, rhs = {math = {op = "OpAdd", lhs = {spellCastTime = {spellId = {spellId = 48181}}}, rhs = {spellTravelTime = {spellId = {spellId = 48181}}}}}}}, {not = {val = {warlockHauntInFlight = {}}}}}}}, castSpell = {spellId = {spellId = 48181}}}}, {action = {condition = {or = {vals = {{cmp = {op = "OpGe", lhs = {dotPercentIncrease = {spellId = {spellId = 980}}}, rhs = {const = {val = "15%"}}}}, {and = {vals = {{cmp = {op = "OpLe", lhs = {dotRemainingTime = {spellId = {spellId = 980}}}, rhs = {const = {val = "12s"}}}}, {cmp = {op = "OpGe", lhs = {dotPercentIncrease = {spellId = {spellId = 980}}}, rhs = {const = {val = "5%"}}}}}}}, {cmp = {op = "OpLe", lhs = {dotRemainingTime = {spellId = {spellId = 980}}}, rhs = {math = {op = "OpAdd", lhs = {gcdTimeToReady = {}}, rhs = {const = {val = "0.5s"}}}}}}}}}, castSpell = {spellId = {spellId = 980}}}}, {action = {condition = {or = {vals = {{cmp = {op = "OpGe", lhs = {dotPercentIncrease = {spellId = {spellId = 30108}}}, rhs = {const = {val = "15%"}}}}, {and = {vals = {{cmp = {op = "OpLe", lhs = {dotRemainingTime = {spellId = {spellId = 30108}}}, rhs = {const = {val = "7s"}}}}, {cmp = {op = "OpGe", lhs = {dotPercentIncrease = {spellId = {spellId = 30108}}}, rhs = {const = {val = "5%"}}}}}}}}}}, castSpell = {spellId = {spellId = 30108}}}}, {action = {condition = {or = {vals = {{cmp = {op = "OpGe", lhs = {dotPercentIncrease = {spellId = {spellId = 172}}}, rhs = {const = {val = "15%"}}}}, {and = {vals = {{cmp = {op = "OpLe", lhs = {dotRemainingTime = {spellId = {spellId = 172}}}, rhs = {const = {val = "9s"}}}}, {cmp = {op = "OpGe", lhs = {dotPercentIncrease = {spellId = {spellId = 172}}}, rhs = {const = {val = "5%"}}}}}}}}}}, castSpell = {spellId = {spellId = 172}}}}, {action = {condition = {and = {vals = {{not = {val = {dotIsActive = {spellId = {spellId = 172}}}}}, {not = {val = {dotIsActive = {spellId = {spellId = 980}}}}}, {not = {val = {dotIsActive = {spellId = {spellId = 30108}}}}}}}}, strictSequence = {actions = {{castSpell = {spellId = {spellId = 74434}}}, {castSpell = {spellId = {spellId = 86121}}}}, name = "someName568"}}}, {action = {condition = {not = {val = {dotIsActive = {spellId = {spellId = 172}}}}}, castSpell = {spellId = {spellId = 172}}}}, {action = {condition = {cmp = {op = "OpLe", lhs = {dotRemainingTime = {spellId = {spellId = 30108}}}, rhs = {math = {op = "OpAdd", lhs = {spellCastTime = {spellId = {spellId = 30108}}}, rhs = {gcdTimeToReady = {}}}}}}, castSpell = {spellId = {spellId = 30108}}}}, {action = {condition = {not = {val = {dotIsActive = {spellId = {spellId = 980}}}}}, castSpell = {spellId = {spellId = 980}}}}, {action = {condition = {cmp = {op = "OpLe", lhs = {currentManaPercent = {}}, rhs = {const = {val = "15%"}}}}, castSpell = {spellId = {spellId = 1454}}}}, {action = {condition = {isExecutePhase = {threshold = "E20"}}, channelSpell = {spellId = {spellId = 1120}, interruptIf = {and = {vals = {{gcdIsReady = {}}, {or = {vals = {{cmp = {op = "OpGe", lhs = {spellChanneledTicks = {spellId = {spellId = 1120}}}, rhs = {const = {val = "2"}}}}, {cmp = {op = "OpEq", lhs = {currentGenericResource = {}}, rhs = {const = {val = "4"}}}}}}}}}}}}}, {action = {channelSpell = {spellId = {spellId = 103103}, interruptIf = {gcdIsReady = {}}}}}, {action = {castSpell = {spellId = {spellId = 1454}}}}},

        -- Tracked IDs for optimization
        spells = {172, 980, 1120, 1454, 18540, 26297, 30108, 48181, 74434, 86121, 103103, 113860, 126577, 126659, 126734},
        items = {76093},
        auras = {},
        runes = {},

        -- Optional metadata
        glyphs = {42472, 43389},
        lastModified = "07/03/2025",
        author = "APLParser",

        -- Serialized JSON for straight APL reading
        --rotation_json = [[[{"action":{"autocastOtherCooldowns":{}}},{"action":{"condition":{"cmp":{"op":"OpLe","lhs":{"remainingTime":{}},"rhs":{"const":{"val":"61s"}}}},"castSpell":{"spellId":{"spellId":18540}}}},{"action":{"condition":{"or":{"vals":[{"and":{"vals":[{"isExecutePhase":{"threshold":"E20"}},{"or":{"vals":[{"cmp":{"op":"OpGt","lhs":{"auraRemainingTime":{"auraId":{"spellId":113860}}},"rhs":{"const":{"val":"5s"}}}},{"allTrinketStatProcsActive":{"statType1":3,"statType2":7,"statType3":-1}},{"and":{"vals":[{"cmp":{"op":"OpLt","lhs":{"remainingTime":{}},"rhs":{"const":{"val":"55s"}}}},{"auraIsActive":{"auraId":{"spellId":126577}}}]}},{"cmp":{"op":"OpGt","lhs":{"auraRemainingTime":{"auraId":{"spellId":126577}}},"rhs":{"const":{"val":"18s"}}}}]}}]}},{"cmp":{"op":"OpLe","lhs":{"remainingTime":{}},"rhs":{"const":{"val":"27s"}}}}]}},"castSpell":{"spellId":{"itemId":76093}}}},{"action":{"condition":{"auraIsActive":{"auraId":{"spellId":113860}}},"castSpell":{"spellId":{"spellId":26297}}}},{"action":{"condition":{"and":{"vals":[{"cmp":{"op":"OpGe","lhs":{"math":{"op":"OpAdd","lhs":{"dotPercentIncrease":{"spellId":{"spellId":172}}},"rhs":{"math":{"op":"OpAdd","lhs":{"dotPercentIncrease":{"spellId":{"spellId":980}}},"rhs":{"dotPercentIncrease":{"spellId":{"spellId":30108}}}}}}},"rhs":{"const":{"val":"50%"}}}},{"auraIsActive":{"auraId":{"spellId":74434}}}]}},"castSpell":{"spellId":{"spellId":86121}}}},{"action":{"condition":{"and":{"vals":[{"or":{"vals":[{"cmp":{"op":"OpGt","lhs":{"remainingTime":{}},"rhs":{"const":{"val":"66s"}}}},{"auraIsActive":{"auraId":{"spellId":113860}}},{"not":{"val":{"auraIsActive":{"auraId":{"spellId":74434}}}}}]}},{"spellIsKnown":{"spellId":{"spellId":126734}}}]}},"strictSequence":{"actions":[{"castSpell":{"spellId":{"spellId":126734}}},{"castSpell":{"spellId":{"spellId":74434}}},{"castSpell":{"spellId":{"spellId":86121}}}],"name":"someName959"}}},{"action":{"condition":{"and":{"vals":[{"and":{"vals":[{"cmp":{"op":"OpLe","lhs":{"dotRemainingTime":{"spellId":{"spellId":980}}},"rhs":{"const":{"val":"12s"}}}},{"cmp":{"op":"OpLe","lhs":{"dotRemainingTime":{"spellId":{"spellId":172}}},"rhs":{"const":{"val":"9s"}}}},{"cmp":{"op":"OpLe","lhs":{"dotRemainingTime":{"spellId":{"spellId":30108}}},"rhs":{"const":{"val":"7s"}}}}]}},{"or":{"vals":[{"cmp":{"op":"OpLe","lhs":{"auraRemainingTime":{"auraId":{"spellId":113860}}},"rhs":{"math":{"op":"OpAdd","lhs":{"gcdTimeToReady":{}},"rhs":{"const":{"val":"2s"}}}}}},{"cmp":{"op":"OpLe","lhs":{"auraRemainingTime":{"auraId":{"spellId":126659}}},"rhs":{"math":{"op":"OpAdd","lhs":{"gcdTimeToReady":{}},"rhs":{"const":{"val":"2s"}}}}}},{"cmp":{"op":"OpLe","lhs":{"auraRemainingTime":{"auraId":{"spellId":126577}}},"rhs":{"math":{"op":"OpAdd","lhs":{"gcdTimeToReady":{}},"rhs":{"const":{"val":"2s"}}}}}}]}},{"or":{"vals":[{"cmp":{"op":"OpGe","lhs":{"spellTimeToReady":{"spellId":{"spellId":126734}}},"rhs":{"const":{"val":"10s"}}}},{"not":{"val":{"spellIsKnown":{"spellId":{"spellId":126734}}}}}]}}]}},"strictSequence":{"actions":[{"castSpell":{"spellId":{"spellId":74434}}},{"castSpell":{"spellId":{"spellId":86121}}}],"name":"someName734"}}},{"action":{"condition":{"and":{"vals":[{"cmp":{"op":"OpGe","lhs":{"math":{"op":"OpAdd","lhs":{"dotPercentIncrease":{"spellId":{"spellId":172}}},"rhs":{"math":{"op":"OpAdd","lhs":{"dotPercentIncrease":{"spellId":{"spellId":980}}},"rhs":{"dotPercentIncrease":{"spellId":{"spellId":30108}}}}}}},"rhs":{"const":{"val":"50%"}}}},{"not":{"val":{"auraIsActive":{"auraId":{"spellId":74434}}}}}]}},"strictSequence":{"actions":[{"castSpell":{"spellId":{"spellId":74434}}},{"castSpell":{"spellId":{"spellId":86121}}}],"name":"someName66"}}},{"action":{"condition":{"and":{"vals":[{"not":{"val":{"auraIsActive":{"sourceUnit":{"type":"CurrentTarget"},"auraId":{"spellId":48181}}}}},{"cmp":{"op":"OpLe","lhs":{"currentGenericResource":{}},"rhs":{"const":{"val":"0"}}}}]}},"channelSpell":{"spellId":{"spellId":1120},"interruptIf":{"and":{"vals":[{"gcdIsReady":{}},{"cmp":{"op":"OpGe","lhs":{"spellChanneledTicks":{"spellId":{"spellId":1120}}},"rhs":{"const":{"val":"2"}}}}]}}}}},{"action":{"condition":{"and":{"vals":[{"cmp":{"op":"OpLt","lhs":{"auraRemainingTime":{"sourceUnit":{"type":"Target"},"auraId":{"spellId":48181}}},"rhs":{"math":{"op":"OpAdd","lhs":{"spellCastTime":{"spellId":{"spellId":48181}}},"rhs":{"spellTravelTime":{"spellId":{"spellId":48181}}}}}}},{"not":{"val":{"warlockHauntInFlight":{}}}}]}},"castSpell":{"spellId":{"spellId":48181}}}},{"action":{"condition":{"or":{"vals":[{"cmp":{"op":"OpGe","lhs":{"dotPercentIncrease":{"spellId":{"spellId":980}}},"rhs":{"const":{"val":"15%"}}}},{"and":{"vals":[{"cmp":{"op":"OpLe","lhs":{"dotRemainingTime":{"spellId":{"spellId":980}}},"rhs":{"const":{"val":"12s"}}}},{"cmp":{"op":"OpGe","lhs":{"dotPercentIncrease":{"spellId":{"spellId":980}}},"rhs":{"const":{"val":"5%"}}}}]}},{"cmp":{"op":"OpLe","lhs":{"dotRemainingTime":{"spellId":{"spellId":980}}},"rhs":{"math":{"op":"OpAdd","lhs":{"gcdTimeToReady":{}},"rhs":{"const":{"val":"0.5s"}}}}}}]}},"castSpell":{"spellId":{"spellId":980}}}},{"action":{"condition":{"or":{"vals":[{"cmp":{"op":"OpGe","lhs":{"dotPercentIncrease":{"spellId":{"spellId":30108}}},"rhs":{"const":{"val":"15%"}}}},{"and":{"vals":[{"cmp":{"op":"OpLe","lhs":{"dotRemainingTime":{"spellId":{"spellId":30108}}},"rhs":{"const":{"val":"7s"}}}},{"cmp":{"op":"OpGe","lhs":{"dotPercentIncrease":{"spellId":{"spellId":30108}}},"rhs":{"const":{"val":"5%"}}}}]}}]}},"castSpell":{"spellId":{"spellId":30108}}}},{"action":{"condition":{"or":{"vals":[{"cmp":{"op":"OpGe","lhs":{"dotPercentIncrease":{"spellId":{"spellId":172}}},"rhs":{"const":{"val":"15%"}}}},{"and":{"vals":[{"cmp":{"op":"OpLe","lhs":{"dotRemainingTime":{"spellId":{"spellId":172}}},"rhs":{"const":{"val":"9s"}}}},{"cmp":{"op":"OpGe","lhs":{"dotPercentIncrease":{"spellId":{"spellId":172}}},"rhs":{"const":{"val":"5%"}}}}]}}]}},"castSpell":{"spellId":{"spellId":172}}}},{"action":{"condition":{"and":{"vals":[{"not":{"val":{"dotIsActive":{"spellId":{"spellId":172}}}}},{"not":{"val":{"dotIsActive":{"spellId":{"spellId":980}}}}},{"not":{"val":{"dotIsActive":{"spellId":{"spellId":30108}}}}}]}},"strictSequence":{"actions":[{"castSpell":{"spellId":{"spellId":74434}}},{"castSpell":{"spellId":{"spellId":86121}}}],"name":"someName568"}}},{"action":{"condition":{"not":{"val":{"dotIsActive":{"spellId":{"spellId":172}}}}},"castSpell":{"spellId":{"spellId":172}}}},{"action":{"condition":{"cmp":{"op":"OpLe","lhs":{"dotRemainingTime":{"spellId":{"spellId":30108}}},"rhs":{"math":{"op":"OpAdd","lhs":{"spellCastTime":{"spellId":{"spellId":30108}}},"rhs":{"gcdTimeToReady":{}}}}}},"castSpell":{"spellId":{"spellId":30108}}}},{"action":{"condition":{"not":{"val":{"dotIsActive":{"spellId":{"spellId":980}}}}},"castSpell":{"spellId":{"spellId":980}}}},{"action":{"condition":{"cmp":{"op":"OpLe","lhs":{"currentManaPercent":{}},"rhs":{"const":{"val":"15%"}}}},"castSpell":{"spellId":{"spellId":1454}}}},{"action":{"condition":{"isExecutePhase":{"threshold":"E20"}},"channelSpell":{"spellId":{"spellId":1120},"interruptIf":{"and":{"vals":[{"gcdIsReady":{}},{"or":{"vals":[{"cmp":{"op":"OpGe","lhs":{"spellChanneledTicks":{"spellId":{"spellId":1120}}},"rhs":{"const":{"val":"2"}}}},{"cmp":{"op":"OpEq","lhs":{"currentGenericResource":{}},"rhs":{"const":{"val":"4"}}}}]}}]}}}}},{"action":{"channelSpell":{"spellId":{"spellId":103103},"interruptIf":{"gcdIsReady":{}}}}},{"action":{"castSpell":{"spellId":{"spellId":1454}}}}]]],
        --prepull_json = [[[{"action":{"castSpell":{"spellId":{"spellId":74434}}},"doAtValue":{"const":{"val":"-20s"}}},{"action":{"castSpell":{"spellId":{"otherId":"OtherActionPotion"}}},"doAtValue":{"const":{"val":"-1.6s"}}},{"action":{"castSpell":{"spellId":{"spellId":48181}}},"doAtValue":{"const":{"val":"-1.6s"}}}]]]
    }
)


--- @class Warlock : ClassBase
local Warlock = NAG:CreateClassModule("WARLOCK", defaults)
if not Warlock then return end

function Warlock:RegisterSpellTracking()
    local SpellTracker = NAG:GetModule("SpellTrackingManager")
    if not SpellTracker then return end
end

NAG.Class = Warlock