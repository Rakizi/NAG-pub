local _, ns = ...
--- @type NAG|AceAddon
local NAG = LibStub("AceAddon-3.0"):GetAddon("NAG")
local L = LibStub("AceLocale-3.0"):GetLocale("NAG", true)
--- @type Version
local Version = ns.Version
if not Version:IsSoD() then return end
local SpellTracker = NAG:GetModule("SpellTrackingManager")
local SpecializationCompat = ns.SpecializationCompat

if UnitClassBase('player') ~= "ROGUE" then return end
--- NAG

local defaults = ns.InitializeClassDefaults()

-- Add spec-level spell locations to defaults
defaults.class.specSpellLocations = {
    ['*'] = {
        ABOVE = {},
        BELOW = {},
        RIGHT = {},
        LEFT = {},
        AOE = {}
    },
}

ns.AddRotationToDefaults(defaults,
    SpecializationCompat:GetSpecID("Rogue", "Assassination"),
    "Rogue Assassination - 3Min_Phase8_PreRaid_SaberSlash by APLParser",
    {
        -- Required parameters
        default = true,
        enabled = true,
        experimental = false,
        gameType = Version.GAME_TYPES.CLASSIC_ERA_SOD,
        prePull = {
            { NAG:Cast(6774), -2000 }, { NAG:Cast(13877), -1000 }
        },
        rotationString = [[
((NAG:CurrentEnergy() <= 10) or ((NAG:RemainingTime() <= 15) and (NAG:CurrentEnergy() <= 40))) and NAG:Cast(7676)
    or NAG:AutocastOtherCooldowns()
    or (((not NAG:RuneIsEquipped(432276)) and (not NAG:AuraIsActive(1787))) or (NAG:RuneIsEquipped(432276) and (not NAG:AuraIsActive(1787)) and NAG:AuraIsActive(432276, "target"))) and NAG:Cast(233985)
    or (NAG:AuraIsKnown(1226843) and (not NAG:AuraIsActive(424785, "target")) and (not NAG:AuraIsActive(11275, "target")) and (not NAG:AuraIsActive(436611, "target")) and (NAG:CurrentComboPoints() <= 4)) and NAG:Cast(425012)
    or (NAG:AuraIsKnown(1226843) and (not NAG:AuraIsActive(424785, "target")) and (not NAG:AuraIsActive(11275, "target")) and (not NAG:AuraIsActive(436611, "target")) and (NAG:CurrentComboPoints() >= 1)) and NAG:Cast(412096)
    or ((NAG:CurrentComboPoints() <= 4) and ((NAG:AuraNumStacks(424785, "target") < 3) or (NAG:AuraRemainingTime(424785, "target") < 2)) and (NAG:AuraRemainingTime(424785, "target") < (NAG:RemainingTime() + 2))) and NAG:Cast(424785)
    or (((not NAG:RuneIsEquipped(432276)) and NAG:AuraIsActive(6774) and NAG:AuraIsActive(399963)) or (NAG:RuneIsEquipped(432276) and NAG:AuraIsActive(432276, "target") and NAG:AuraIsActive(6774) and NAG:AuraIsActive(399963))) and NAG:Cast(13877)
    or ((NAG:AuraNumStacks(1214170, "target") >= 4) and (NAG:CurrentComboPoints() < 5) and (NAG:CurrentEnergy() <= 75)) and NAG:Cast(425012)
    or (((not NAG:RuneIsEquipped(432271)) and (NAG:AuraRemainingTime(6774) <= 1) and (((NAG:CurrentComboPoints() >= 4) and (NAG:RemainingTime() >= 19)) or ((NAG:CurrentComboPoints() >= 2) and (NAG:RemainingTime() < 19) and (NAG:RemainingTime() >= 13)))) or (NAG:RuneIsEquipped(432271) and (not NAG:AuraIsActive(6774)) and (NAG:CurrentComboPoints() >= 1) and (NAG:RemainingTime() >= 10))) and NAG:Cast(6774)
    or ((NAG:AuraIsKnown(1226843) and NAG:AuraIsKnown(1232181) and (not NAG:RuneIsEquipped(432271)) and (not NAG:AuraIsActive(436611, "target")) and (NAG:CurrentComboPoints() >= 1) and (NAG:RemainingTime() >= 5)) or (NAG:AuraIsKnown(1226843) and (not NAG:RuneIsEquipped(432271)) and (not NAG:AuraIsActive(436611, "target")) and (((NAG:CurrentComboPoints() >= 4) and (NAG:RemainingTime() >= 11)) or ((NAG:CurrentComboPoints() >= 2) and (NAG:RemainingTime() < 11) and (NAG:RemainingTime() >= 7))))) and NAG:Cast(412096)
    or ((not NAG:AuraIsActive(425096)) and (NAG:CurrentEnergy() >= 35) and (NAG:CurrentComboPoints() >= 5) and NAG:GCDIsReady() and (NAG:AuraNumStacks(1214170, "target") >= 5)) and NAG:StrictSequence("foo", NAG:Cast(14177), NAG:Cast(1856), NAG:Cast(399963))
    or ((NAG:CurrentComboPoints() >= 4) or ((NAG:CurrentComboPoints() >= 3) and (NAG:RemainingTime() <= 4))) and NAG:Cast(399963)
    or ((NAG:AuraIsKnown(1226843) and (NAG:CurrentComboPoints() <= 4) and (NAG:CurrentEnergy() >= 75) and (NAG:AuraRemainingTime(424785, "target") >= 8) and (NAG:AuraNumStacks(424785, "target") >= 3)) or (NAG:AuraIsKnown(1226843) and (NAG:CurrentComboPoints() <= 2) and (NAG:AuraRemainingTime(424785, "target") >= 8) and (NAG:AuraNumStacks(424785, "target") >= 3)) or (NAG:AuraIsKnown(1226843) and (NAG:CurrentComboPoints() <= 2) and (NAG:RemainingTime() <= 4) and (NAG:AuraNumStacks(424785, "target") >= 3))) and NAG:Cast(11294)
    or ((NAG:CurrentComboPoints() <= 2) or ((NAG:CurrentComboPoints() <= 4) and (NAG:CurrentEnergy() >= 75))) and NAG:Cast(424785)
        ]],

        -- New action-based format
        --prePullActions = {{action = {addComboPoints = {numPoints = "5"}}, doAtValue = {const = {val = "-4s"}}}, {action = {activateAura = {auraId = {spellId = 1787, rank = 4}}}, doAtValue = {const = {val = "-3s"}}}, {action = {castSpell = {spellId = {spellId = 6774, rank = 2}}}, doAtValue = {const = {val = "-2s"}}}, {action = {castSpell = {spellId = {spellId = 13877}}}, doAtValue = {const = {val = "-1s"}}}, {action = {castSpell = {spellId = {itemId = 215162}}}, doAtValue = {const = {val = "-0.1s"}}}},
        --aplActions = {{action = {condition = {or = {vals = {{cmp = {op = "OpLe", lhs = {currentEnergy = {}}, rhs = {const = {val = "10"}}}}, {and = {vals = {{cmp = {op = "OpLe", lhs = {remainingTime = {}}, rhs = {const = {val = "15"}}}}, {cmp = {op = "OpLe", lhs = {currentEnergy = {}}, rhs = {const = {val = "40"}}}}}}}}}}, castSpell = {spellId = {itemId = 7676}}}}, {action = {autocastOtherCooldowns = {}}}, {action = {condition = {or = {vals = {{and = {vals = {{not = {val = {runeIsEquipped = {runeId = {spellId = 432276}}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 1787, rank = 4}}}}}}}}, {and = {vals = {{runeIsEquipped = {runeId = {spellId = 432276}}}, {not = {val = {auraIsActive = {auraId = {spellId = 1787, rank = 4}}}}}, {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 432276}}}}}}}}}, castSpell = {spellId = {itemId = 233985}}}}, {action = {condition = {and = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 424785}}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 11275, rank = 6}}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 436611}}}}}, {cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}}}}, castSpell = {spellId = {spellId = 425012}}}}, {action = {condition = {and = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 424785}}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 11275, rank = 6}}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 436611}}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "1"}}}}}}}, castSpell = {spellId = {spellId = 412096}}}}, {action = {condition = {and = {vals = {{cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {or = {vals = {{cmp = {op = "OpLt", lhs = {auraNumStacks = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 424785}}}, rhs = {const = {val = "3"}}}}, {cmp = {op = "OpLt", lhs = {auraRemainingTime = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 424785}}}, rhs = {const = {val = "2"}}}}}}}, {cmp = {op = "OpLt", lhs = {auraRemainingTime = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 424785}}}, rhs = {math = {op = "OpAdd", lhs = {remainingTime = {}}, rhs = {const = {val = "2"}}}}}}}}}, castSpell = {spellId = {spellId = 424785}}}}, {action = {condition = {or = {vals = {{and = {vals = {{not = {val = {runeIsEquipped = {runeId = {spellId = 432276}}}}}, {auraIsActive = {auraId = {spellId = 6774, rank = 2}}}, {auraIsActive = {auraId = {spellId = 399963}}}}}}, {and = {vals = {{runeIsEquipped = {runeId = {spellId = 432276}}}, {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 432276}}}, {auraIsActive = {auraId = {spellId = 6774, rank = 2}}}, {auraIsActive = {auraId = {spellId = 399963}}}}}}}}}, castSpell = {spellId = {spellId = 13877}}}}, {action = {condition = {and = {vals = {{cmp = {op = "OpGe", lhs = {auraNumStacks = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 1214170, tag = 100}}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpLt", lhs = {currentComboPoints = {}}, rhs = {const = {val = "5"}}}}, {cmp = {op = "OpLe", lhs = {currentEnergy = {}}, rhs = {const = {val = "75"}}}}}}}, castSpell = {spellId = {spellId = 425012}}}}, {action = {condition = {or = {vals = {{and = {vals = {{not = {val = {runeIsEquipped = {runeId = {spellId = 432271}}}}}, {cmp = {op = "OpLe", lhs = {auraRemainingTime = {auraId = {spellId = 6774, rank = 2}}}, rhs = {const = {val = "1"}}}}, {or = {vals = {{and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "19"}}}}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {cmp = {op = "OpLt", lhs = {remainingTime = {}}, rhs = {const = {val = "19"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "13"}}}}}}}}}}}}}, {and = {vals = {{runeIsEquipped = {runeId = {spellId = 432271}}}, {not = {val = {auraIsActive = {auraId = {spellId = 6774, rank = 2}}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "1"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "10"}}}}}}}}}}, castSpell = {spellId = {spellId = 6774, rank = 2}}}}, {action = {condition = {or = {vals = {{and = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {auraIsKnown = {auraId = {spellId = 1232181}}}, {not = {val = {runeIsEquipped = {runeId = {spellId = 432271}}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 436611}}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "1"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "5"}}}}}}}, {and = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {not = {val = {runeIsEquipped = {runeId = {spellId = 432271}}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 436611}}}}}, {or = {vals = {{and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "11"}}}}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {cmp = {op = "OpLt", lhs = {remainingTime = {}}, rhs = {const = {val = "11"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "7"}}}}}}}}}}}}}}}}, castSpell = {spellId = {spellId = 412096}}}}, {hide = true, action = {condition = {or = {vals = {{and = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {auraIsKnown = {auraId = {spellId = 1232181}}}, {not = {val = {runeIsEquipped = {runeId = {spellId = 432271}}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 11275, rank = 6}}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "3"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "9"}}}}}}}, {and = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {not = {val = {runeIsEquipped = {runeId = {spellId = 432271}}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 11275, rank = 6}}}}}, {or = {vals = {{and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "15"}}}}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {cmp = {op = "OpLt", lhs = {remainingTime = {}}, rhs = {const = {val = "15"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "9"}}}}}}}}}}}}}}}}, castSpell = {spellId = {spellId = 11275, rank = 6}}}}, {action = {condition = {and = {vals = {{not = {val = {auraIsActive = {auraId = {spellId = 425096}}}}}, {cmp = {op = "OpGe", lhs = {currentEnergy = {}}, rhs = {const = {val = "35"}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "5"}}}}, {gcdIsReady = {}}, {cmp = {op = "OpGe", lhs = {auraNumStacks = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 1214170, tag = 100}}}, rhs = {const = {val = "5"}}}}}}}, strictSequence = {actions = {{castSpell = {spellId = {spellId = 14177}}}, {castSpell = {spellId = {spellId = 1856, rank = 1}}}, {castSpell = {spellId = {spellId = 399963}}}}, name = "someName194"}}}, {action = {condition = {or = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "3"}}}}, {cmp = {op = "OpLe", lhs = {remainingTime = {}}, rhs = {const = {val = "4"}}}}}}}}}}, castSpell = {spellId = {spellId = 399963}}}}, {action = {condition = {or = {vals = {{and = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {currentEnergy = {}}, rhs = {const = {val = "75"}}}}, {cmp = {op = "OpGe", lhs = {auraRemainingTime = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 424785}}}, rhs = {const = {val = "8"}}}}, {cmp = {op = "OpGe", lhs = {auraNumStacks = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 424785}}}, rhs = {const = {val = "3"}}}}}}}, {and = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {cmp = {op = "OpGe", lhs = {auraRemainingTime = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 424785}}}, rhs = {const = {val = "8"}}}}, {cmp = {op = "OpGe", lhs = {auraNumStacks = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 424785}}}, rhs = {const = {val = "3"}}}}}}}, {and = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {cmp = {op = "OpLe", lhs = {remainingTime = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {auraNumStacks = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 424785}}}, rhs = {const = {val = "3"}}}}}}}}}}, castSpell = {spellId = {spellId = 11294, rank = 8}}}}, {action = {condition = {or = {vals = {{cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {and = {vals = {{cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {currentEnergy = {}}, rhs = {const = {val = "75"}}}}}}}}}}, castSpell = {spellId = {spellId = 424785}}}}},

        -- Tracked IDs for optimization
        spells = {1787, 1856, 6774, 11275, 11294, 13877, 14177, 399963, 412096, 424785, 425012, 425096, 432276, 436611, 1214170, 1226843, 1232181},
        items = {7676, 233985},
        auras = {},
        runes = {432271, 432276},

        -- Optional metadata
        glyphs = {},
        lastModified = "06/12/2025",
        author = "APLParser"
    }
)

ns.AddRotationToDefaults(defaults,
    SpecializationCompat:GetSpecID("Rogue", "Assassination"),
    "Rogue Assassination - 3Min_Mutilate_Phase8_PreRaid by APLParser",
    {
        -- Required parameters
        default = true,
        enabled = true,
        experimental = false,
        gameType = Version.GAME_TYPES.CLASSIC_ERA_SOD,
        prePull = {
            { NAG:Cast(6774), -2000 }, { NAG:Cast(13877), -1000 }
        },
        rotationString = [[
((NAG:CurrentEnergy() <= 10) or ((NAG:RemainingTime() <= 20) and (NAG:CurrentEnergy() <= 40))) and NAG:Cast(7676)
    or NAG:AutocastOtherCooldowns()
    or (((not NAG:RuneIsEquipped(432276)) and (not NAG:AuraIsActive(1787))) or (NAG:RuneIsEquipped(432276) and NAG:AuraIsActive(432276, "target") and (not NAG:AuraIsActive(1787)))) and NAG:Cast(233985)
    or (((not NAG:RuneIsEquipped(432276)) and NAG:AuraIsActive(6774) and NAG:AuraIsActive(399963)) or (NAG:RuneIsEquipped(432276) and NAG:AuraIsActive(432276, "target") and NAG:AuraIsActive(6774) and NAG:AuraIsActive(399963))) and NAG:Cast(13877)
    or ((NAG:AuraIsKnown(1226843) and NAG:AuraIsKnown(1232181) and (not NAG:AuraIsActive(11275, "target")) and (NAG:CurrentComboPoints() >= 3) and (NAG:RemainingTime() >= 9)) or (NAG:AuraIsKnown(1226843) and (not NAG:AuraIsActive(11275, "target")) and (((NAG:CurrentComboPoints() >= 4) and (NAG:RemainingTime() >= 15)) or ((NAG:CurrentComboPoints() >= 2) and (NAG:RemainingTime() < 15) and (NAG:RemainingTime() >= 9))))) and NAG:Cast(11275)
    or (((not NAG:RuneIsEquipped(432271)) and (NAG:AuraRemainingTime(6774) <= 1) and (((NAG:CurrentComboPoints() >= 4) and (NAG:RemainingTime() >= 19)) or ((NAG:CurrentComboPoints() >= 2) and (NAG:RemainingTime() < 19) and (NAG:RemainingTime() >= 13)))) or (NAG:RuneIsEquipped(432271) and (not NAG:AuraIsActive(6774)) and (NAG:CurrentComboPoints() >= 1) and (NAG:RemainingTime() >= 10))) and NAG:Cast(6774)
    or ((NAG:AuraIsKnown(1232181) and (NAG:AuraIsKnown(1226843) or NAG:RuneIsEquipped(432276)) and (not NAG:AuraIsActive(436611, "target")) and (NAG:CurrentComboPoints() >= 1) and (NAG:RemainingTime() >= 5)) or ((NAG:AuraIsKnown(1226843) or NAG:RuneIsEquipped(432276)) and (not NAG:AuraIsActive(436611, "target")) and (((NAG:CurrentComboPoints() >= 4) and (NAG:RemainingTime() >= 11)) or ((NAG:CurrentComboPoints() >= 2) and (NAG:RemainingTime() < 11) and (NAG:RemainingTime() >= 7))))) and NAG:Cast(412096)
    or ((not NAG:AuraIsActive(425096)) and (NAG:CurrentEnergy() >= 35) and (NAG:CurrentComboPoints() >= 5) and NAG:GCDIsReady() and (NAG:AuraNumStacks(1214170, "target") >= 5)) and NAG:StrictSequence("foo", NAG:Cast(14177), NAG:Cast(1856), NAG:Cast(399963))
    or ((NAG:CurrentComboPoints() >= 4) or ((NAG:CurrentComboPoints() >= 3) and (NAG:RemainingTime() <= 4))) and NAG:Cast(399963)
    or (NAG:CurrentComboPoints() <= 3) and NAG:Cast(399956)
    or (((NAG:AuraNumStacks(1214170, "target") >= 4) and (NAG:CurrentComboPoints() < 5)) or (NAG:AuraRemainingTime(1214170, "target") <= 1)) and NAG:Cast(425012)
        ]],

        -- New action-based format
        --prePullActions = {{action = {addComboPoints = {numPoints = "5"}}, doAtValue = {const = {val = "-4s"}}}, {action = {activateAura = {auraId = {spellId = 1787, rank = 4}}}, doAtValue = {const = {val = "-3s"}}}, {action = {castSpell = {spellId = {spellId = 6774, rank = 2}}}, doAtValue = {const = {val = "-2s"}}}, {action = {castSpell = {spellId = {spellId = 13877}}}, doAtValue = {const = {val = "-1s"}}}, {action = {castSpell = {spellId = {itemId = 215162}}}, doAtValue = {const = {val = "-0.1s"}}}},
        --aplActions = {{action = {condition = {or = {vals = {{cmp = {op = "OpLe", lhs = {currentEnergy = {}}, rhs = {const = {val = "10"}}}}, {and = {vals = {{cmp = {op = "OpLe", lhs = {remainingTime = {}}, rhs = {const = {val = "20"}}}}, {cmp = {op = "OpLe", lhs = {currentEnergy = {}}, rhs = {const = {val = "40"}}}}}}}}}}, castSpell = {spellId = {itemId = 7676}}}}, {action = {autocastOtherCooldowns = {}}}, {action = {condition = {or = {vals = {{and = {vals = {{not = {val = {runeIsEquipped = {runeId = {spellId = 432276}}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 1787, rank = 4}}}}}}}}, {and = {vals = {{runeIsEquipped = {runeId = {spellId = 432276}}}, {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 432276}}}, {not = {val = {auraIsActive = {auraId = {spellId = 1787, rank = 4}}}}}}}}}}}, castSpell = {spellId = {itemId = 233985}}}}, {action = {condition = {or = {vals = {{and = {vals = {{not = {val = {runeIsEquipped = {runeId = {spellId = 432276}}}}}, {auraIsActive = {auraId = {spellId = 6774, rank = 2}}}, {auraIsActive = {auraId = {spellId = 399963}}}}}}, {and = {vals = {{runeIsEquipped = {runeId = {spellId = 432276}}}, {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 432276}}}, {auraIsActive = {auraId = {spellId = 6774, rank = 2}}}, {auraIsActive = {auraId = {spellId = 399963}}}}}}}}}, castSpell = {spellId = {spellId = 13877}}}}, {action = {condition = {or = {vals = {{and = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {auraIsKnown = {auraId = {spellId = 1232181}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 11275, rank = 6}}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "3"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "9"}}}}}}}, {and = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 11275, rank = 6}}}}}, {or = {vals = {{and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "15"}}}}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {cmp = {op = "OpLt", lhs = {remainingTime = {}}, rhs = {const = {val = "15"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "9"}}}}}}}}}}}}}}}}, castSpell = {spellId = {spellId = 11275, rank = 6}}}}, {action = {condition = {or = {vals = {{and = {vals = {{not = {val = {runeIsEquipped = {runeId = {spellId = 432271}}}}}, {cmp = {op = "OpLe", lhs = {auraRemainingTime = {auraId = {spellId = 6774, rank = 2}}}, rhs = {const = {val = "1"}}}}, {or = {vals = {{and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "19"}}}}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {cmp = {op = "OpLt", lhs = {remainingTime = {}}, rhs = {const = {val = "19"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "13"}}}}}}}}}}}}}, {and = {vals = {{runeIsEquipped = {runeId = {spellId = 432271}}}, {not = {val = {auraIsActive = {auraId = {spellId = 6774, rank = 2}}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "1"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "10"}}}}}}}}}}, castSpell = {spellId = {spellId = 6774, rank = 2}}}}, {action = {condition = {or = {vals = {{and = {vals = {{auraIsKnown = {auraId = {spellId = 1232181}}}, {or = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {runeIsEquipped = {runeId = {spellId = 432276}}}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 436611}}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "1"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "5"}}}}}}}, {and = {vals = {{or = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {runeIsEquipped = {runeId = {spellId = 432276}}}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 436611}}}}}, {or = {vals = {{and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "11"}}}}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {cmp = {op = "OpLt", lhs = {remainingTime = {}}, rhs = {const = {val = "11"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "7"}}}}}}}}}}}}}}}}, castSpell = {spellId = {spellId = 412096}}}}, {action = {condition = {and = {vals = {{not = {val = {auraIsActive = {auraId = {spellId = 425096}}}}}, {cmp = {op = "OpGe", lhs = {currentEnergy = {}}, rhs = {const = {val = "35"}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "5"}}}}, {gcdIsReady = {}}, {cmp = {op = "OpGe", lhs = {auraNumStacks = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 1214170, tag = 100}}}, rhs = {const = {val = "5"}}}}}}}, strictSequence = {actions = {{castSpell = {spellId = {spellId = 14177}}}, {castSpell = {spellId = {spellId = 1856, rank = 1}}}, {castSpell = {spellId = {spellId = 399963}}}}, name = "someName367"}}}, {action = {condition = {or = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "3"}}}}, {cmp = {op = "OpLe", lhs = {remainingTime = {}}, rhs = {const = {val = "4"}}}}}}}}}}, castSpell = {spellId = {spellId = 399963}}}}, {action = {condition = {cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "3"}}}}, castSpell = {spellId = {spellId = 399956}}}}, {action = {condition = {or = {vals = {{and = {vals = {{cmp = {op = "OpGe", lhs = {auraNumStacks = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 1214170, tag = 100}}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpLt", lhs = {currentComboPoints = {}}, rhs = {const = {val = "5"}}}}}}}, {cmp = {op = "OpLe", lhs = {auraRemainingTime = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 1214170, tag = 100}}}, rhs = {const = {val = "1"}}}}}}}, castSpell = {spellId = {spellId = 425012}}}}},

        -- Tracked IDs for optimization
        spells = {1787, 1856, 6774, 11275, 13877, 14177, 399956, 399963, 412096, 425012, 425096, 432276, 436611, 1214170, 1226843, 1232181},
        items = {7676, 233985},
        auras = {},
        runes = {432271, 432276},

        -- Optional metadata
        glyphs = {},
        lastModified = "06/12/2025",
        author = "APLParser"
    }
)

ns.AddRotationToDefaults(defaults,
    SpecializationCompat:GetSpecID("Rogue", "Subtlety"),
    "Rogue Subtlety - 3Min_Backstab_Phase8_PreRaid by APLParser",
    {
        -- Required parameters
        default = true,
        enabled = true,
        experimental = false,
        gameType = Version.GAME_TYPES.CLASSIC_ERA_SOD,
        prePull = {
            { NAG:Cast(6774), -1000 }
        },
        rotationString = [[
(((NAG:CurrentEnergy() <= 10) and (NAG:CurrentComboPoints() <= 4) and (NAG:TimeToEnergyTick() > 1)) or ((NAG:RemainingTime() <= 15) and (NAG:CurrentEnergy() <= 40) and (NAG:TimeToEnergyTick() > 1))) and NAG:Cast(7676)
    or (((NAG:CurrentEnergy() < 25) and (NAG:CurrentComboPoints() <= 4) and (NAG:TimeToEnergyTick() > 1) and (not NAG:AuraIsActive(467735)) and (not NAG:AuraIsActive(462707))) or ((NAG:RemainingTime() <= 15) and (NAG:CurrentEnergy() < 35) and (NAG:TimeToEnergyTick() > 1) and (not NAG:AuraIsActive(467735)) and (not NAG:AuraIsActive(462707)))) and NAG:Cast(231287)
    or NAG:AutocastOtherCooldowns()
    or (((not NAG:RuneIsEquipped(432276)) and (not NAG:AuraIsActive(1787))) or (NAG:RuneIsEquipped(432276) and NAG:AuraIsActive(432276, "target") and (not NAG:AuraIsActive(1787)))) and NAG:Cast(233985)
    or ((NAG:CurrentEnergy() >= 60) and NAG:AuraIsKnown(467735) and NAG:AuraIsActive(467735)) and NAG:Cast(25300)
    or ((NAG:AuraIsKnown(1232181) and NAG:AuraIsKnown(1226843) and (not NAG:AuraIsActive(11275, "target")) and (NAG:CurrentComboPoints() >= 4) and (NAG:RemainingTime() > 9)) or (NAG:AuraIsKnown(1226843) and (not NAG:AuraIsActive(11275, "target")) and (((NAG:CurrentComboPoints() >= 4) and (NAG:RemainingTime() >= 15)) or ((NAG:CurrentComboPoints() >= 2) and (NAG:RemainingTime() < 15) and (NAG:RemainingTime() >= 9))))) and NAG:Cast(11275)
    or (((not NAG:RuneIsEquipped(432271)) and (NAG:AuraRemainingTime(6774) <= 1) and (not NAG:AuraIsActive(467735)) and (((NAG:CurrentComboPoints() >= 4) and (NAG:RemainingTime() >= 19)) or ((NAG:CurrentComboPoints() >= 2) and (NAG:RemainingTime() < 19) and (NAG:RemainingTime() >= 13)))) or (NAG:RuneIsEquipped(432271) and (not NAG:AuraIsActive(6774)) and (NAG:CurrentComboPoints() >= 1) and (not NAG:AuraIsActive(467735)) and (NAG:RemainingTime() >= 10))) and NAG:Cast(6774)
    or ((NAG:AuraIsKnown(1232181) and (not NAG:AuraIsActive(436611, "target")) and (NAG:CurrentComboPoints() >= 1) and (NAG:RemainingTime() > 5)) or ((NAG:AuraIsKnown(1226843) or NAG:RuneIsEquipped(432276)) and (not NAG:AuraIsActive(436611, "target")) and (((NAG:CurrentComboPoints() >= 4) and (NAG:RemainingTime() >= 11)) or ((NAG:CurrentComboPoints() >= 2) and (NAG:RemainingTime() < 11) and (NAG:RemainingTime() >= 7))))) and NAG:Cast(412096)
    or (((NAG:CurrentComboPoints() >= 5) or ((NAG:RemainingTime() <= 4) and (NAG:CurrentComboPoints() >= 4)))) and NAG:Cast(399963)
    or ((not NAG:AuraIsActive(462707)) and (not NAG:AuraIsActive(425096)) and (NAG:CurrentEnergy() >= 35) and (NAG:CurrentComboPoints() <= 2)) and NAG:Cast(1856)
    or NAG:Cast(11269)
    or NAG:Cast(25300)
    or (((NAG:AuraNumStacks(1214170, "target") >= 4) and (NAG:CurrentComboPoints() < 5))) and NAG:Cast(425012)
        ]],

        -- New action-based format
        --prePullActions = {{action = {addComboPoints = {numPoints = "5"}}, doAtValue = {const = {val = "-3s"}}}, {action = {activateAura = {auraId = {spellId = 1787, rank = 4}}}, doAtValue = {const = {val = "-2s"}}}, {action = {castSpell = {spellId = {spellId = 6774, rank = 2}}}, doAtValue = {const = {val = "-1s"}}}, {action = {castSpell = {spellId = {itemId = 215162}}}, doAtValue = {const = {val = "-0.1s"}}}},
        --aplActions = {{action = {condition = {or = {vals = {{and = {vals = {{cmp = {op = "OpLe", lhs = {currentEnergy = {}}, rhs = {const = {val = "10"}}}}, {cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGt", lhs = {timeToEnergyTick = {}}, rhs = {const = {val = "1"}}}}}}}, {and = {vals = {{cmp = {op = "OpLe", lhs = {remainingTime = {}}, rhs = {const = {val = "15"}}}}, {cmp = {op = "OpLe", lhs = {currentEnergy = {}}, rhs = {const = {val = "40"}}}}, {cmp = {op = "OpGt", lhs = {timeToEnergyTick = {}}, rhs = {const = {val = "1"}}}}}}}}}}, castSpell = {spellId = {itemId = 7676}}}}, {action = {condition = {or = {vals = {{and = {vals = {{cmp = {op = "OpLt", lhs = {currentEnergy = {}}, rhs = {const = {val = "25"}}}}, {cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGt", lhs = {timeToEnergyTick = {}}, rhs = {const = {val = "1"}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 467735}}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 462707}}}}}}}}, {and = {vals = {{cmp = {op = "OpLe", lhs = {remainingTime = {}}, rhs = {const = {val = "15"}}}}, {cmp = {op = "OpLt", lhs = {currentEnergy = {}}, rhs = {const = {val = "35"}}}}, {cmp = {op = "OpGt", lhs = {timeToEnergyTick = {}}, rhs = {const = {val = "1"}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 467735}}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 462707}}}}}}}}}}}, castSpell = {spellId = {itemId = 231287}}}}, {action = {autocastOtherCooldowns = {}}}, {action = {condition = {or = {vals = {{and = {vals = {{not = {val = {runeIsEquipped = {runeId = {spellId = 432276}}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 1787, rank = 4}}}}}}}}, {and = {vals = {{runeIsEquipped = {runeId = {spellId = 432276}}}, {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 432276}}}, {not = {val = {auraIsActive = {auraId = {spellId = 1787, rank = 4}}}}}}}}}}}, castSpell = {spellId = {itemId = 233985}}}}, {action = {condition = {and = {vals = {{cmp = {op = "OpGe", lhs = {currentEnergy = {}}, rhs = {const = {val = "60"}}}}, {auraIsKnown = {auraId = {spellId = 467735}}}, {auraIsActive = {auraId = {spellId = 467735}}}}}}, castSpell = {spellId = {spellId = 25300, rank = 9}}}}, {action = {condition = {or = {vals = {{and = {vals = {{auraIsKnown = {auraId = {spellId = 1232181}}}, {auraIsKnown = {auraId = {spellId = 1226843}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 11275, rank = 6}}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGt", lhs = {remainingTime = {}}, rhs = {const = {val = "9"}}}}}}}, {and = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 11275, rank = 6}}}}}, {or = {vals = {{and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "15"}}}}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {cmp = {op = "OpLt", lhs = {remainingTime = {}}, rhs = {const = {val = "15"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "9"}}}}}}}}}}}}}}}}, castSpell = {spellId = {spellId = 11275, rank = 6}}}}, {action = {condition = {or = {vals = {{and = {vals = {{not = {val = {runeIsEquipped = {runeId = {spellId = 432271}}}}}, {cmp = {op = "OpLe", lhs = {auraRemainingTime = {auraId = {spellId = 6774, rank = 2}}}, rhs = {const = {val = "1"}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 467735}}}}}, {or = {vals = {{and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "19"}}}}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {cmp = {op = "OpLt", lhs = {remainingTime = {}}, rhs = {const = {val = "19"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "13"}}}}}}}}}}}}}, {and = {vals = {{runeIsEquipped = {runeId = {spellId = 432271}}}, {not = {val = {auraIsActive = {auraId = {spellId = 6774, rank = 2}}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "1"}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 467735}}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "10"}}}}}}}}}}, castSpell = {spellId = {spellId = 6774, rank = 2}}}}, {action = {condition = {or = {vals = {{and = {vals = {{auraIsKnown = {auraId = {spellId = 1232181}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 436611}}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "1"}}}}, {cmp = {op = "OpGt", lhs = {remainingTime = {}}, rhs = {const = {val = "5"}}}}}}}, {and = {vals = {{or = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {runeIsEquipped = {runeId = {spellId = 432276}}}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 436611}}}}}, {or = {vals = {{and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "11"}}}}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {cmp = {op = "OpLt", lhs = {remainingTime = {}}, rhs = {const = {val = "11"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "7"}}}}}}}}}}}}}}}}, castSpell = {spellId = {spellId = 412096}}}}, {action = {condition = {and = {vals = {{or = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "5"}}}}, {and = {vals = {{cmp = {op = "OpLe", lhs = {remainingTime = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}}}}}}}}}}, castSpell = {spellId = {spellId = 399963}}}}, {action = {condition = {and = {vals = {{not = {val = {auraIsActive = {auraId = {spellId = 462707}}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 425096}}}}}, {cmp = {op = "OpGe", lhs = {currentEnergy = {}}, rhs = {const = {val = "35"}}}}, {cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}}}}, castSpell = {spellId = {spellId = 1856, rank = 1}}}}, {action = {castSpell = {spellId = {spellId = 11269, rank = 6}}}}, {action = {castSpell = {spellId = {spellId = 25300, rank = 9}}}}, {action = {condition = {or = {vals = {{and = {vals = {{cmp = {op = "OpGe", lhs = {auraNumStacks = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 1214170, tag = 100}}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpLt", lhs = {currentComboPoints = {}}, rhs = {const = {val = "5"}}}}}}}}}}, castSpell = {spellId = {spellId = 425012}}}}},

        -- Tracked IDs for optimization
        spells = {1787, 1856, 6774, 11269, 11275, 25300, 399963, 412096, 425012, 425096, 432276, 436611, 462707, 467735, 1214170, 1226843, 1232181},
        items = {7676, 231287, 233985},
        auras = {},
        runes = {432271, 432276},

        -- Optional metadata
        glyphs = {},
        lastModified = "06/12/2025",
        author = "APLParser"
    }
)

ns.AddRotationToDefaults(defaults,
    SpecializationCompat:GetSpecID("Rogue", "Assassination"),
    "Rogue Assassination - 5Min_Phase8_PreRaid_SaberSlash by APLParser",
    {
        -- Required parameters
        default = true,
        enabled = true,
        experimental = false,
        gameType = Version.GAME_TYPES.CLASSIC_ERA_SOD,
        prePull = {
            { NAG:Cast(6774), -2000 }, { NAG:Cast(13877), -1000 }
        },
        rotationString = [[
((NAG:CurrentEnergy() <= 10) or ((NAG:RemainingTime() <= 15) and (NAG:CurrentEnergy() <= 40))) and NAG:Cast(7676)
    or NAG:AutocastOtherCooldowns()
    or (((not NAG:RuneIsEquipped(432276)) and (not NAG:AuraIsActive(1787))) or (NAG:RuneIsEquipped(432276) and (not NAG:AuraIsActive(1787)) and NAG:AuraIsActive(432276, "target"))) and NAG:Cast(233985)
    or (NAG:AuraIsKnown(1226843) and (not NAG:AuraIsActive(424785, "target")) and (not NAG:AuraIsActive(11275, "target")) and (not NAG:AuraIsActive(436611, "target")) and (NAG:CurrentComboPoints() <= 4)) and NAG:Cast(425012)
    or (NAG:AuraIsKnown(1226843) and (not NAG:AuraIsActive(424785, "target")) and (not NAG:AuraIsActive(11275, "target")) and (not NAG:AuraIsActive(436611, "target")) and (NAG:CurrentComboPoints() >= 1)) and NAG:Cast(412096)
    or ((NAG:CurrentComboPoints() <= 4) and ((NAG:AuraNumStacks(424785, "target") < 3) or (NAG:AuraRemainingTime(424785, "target") < 2)) and (NAG:AuraRemainingTime(424785, "target") < (NAG:RemainingTime() + 2))) and NAG:Cast(424785)
    or (((not NAG:RuneIsEquipped(432276)) and NAG:AuraIsActive(6774) and NAG:AuraIsActive(399963)) or (NAG:RuneIsEquipped(432276) and NAG:AuraIsActive(432276, "target") and NAG:AuraIsActive(6774) and NAG:AuraIsActive(399963))) and NAG:Cast(13877)
    or ((NAG:AuraNumStacks(1214170, "target") >= 4) and (NAG:CurrentComboPoints() < 5) and (NAG:CurrentEnergy() <= 75)) and NAG:Cast(425012)
    or (((not NAG:RuneIsEquipped(432271)) and (NAG:AuraRemainingTime(6774) <= 1) and (((NAG:CurrentComboPoints() >= 4) and (NAG:RemainingTime() >= 19)) or ((NAG:CurrentComboPoints() >= 2) and (NAG:RemainingTime() < 19) and (NAG:RemainingTime() >= 13)))) or (NAG:RuneIsEquipped(432271) and (not NAG:AuraIsActive(6774)) and (NAG:CurrentComboPoints() >= 1) and (NAG:RemainingTime() >= 10))) and NAG:Cast(6774)
    or ((NAG:AuraIsKnown(1226843) and NAG:AuraIsKnown(1232181) and (not NAG:RuneIsEquipped(432271)) and (not NAG:AuraIsActive(436611, "target")) and (NAG:CurrentComboPoints() >= 1) and (NAG:RemainingTime() >= 5)) or (NAG:AuraIsKnown(1226843) and (not NAG:RuneIsEquipped(432271)) and (not NAG:AuraIsActive(436611, "target")) and (((NAG:CurrentComboPoints() >= 4) and (NAG:RemainingTime() >= 11)) or ((NAG:CurrentComboPoints() >= 2) and (NAG:RemainingTime() < 11) and (NAG:RemainingTime() >= 7))))) and NAG:Cast(412096)
    or ((not NAG:AuraIsActive(425096)) and (NAG:CurrentEnergy() >= 35) and (NAG:CurrentComboPoints() >= 5) and NAG:GCDIsReady() and (NAG:AuraNumStacks(1214170, "target") >= 5)) and NAG:StrictSequence("foo", NAG:Cast(14177), NAG:Cast(1856), NAG:Cast(399963))
    or ((NAG:CurrentComboPoints() >= 4) or ((NAG:CurrentComboPoints() >= 3) and (NAG:RemainingTime() <= 4))) and NAG:Cast(399963)
    or ((NAG:AuraIsKnown(1226843) and (NAG:CurrentComboPoints() <= 4) and (NAG:CurrentEnergy() >= 75) and (NAG:AuraRemainingTime(424785, "target") >= 8) and (NAG:AuraNumStacks(424785, "target") >= 3)) or (NAG:AuraIsKnown(1226843) and (NAG:CurrentComboPoints() <= 2) and (NAG:AuraRemainingTime(424785, "target") >= 8) and (NAG:AuraNumStacks(424785, "target") >= 3)) or (NAG:AuraIsKnown(1226843) and (NAG:CurrentComboPoints() <= 2) and (NAG:RemainingTime() <= 4) and (NAG:AuraNumStacks(424785, "target") >= 3))) and NAG:Cast(11294)
    or ((NAG:CurrentComboPoints() <= 2) or ((NAG:CurrentComboPoints() <= 4) and (NAG:CurrentEnergy() >= 75))) and NAG:Cast(424785)
        ]],

        -- New action-based format
        --prePullActions = {{action = {addComboPoints = {numPoints = "5"}}, doAtValue = {const = {val = "-4s"}}}, {action = {activateAura = {auraId = {spellId = 1787, rank = 4}}}, doAtValue = {const = {val = "-3s"}}}, {action = {castSpell = {spellId = {spellId = 6774, rank = 2}}}, doAtValue = {const = {val = "-2s"}}}, {action = {castSpell = {spellId = {spellId = 13877}}}, doAtValue = {const = {val = "-1s"}}}, {action = {castSpell = {spellId = {itemId = 215162}}}, doAtValue = {const = {val = "-0.1s"}}}},
        --aplActions = {{action = {condition = {or = {vals = {{cmp = {op = "OpLe", lhs = {currentEnergy = {}}, rhs = {const = {val = "10"}}}}, {and = {vals = {{cmp = {op = "OpLe", lhs = {remainingTime = {}}, rhs = {const = {val = "15"}}}}, {cmp = {op = "OpLe", lhs = {currentEnergy = {}}, rhs = {const = {val = "40"}}}}}}}}}}, castSpell = {spellId = {itemId = 7676}}}}, {action = {autocastOtherCooldowns = {}}}, {action = {condition = {or = {vals = {{and = {vals = {{not = {val = {runeIsEquipped = {runeId = {spellId = 432276}}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 1787, rank = 4}}}}}}}}, {and = {vals = {{runeIsEquipped = {runeId = {spellId = 432276}}}, {not = {val = {auraIsActive = {auraId = {spellId = 1787, rank = 4}}}}}, {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 432276}}}}}}}}}, castSpell = {spellId = {itemId = 233985}}}}, {action = {condition = {and = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 424785}}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 11275, rank = 6}}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 436611}}}}}, {cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}}}}, castSpell = {spellId = {spellId = 425012}}}}, {action = {condition = {and = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 424785}}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 11275, rank = 6}}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 436611}}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "1"}}}}}}}, castSpell = {spellId = {spellId = 412096}}}}, {action = {condition = {and = {vals = {{cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {or = {vals = {{cmp = {op = "OpLt", lhs = {auraNumStacks = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 424785}}}, rhs = {const = {val = "3"}}}}, {cmp = {op = "OpLt", lhs = {auraRemainingTime = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 424785}}}, rhs = {const = {val = "2"}}}}}}}, {cmp = {op = "OpLt", lhs = {auraRemainingTime = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 424785}}}, rhs = {math = {op = "OpAdd", lhs = {remainingTime = {}}, rhs = {const = {val = "2"}}}}}}}}}, castSpell = {spellId = {spellId = 424785}}}}, {action = {condition = {or = {vals = {{and = {vals = {{not = {val = {runeIsEquipped = {runeId = {spellId = 432276}}}}}, {auraIsActive = {auraId = {spellId = 6774, rank = 2}}}, {auraIsActive = {auraId = {spellId = 399963}}}}}}, {and = {vals = {{runeIsEquipped = {runeId = {spellId = 432276}}}, {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 432276}}}, {auraIsActive = {auraId = {spellId = 6774, rank = 2}}}, {auraIsActive = {auraId = {spellId = 399963}}}}}}}}}, castSpell = {spellId = {spellId = 13877}}}}, {action = {condition = {and = {vals = {{cmp = {op = "OpGe", lhs = {auraNumStacks = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 1214170, tag = 100}}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpLt", lhs = {currentComboPoints = {}}, rhs = {const = {val = "5"}}}}, {cmp = {op = "OpLe", lhs = {currentEnergy = {}}, rhs = {const = {val = "75"}}}}}}}, castSpell = {spellId = {spellId = 425012}}}}, {action = {condition = {or = {vals = {{and = {vals = {{not = {val = {runeIsEquipped = {runeId = {spellId = 432271}}}}}, {cmp = {op = "OpLe", lhs = {auraRemainingTime = {auraId = {spellId = 6774, rank = 2}}}, rhs = {const = {val = "1"}}}}, {or = {vals = {{and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "19"}}}}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {cmp = {op = "OpLt", lhs = {remainingTime = {}}, rhs = {const = {val = "19"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "13"}}}}}}}}}}}}}, {and = {vals = {{runeIsEquipped = {runeId = {spellId = 432271}}}, {not = {val = {auraIsActive = {auraId = {spellId = 6774, rank = 2}}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "1"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "10"}}}}}}}}}}, castSpell = {spellId = {spellId = 6774, rank = 2}}}}, {action = {condition = {or = {vals = {{and = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {auraIsKnown = {auraId = {spellId = 1232181}}}, {not = {val = {runeIsEquipped = {runeId = {spellId = 432271}}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 436611}}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "1"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "5"}}}}}}}, {and = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {not = {val = {runeIsEquipped = {runeId = {spellId = 432271}}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 436611}}}}}, {or = {vals = {{and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "11"}}}}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {cmp = {op = "OpLt", lhs = {remainingTime = {}}, rhs = {const = {val = "11"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "7"}}}}}}}}}}}}}}}}, castSpell = {spellId = {spellId = 412096}}}}, {hide = true, action = {condition = {or = {vals = {{and = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {auraIsKnown = {auraId = {spellId = 1232181}}}, {not = {val = {runeIsEquipped = {runeId = {spellId = 432271}}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 11275, rank = 6}}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "3"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "9"}}}}}}}, {and = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {not = {val = {runeIsEquipped = {runeId = {spellId = 432271}}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 11275, rank = 6}}}}}, {or = {vals = {{and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "15"}}}}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {cmp = {op = "OpLt", lhs = {remainingTime = {}}, rhs = {const = {val = "15"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "9"}}}}}}}}}}}}}}}}, castSpell = {spellId = {spellId = 11275, rank = 6}}}}, {action = {condition = {and = {vals = {{not = {val = {auraIsActive = {auraId = {spellId = 425096}}}}}, {cmp = {op = "OpGe", lhs = {currentEnergy = {}}, rhs = {const = {val = "35"}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "5"}}}}, {gcdIsReady = {}}, {cmp = {op = "OpGe", lhs = {auraNumStacks = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 1214170, tag = 100}}}, rhs = {const = {val = "5"}}}}}}}, strictSequence = {actions = {{castSpell = {spellId = {spellId = 14177}}}, {castSpell = {spellId = {spellId = 1856, rank = 1}}}, {castSpell = {spellId = {spellId = 399963}}}}, name = "someName855"}}}, {action = {condition = {or = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "3"}}}}, {cmp = {op = "OpLe", lhs = {remainingTime = {}}, rhs = {const = {val = "4"}}}}}}}}}}, castSpell = {spellId = {spellId = 399963}}}}, {action = {condition = {or = {vals = {{and = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {currentEnergy = {}}, rhs = {const = {val = "75"}}}}, {cmp = {op = "OpGe", lhs = {auraRemainingTime = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 424785}}}, rhs = {const = {val = "8"}}}}, {cmp = {op = "OpGe", lhs = {auraNumStacks = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 424785}}}, rhs = {const = {val = "3"}}}}}}}, {and = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {cmp = {op = "OpGe", lhs = {auraRemainingTime = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 424785}}}, rhs = {const = {val = "8"}}}}, {cmp = {op = "OpGe", lhs = {auraNumStacks = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 424785}}}, rhs = {const = {val = "3"}}}}}}}, {and = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {cmp = {op = "OpLe", lhs = {remainingTime = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {auraNumStacks = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 424785}}}, rhs = {const = {val = "3"}}}}}}}}}}, castSpell = {spellId = {spellId = 11294, rank = 8}}}}, {action = {condition = {or = {vals = {{cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {and = {vals = {{cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {currentEnergy = {}}, rhs = {const = {val = "75"}}}}}}}}}}, castSpell = {spellId = {spellId = 424785}}}}},

        -- Tracked IDs for optimization
        spells = {1787, 1856, 6774, 11275, 11294, 13877, 14177, 399963, 412096, 424785, 425012, 425096, 432276, 436611, 1214170, 1226843, 1232181},
        items = {7676, 233985},
        auras = {},
        runes = {432271, 432276},

        -- Optional metadata
        glyphs = {},
        lastModified = "06/12/2025",
        author = "APLParser"
    }
)

ns.AddRotationToDefaults(defaults,
    SpecializationCompat:GetSpecID("Rogue", "Subtlety"),
    "Rogue Subtlety - 5Min_Phase8_PreRaid_SaberSlash by APLParser",
    {
        -- Required parameters
        default = true,
        enabled = true,
        experimental = false,
        gameType = Version.GAME_TYPES.CLASSIC_ERA_SOD,
        prePull = {
            { NAG:Cast(6774), -2000 }, { NAG:Cast(13877), -1000 }
        },
        rotationString = [[
((NAG:CurrentEnergy() <= 10) or ((NAG:RemainingTime() <= 15) and (NAG:CurrentEnergy() <= 40))) and NAG:Cast(7676)
    or NAG:AutocastOtherCooldowns()
    or (((not NAG:RuneIsEquipped(432276)) and (not NAG:AuraIsActive(1787))) or (NAG:RuneIsEquipped(432276) and (not NAG:AuraIsActive(1787)) and NAG:AuraIsActive(432276, "target"))) and NAG:Cast(233985)
    or (NAG:AuraIsKnown(1226843) and (not NAG:AuraIsActive(424785, "target")) and (not NAG:AuraIsActive(11275, "target")) and (not NAG:AuraIsActive(436611, "target")) and (NAG:CurrentComboPoints() <= 4)) and NAG:Cast(425012)
    or (NAG:AuraIsKnown(1226843) and (not NAG:AuraIsActive(424785, "target")) and (not NAG:AuraIsActive(11275, "target")) and (not NAG:AuraIsActive(436611, "target")) and (NAG:CurrentComboPoints() >= 1)) and NAG:Cast(412096)
    or ((NAG:CurrentComboPoints() <= 4) and ((NAG:AuraNumStacks(424785, "target") < 3) or (NAG:AuraRemainingTime(424785, "target") < 2)) and (NAG:AuraRemainingTime(424785, "target") < (NAG:RemainingTime() + 2))) and NAG:Cast(424785)
    or (((not NAG:RuneIsEquipped(432276)) and NAG:AuraIsActive(6774) and NAG:AuraIsActive(399963)) or (NAG:RuneIsEquipped(432276) and NAG:AuraIsActive(432276, "target") and NAG:AuraIsActive(6774) and NAG:AuraIsActive(399963))) and NAG:Cast(13877)
    or ((NAG:AuraNumStacks(1214170, "target") >= 4) and (NAG:CurrentComboPoints() < 5) and (NAG:CurrentEnergy() <= 75)) and NAG:Cast(425012)
    or (((not NAG:RuneIsEquipped(432271)) and (NAG:AuraRemainingTime(6774) <= 1) and (((NAG:CurrentComboPoints() >= 4) and (NAG:RemainingTime() >= 19)) or ((NAG:CurrentComboPoints() >= 2) and (NAG:RemainingTime() < 19) and (NAG:RemainingTime() >= 13)))) or (NAG:RuneIsEquipped(432271) and (not NAG:AuraIsActive(6774)) and (NAG:CurrentComboPoints() >= 1) and (NAG:RemainingTime() >= 10))) and NAG:Cast(6774)
    or ((NAG:AuraIsKnown(1226843) and NAG:AuraIsKnown(1232181) and (not NAG:RuneIsEquipped(432271)) and (not NAG:AuraIsActive(436611, "target")) and (NAG:CurrentComboPoints() >= 1) and (NAG:RemainingTime() >= 5)) or (NAG:AuraIsKnown(1226843) and (not NAG:RuneIsEquipped(432271)) and (not NAG:AuraIsActive(436611, "target")) and (((NAG:CurrentComboPoints() >= 4) and (NAG:RemainingTime() >= 11)) or ((NAG:CurrentComboPoints() >= 2) and (NAG:RemainingTime() < 11) and (NAG:RemainingTime() >= 7))))) and NAG:Cast(412096)
    or ((not NAG:AuraIsActive(425096)) and (NAG:CurrentEnergy() >= 35) and (NAG:CurrentComboPoints() >= 5) and NAG:GCDIsReady() and (NAG:AuraNumStacks(1214170, "target") >= 5)) and NAG:StrictSequence("foo", NAG:Cast(14177), NAG:Cast(1856), NAG:Cast(399963))
    or ((NAG:CurrentComboPoints() >= 4) or ((NAG:CurrentComboPoints() >= 3) and (NAG:RemainingTime() <= 4))) and NAG:Cast(399963)
    or ((NAG:AuraIsKnown(1226843) and (NAG:CurrentComboPoints() <= 4) and (NAG:CurrentEnergy() >= 75) and (NAG:AuraRemainingTime(424785, "target") >= 8) and (NAG:AuraNumStacks(424785, "target") >= 3)) or (NAG:AuraIsKnown(1226843) and (NAG:CurrentComboPoints() <= 2) and (NAG:AuraRemainingTime(424785, "target") >= 8) and (NAG:AuraNumStacks(424785, "target") >= 3)) or (NAG:AuraIsKnown(1226843) and (NAG:CurrentComboPoints() <= 2) and (NAG:RemainingTime() <= 4) and (NAG:AuraNumStacks(424785, "target") >= 3))) and NAG:Cast(11294)
    or ((NAG:CurrentComboPoints() <= 2) or ((NAG:CurrentComboPoints() <= 4) and (NAG:CurrentEnergy() >= 75))) and NAG:Cast(424785)
        ]],

        -- New action-based format
        --prePullActions = {{action = {addComboPoints = {numPoints = "5"}}, doAtValue = {const = {val = "-4s"}}}, {action = {activateAura = {auraId = {spellId = 1787, rank = 4}}}, doAtValue = {const = {val = "-3s"}}}, {action = {castSpell = {spellId = {spellId = 6774, rank = 2}}}, doAtValue = {const = {val = "-2s"}}}, {action = {castSpell = {spellId = {spellId = 13877}}}, doAtValue = {const = {val = "-1s"}}}, {action = {castSpell = {spellId = {itemId = 215162}}}, doAtValue = {const = {val = "-0.1s"}}}},
        --aplActions = {{action = {condition = {or = {vals = {{cmp = {op = "OpLe", lhs = {currentEnergy = {}}, rhs = {const = {val = "10"}}}}, {and = {vals = {{cmp = {op = "OpLe", lhs = {remainingTime = {}}, rhs = {const = {val = "15"}}}}, {cmp = {op = "OpLe", lhs = {currentEnergy = {}}, rhs = {const = {val = "40"}}}}}}}}}}, castSpell = {spellId = {itemId = 7676}}}}, {action = {autocastOtherCooldowns = {}}}, {action = {condition = {or = {vals = {{and = {vals = {{not = {val = {runeIsEquipped = {runeId = {spellId = 432276}}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 1787, rank = 4}}}}}}}}, {and = {vals = {{runeIsEquipped = {runeId = {spellId = 432276}}}, {not = {val = {auraIsActive = {auraId = {spellId = 1787, rank = 4}}}}}, {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 432276}}}}}}}}}, castSpell = {spellId = {itemId = 233985}}}}, {action = {condition = {and = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 424785}}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 11275, rank = 6}}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 436611}}}}}, {cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}}}}, castSpell = {spellId = {spellId = 425012}}}}, {action = {condition = {and = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 424785}}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 11275, rank = 6}}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 436611}}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "1"}}}}}}}, castSpell = {spellId = {spellId = 412096}}}}, {action = {condition = {and = {vals = {{cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {or = {vals = {{cmp = {op = "OpLt", lhs = {auraNumStacks = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 424785}}}, rhs = {const = {val = "3"}}}}, {cmp = {op = "OpLt", lhs = {auraRemainingTime = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 424785}}}, rhs = {const = {val = "2"}}}}}}}, {cmp = {op = "OpLt", lhs = {auraRemainingTime = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 424785}}}, rhs = {math = {op = "OpAdd", lhs = {remainingTime = {}}, rhs = {const = {val = "2"}}}}}}}}}, castSpell = {spellId = {spellId = 424785}}}}, {action = {condition = {or = {vals = {{and = {vals = {{not = {val = {runeIsEquipped = {runeId = {spellId = 432276}}}}}, {auraIsActive = {auraId = {spellId = 6774, rank = 2}}}, {auraIsActive = {auraId = {spellId = 399963}}}}}}, {and = {vals = {{runeIsEquipped = {runeId = {spellId = 432276}}}, {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 432276}}}, {auraIsActive = {auraId = {spellId = 6774, rank = 2}}}, {auraIsActive = {auraId = {spellId = 399963}}}}}}}}}, castSpell = {spellId = {spellId = 13877}}}}, {action = {condition = {and = {vals = {{cmp = {op = "OpGe", lhs = {auraNumStacks = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 1214170, tag = 100}}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpLt", lhs = {currentComboPoints = {}}, rhs = {const = {val = "5"}}}}, {cmp = {op = "OpLe", lhs = {currentEnergy = {}}, rhs = {const = {val = "75"}}}}}}}, castSpell = {spellId = {spellId = 425012}}}}, {action = {condition = {or = {vals = {{and = {vals = {{not = {val = {runeIsEquipped = {runeId = {spellId = 432271}}}}}, {cmp = {op = "OpLe", lhs = {auraRemainingTime = {auraId = {spellId = 6774, rank = 2}}}, rhs = {const = {val = "1"}}}}, {or = {vals = {{and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "19"}}}}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {cmp = {op = "OpLt", lhs = {remainingTime = {}}, rhs = {const = {val = "19"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "13"}}}}}}}}}}}}}, {and = {vals = {{runeIsEquipped = {runeId = {spellId = 432271}}}, {not = {val = {auraIsActive = {auraId = {spellId = 6774, rank = 2}}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "1"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "10"}}}}}}}}}}, castSpell = {spellId = {spellId = 6774, rank = 2}}}}, {action = {condition = {or = {vals = {{and = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {auraIsKnown = {auraId = {spellId = 1232181}}}, {not = {val = {runeIsEquipped = {runeId = {spellId = 432271}}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 436611}}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "1"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "5"}}}}}}}, {and = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {not = {val = {runeIsEquipped = {runeId = {spellId = 432271}}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 436611}}}}}, {or = {vals = {{and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "11"}}}}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {cmp = {op = "OpLt", lhs = {remainingTime = {}}, rhs = {const = {val = "11"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "7"}}}}}}}}}}}}}}}}, castSpell = {spellId = {spellId = 412096}}}}, {hide = true, action = {condition = {or = {vals = {{and = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {auraIsKnown = {auraId = {spellId = 1232181}}}, {not = {val = {runeIsEquipped = {runeId = {spellId = 432271}}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 11275, rank = 6}}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "3"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "9"}}}}}}}, {and = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {not = {val = {runeIsEquipped = {runeId = {spellId = 432271}}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 11275, rank = 6}}}}}, {or = {vals = {{and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "15"}}}}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {cmp = {op = "OpLt", lhs = {remainingTime = {}}, rhs = {const = {val = "15"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "9"}}}}}}}}}}}}}}}}, castSpell = {spellId = {spellId = 11275, rank = 6}}}}, {action = {condition = {and = {vals = {{not = {val = {auraIsActive = {auraId = {spellId = 425096}}}}}, {cmp = {op = "OpGe", lhs = {currentEnergy = {}}, rhs = {const = {val = "35"}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "5"}}}}, {gcdIsReady = {}}, {cmp = {op = "OpGe", lhs = {auraNumStacks = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 1214170, tag = 100}}}, rhs = {const = {val = "5"}}}}}}}, strictSequence = {actions = {{castSpell = {spellId = {spellId = 14177}}}, {castSpell = {spellId = {spellId = 1856, rank = 1}}}, {castSpell = {spellId = {spellId = 399963}}}}, name = "someName40"}}}, {action = {condition = {or = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "3"}}}}, {cmp = {op = "OpLe", lhs = {remainingTime = {}}, rhs = {const = {val = "4"}}}}}}}}}}, castSpell = {spellId = {spellId = 399963}}}}, {action = {condition = {or = {vals = {{and = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {currentEnergy = {}}, rhs = {const = {val = "75"}}}}, {cmp = {op = "OpGe", lhs = {auraRemainingTime = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 424785}}}, rhs = {const = {val = "8"}}}}, {cmp = {op = "OpGe", lhs = {auraNumStacks = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 424785}}}, rhs = {const = {val = "3"}}}}}}}, {and = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {cmp = {op = "OpGe", lhs = {auraRemainingTime = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 424785}}}, rhs = {const = {val = "8"}}}}, {cmp = {op = "OpGe", lhs = {auraNumStacks = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 424785}}}, rhs = {const = {val = "3"}}}}}}}, {and = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {cmp = {op = "OpLe", lhs = {remainingTime = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {auraNumStacks = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 424785}}}, rhs = {const = {val = "3"}}}}}}}}}}, castSpell = {spellId = {spellId = 11294, rank = 8}}}}, {action = {condition = {or = {vals = {{cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {and = {vals = {{cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {currentEnergy = {}}, rhs = {const = {val = "75"}}}}}}}}}}, castSpell = {spellId = {spellId = 424785}}}}},

        -- Tracked IDs for optimization
        spells = {1787, 1856, 6774, 11275, 11294, 13877, 14177, 399963, 412096, 424785, 425012, 425096, 432276, 436611, 1214170, 1226843, 1232181},
        items = {7676, 233985},
        auras = {},
        runes = {432271, 432276},

        -- Optional metadata
        glyphs = {},
        lastModified = "06/12/2025",
        author = "APLParser"
    }
)

ns.AddRotationToDefaults(defaults,
    SpecializationCompat:GetSpecID("Rogue", "Assassination"),
    "Rogue Assassination - 5Min_Mutilate_Phase8_PreRaid by APLParser",
    {
        -- Required parameters
        default = true,
        enabled = true,
        experimental = false,
        gameType = Version.GAME_TYPES.CLASSIC_ERA_SOD,
        prePull = {
            { NAG:Cast(6774), -2000 }, { NAG:Cast(13877), -1000 }
        },
        rotationString = [[
((NAG:CurrentEnergy() <= 10) or ((NAG:RemainingTime() <= 20) and (NAG:CurrentEnergy() <= 40))) and NAG:Cast(7676)
    or NAG:AutocastOtherCooldowns()
    or (((not NAG:RuneIsEquipped(432276)) and (not NAG:AuraIsActive(1787))) or (NAG:RuneIsEquipped(432276) and NAG:AuraIsActive(432276, "target") and (not NAG:AuraIsActive(1787)))) and NAG:Cast(233985)
    or (((not NAG:RuneIsEquipped(432276)) and NAG:AuraIsActive(6774) and NAG:AuraIsActive(399963)) or (NAG:RuneIsEquipped(432276) and NAG:AuraIsActive(432276, "target") and NAG:AuraIsActive(6774) and NAG:AuraIsActive(399963))) and NAG:Cast(13877)
    or ((NAG:AuraIsKnown(1226843) and NAG:AuraIsKnown(1232181) and (not NAG:AuraIsActive(11275, "target")) and (NAG:CurrentComboPoints() >= 3) and (NAG:RemainingTime() >= 9)) or (NAG:AuraIsKnown(1226843) and (not NAG:AuraIsActive(11275, "target")) and (((NAG:CurrentComboPoints() >= 4) and (NAG:RemainingTime() >= 15)) or ((NAG:CurrentComboPoints() >= 2) and (NAG:RemainingTime() < 15) and (NAG:RemainingTime() >= 9))))) and NAG:Cast(11275)
    or (((not NAG:RuneIsEquipped(432271)) and (NAG:AuraRemainingTime(6774) <= 1) and (((NAG:CurrentComboPoints() >= 4) and (NAG:RemainingTime() >= 19)) or ((NAG:CurrentComboPoints() >= 2) and (NAG:RemainingTime() < 19) and (NAG:RemainingTime() >= 13)))) or (NAG:RuneIsEquipped(432271) and (not NAG:AuraIsActive(6774)) and (NAG:CurrentComboPoints() >= 1) and (NAG:RemainingTime() >= 10))) and NAG:Cast(6774)
    or ((NAG:AuraIsKnown(1232181) and (NAG:AuraIsKnown(1226843) or NAG:RuneIsEquipped(432276)) and (not NAG:AuraIsActive(436611, "target")) and (NAG:CurrentComboPoints() >= 1) and (NAG:RemainingTime() >= 5)) or ((NAG:AuraIsKnown(1226843) or NAG:RuneIsEquipped(432276)) and (not NAG:AuraIsActive(436611, "target")) and (((NAG:CurrentComboPoints() >= 4) and (NAG:RemainingTime() >= 11)) or ((NAG:CurrentComboPoints() >= 2) and (NAG:RemainingTime() < 11) and (NAG:RemainingTime() >= 7))))) and NAG:Cast(412096)
    or ((not NAG:AuraIsActive(425096)) and (NAG:CurrentEnergy() >= 35) and (NAG:CurrentComboPoints() >= 5) and NAG:GCDIsReady() and (NAG:AuraNumStacks(1214170, "target") >= 5)) and NAG:StrictSequence("foo", NAG:Cast(14177), NAG:Cast(1856), NAG:Cast(399963))
    or ((NAG:CurrentComboPoints() >= 4) or ((NAG:CurrentComboPoints() >= 3) and (NAG:RemainingTime() <= 4))) and NAG:Cast(399963)
    or (NAG:CurrentComboPoints() <= 3) and NAG:Cast(399956)
    or (((NAG:AuraNumStacks(1214170, "target") >= 4) and (NAG:CurrentComboPoints() < 5)) or (NAG:AuraRemainingTime(1214170, "target") <= 1)) and NAG:Cast(425012)
        ]],

        -- New action-based format
        --prePullActions = {{action = {addComboPoints = {numPoints = "5"}}, doAtValue = {const = {val = "-4s"}}}, {action = {activateAura = {auraId = {spellId = 1787, rank = 4}}}, doAtValue = {const = {val = "-3s"}}}, {action = {castSpell = {spellId = {spellId = 6774, rank = 2}}}, doAtValue = {const = {val = "-2s"}}}, {action = {castSpell = {spellId = {spellId = 13877}}}, doAtValue = {const = {val = "-1s"}}}, {action = {castSpell = {spellId = {itemId = 215162}}}, doAtValue = {const = {val = "-0.1s"}}}},
        --aplActions = {{action = {condition = {or = {vals = {{cmp = {op = "OpLe", lhs = {currentEnergy = {}}, rhs = {const = {val = "10"}}}}, {and = {vals = {{cmp = {op = "OpLe", lhs = {remainingTime = {}}, rhs = {const = {val = "20"}}}}, {cmp = {op = "OpLe", lhs = {currentEnergy = {}}, rhs = {const = {val = "40"}}}}}}}}}}, castSpell = {spellId = {itemId = 7676}}}}, {action = {autocastOtherCooldowns = {}}}, {action = {condition = {or = {vals = {{and = {vals = {{not = {val = {runeIsEquipped = {runeId = {spellId = 432276}}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 1787, rank = 4}}}}}}}}, {and = {vals = {{runeIsEquipped = {runeId = {spellId = 432276}}}, {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 432276}}}, {not = {val = {auraIsActive = {auraId = {spellId = 1787, rank = 4}}}}}}}}}}}, castSpell = {spellId = {itemId = 233985}}}}, {action = {condition = {or = {vals = {{and = {vals = {{not = {val = {runeIsEquipped = {runeId = {spellId = 432276}}}}}, {auraIsActive = {auraId = {spellId = 6774, rank = 2}}}, {auraIsActive = {auraId = {spellId = 399963}}}}}}, {and = {vals = {{runeIsEquipped = {runeId = {spellId = 432276}}}, {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 432276}}}, {auraIsActive = {auraId = {spellId = 6774, rank = 2}}}, {auraIsActive = {auraId = {spellId = 399963}}}}}}}}}, castSpell = {spellId = {spellId = 13877}}}}, {action = {condition = {or = {vals = {{and = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {auraIsKnown = {auraId = {spellId = 1232181}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 11275, rank = 6}}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "3"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "9"}}}}}}}, {and = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 11275, rank = 6}}}}}, {or = {vals = {{and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "15"}}}}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {cmp = {op = "OpLt", lhs = {remainingTime = {}}, rhs = {const = {val = "15"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "9"}}}}}}}}}}}}}}}}, castSpell = {spellId = {spellId = 11275, rank = 6}}}}, {action = {condition = {or = {vals = {{and = {vals = {{not = {val = {runeIsEquipped = {runeId = {spellId = 432271}}}}}, {cmp = {op = "OpLe", lhs = {auraRemainingTime = {auraId = {spellId = 6774, rank = 2}}}, rhs = {const = {val = "1"}}}}, {or = {vals = {{and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "19"}}}}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {cmp = {op = "OpLt", lhs = {remainingTime = {}}, rhs = {const = {val = "19"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "13"}}}}}}}}}}}}}, {and = {vals = {{runeIsEquipped = {runeId = {spellId = 432271}}}, {not = {val = {auraIsActive = {auraId = {spellId = 6774, rank = 2}}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "1"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "10"}}}}}}}}}}, castSpell = {spellId = {spellId = 6774, rank = 2}}}}, {action = {condition = {or = {vals = {{and = {vals = {{auraIsKnown = {auraId = {spellId = 1232181}}}, {or = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {runeIsEquipped = {runeId = {spellId = 432276}}}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 436611}}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "1"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "5"}}}}}}}, {and = {vals = {{or = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {runeIsEquipped = {runeId = {spellId = 432276}}}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 436611}}}}}, {or = {vals = {{and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "11"}}}}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {cmp = {op = "OpLt", lhs = {remainingTime = {}}, rhs = {const = {val = "11"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "7"}}}}}}}}}}}}}}}}, castSpell = {spellId = {spellId = 412096}}}}, {action = {condition = {and = {vals = {{not = {val = {auraIsActive = {auraId = {spellId = 425096}}}}}, {cmp = {op = "OpGe", lhs = {currentEnergy = {}}, rhs = {const = {val = "35"}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "5"}}}}, {gcdIsReady = {}}, {cmp = {op = "OpGe", lhs = {auraNumStacks = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 1214170, tag = 100}}}, rhs = {const = {val = "5"}}}}}}}, strictSequence = {actions = {{castSpell = {spellId = {spellId = 14177}}}, {castSpell = {spellId = {spellId = 1856, rank = 1}}}, {castSpell = {spellId = {spellId = 399963}}}}, name = "someName792"}}}, {action = {condition = {or = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "3"}}}}, {cmp = {op = "OpLe", lhs = {remainingTime = {}}, rhs = {const = {val = "4"}}}}}}}}}}, castSpell = {spellId = {spellId = 399963}}}}, {action = {condition = {cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "3"}}}}, castSpell = {spellId = {spellId = 399956}}}}, {action = {condition = {or = {vals = {{and = {vals = {{cmp = {op = "OpGe", lhs = {auraNumStacks = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 1214170, tag = 100}}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpLt", lhs = {currentComboPoints = {}}, rhs = {const = {val = "5"}}}}}}}, {cmp = {op = "OpLe", lhs = {auraRemainingTime = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 1214170, tag = 100}}}, rhs = {const = {val = "1"}}}}}}}, castSpell = {spellId = {spellId = 425012}}}}},

        -- Tracked IDs for optimization
        spells = {1787, 1856, 6774, 11275, 13877, 14177, 399956, 399963, 412096, 425012, 425096, 432276, 436611, 1214170, 1226843, 1232181},
        items = {7676, 233985},
        auras = {},
        runes = {432271, 432276},

        -- Optional metadata
        glyphs = {},
        lastModified = "06/12/2025",
        author = "APLParser"
    }
)

ns.AddRotationToDefaults(defaults,
    SpecializationCompat:GetSpecID("Rogue", "Subtlety"),
    "Rogue Subtlety - 5Min_Backstab_Phase8_PreRaid by APLParser",
    {
        -- Required parameters
        default = true,
        enabled = true,
        experimental = false,
        gameType = Version.GAME_TYPES.CLASSIC_ERA_SOD,
        prePull = {
            { NAG:Cast(6774), -1000 }
        },
        rotationString = [[
(((NAG:CurrentEnergy() <= 10) and (NAG:CurrentComboPoints() <= 4) and (NAG:TimeToEnergyTick() > 1)) or ((NAG:RemainingTime() <= 15) and (NAG:CurrentEnergy() <= 40) and (NAG:TimeToEnergyTick() > 1))) and NAG:Cast(7676)
    or (((NAG:CurrentEnergy() < 25) and (NAG:CurrentComboPoints() <= 4) and (NAG:TimeToEnergyTick() > 1) and (not NAG:AuraIsActive(467735)) and (not NAG:AuraIsActive(462707))) or ((NAG:RemainingTime() <= 15) and (NAG:CurrentEnergy() < 35) and (NAG:TimeToEnergyTick() > 1) and (not NAG:AuraIsActive(467735)) and (not NAG:AuraIsActive(462707)))) and NAG:Cast(231287)
    or NAG:AutocastOtherCooldowns()
    or (((not NAG:RuneIsEquipped(432276)) and (not NAG:AuraIsActive(1787))) or (NAG:RuneIsEquipped(432276) and NAG:AuraIsActive(432276, "target") and (not NAG:AuraIsActive(1787)))) and NAG:Cast(233985)
    or ((NAG:CurrentEnergy() >= 60) and NAG:AuraIsKnown(467735) and NAG:AuraIsActive(467735)) and NAG:Cast(25300)
    or ((NAG:AuraIsKnown(1232181) and NAG:AuraIsKnown(1226843) and (not NAG:AuraIsActive(11275, "target")) and (NAG:CurrentComboPoints() >= 4) and (NAG:RemainingTime() > 9)) or (NAG:AuraIsKnown(1226843) and (not NAG:AuraIsActive(11275, "target")) and (((NAG:CurrentComboPoints() >= 4) and (NAG:RemainingTime() >= 15)) or ((NAG:CurrentComboPoints() >= 2) and (NAG:RemainingTime() < 15) and (NAG:RemainingTime() >= 9))))) and NAG:Cast(11275)
    or (((not NAG:RuneIsEquipped(432271)) and (NAG:AuraRemainingTime(6774) <= 1) and (not NAG:AuraIsActive(467735)) and (((NAG:CurrentComboPoints() >= 4) and (NAG:RemainingTime() >= 19)) or ((NAG:CurrentComboPoints() >= 2) and (NAG:RemainingTime() < 19) and (NAG:RemainingTime() >= 13)))) or (NAG:RuneIsEquipped(432271) and (not NAG:AuraIsActive(6774)) and (NAG:CurrentComboPoints() >= 1) and (not NAG:AuraIsActive(467735)) and (NAG:RemainingTime() >= 10))) and NAG:Cast(6774)
    or ((NAG:AuraIsKnown(1232181) and (not NAG:AuraIsActive(436611, "target")) and (NAG:CurrentComboPoints() >= 1) and (NAG:RemainingTime() > 5)) or ((NAG:AuraIsKnown(1226843) or NAG:RuneIsEquipped(432276)) and (not NAG:AuraIsActive(436611, "target")) and (((NAG:CurrentComboPoints() >= 4) and (NAG:RemainingTime() >= 11)) or ((NAG:CurrentComboPoints() >= 2) and (NAG:RemainingTime() < 11) and (NAG:RemainingTime() >= 7))))) and NAG:Cast(412096)
    or (((NAG:CurrentComboPoints() >= 5) or ((NAG:RemainingTime() <= 4) and (NAG:CurrentComboPoints() >= 4)))) and NAG:Cast(399963)
    or ((not NAG:AuraIsActive(462707)) and (not NAG:AuraIsActive(425096)) and (NAG:CurrentEnergy() >= 35) and (NAG:CurrentComboPoints() <= 2)) and NAG:Cast(1856)
    or NAG:Cast(11269)
    or NAG:Cast(25300)
    or (((NAG:AuraNumStacks(1214170, "target") >= 4) and (NAG:CurrentComboPoints() < 5))) and NAG:Cast(425012)
        ]],

        -- New action-based format
        --prePullActions = {{action = {addComboPoints = {numPoints = "5"}}, doAtValue = {const = {val = "-3s"}}}, {action = {activateAura = {auraId = {spellId = 1787, rank = 4}}}, doAtValue = {const = {val = "-2s"}}}, {action = {castSpell = {spellId = {spellId = 6774, rank = 2}}}, doAtValue = {const = {val = "-1s"}}}, {action = {castSpell = {spellId = {itemId = 215162}}}, doAtValue = {const = {val = "-0.1s"}}}},
        --aplActions = {{action = {condition = {or = {vals = {{and = {vals = {{cmp = {op = "OpLe", lhs = {currentEnergy = {}}, rhs = {const = {val = "10"}}}}, {cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGt", lhs = {timeToEnergyTick = {}}, rhs = {const = {val = "1"}}}}}}}, {and = {vals = {{cmp = {op = "OpLe", lhs = {remainingTime = {}}, rhs = {const = {val = "15"}}}}, {cmp = {op = "OpLe", lhs = {currentEnergy = {}}, rhs = {const = {val = "40"}}}}, {cmp = {op = "OpGt", lhs = {timeToEnergyTick = {}}, rhs = {const = {val = "1"}}}}}}}}}}, castSpell = {spellId = {itemId = 7676}}}}, {action = {condition = {or = {vals = {{and = {vals = {{cmp = {op = "OpLt", lhs = {currentEnergy = {}}, rhs = {const = {val = "25"}}}}, {cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGt", lhs = {timeToEnergyTick = {}}, rhs = {const = {val = "1"}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 467735}}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 462707}}}}}}}}, {and = {vals = {{cmp = {op = "OpLe", lhs = {remainingTime = {}}, rhs = {const = {val = "15"}}}}, {cmp = {op = "OpLt", lhs = {currentEnergy = {}}, rhs = {const = {val = "35"}}}}, {cmp = {op = "OpGt", lhs = {timeToEnergyTick = {}}, rhs = {const = {val = "1"}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 467735}}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 462707}}}}}}}}}}}, castSpell = {spellId = {itemId = 231287}}}}, {action = {autocastOtherCooldowns = {}}}, {action = {condition = {or = {vals = {{and = {vals = {{not = {val = {runeIsEquipped = {runeId = {spellId = 432276}}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 1787, rank = 4}}}}}}}}, {and = {vals = {{runeIsEquipped = {runeId = {spellId = 432276}}}, {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 432276}}}, {not = {val = {auraIsActive = {auraId = {spellId = 1787, rank = 4}}}}}}}}}}}, castSpell = {spellId = {itemId = 233985}}}}, {action = {condition = {and = {vals = {{cmp = {op = "OpGe", lhs = {currentEnergy = {}}, rhs = {const = {val = "60"}}}}, {auraIsKnown = {auraId = {spellId = 467735}}}, {auraIsActive = {auraId = {spellId = 467735}}}}}}, castSpell = {spellId = {spellId = 25300, rank = 9}}}}, {action = {condition = {or = {vals = {{and = {vals = {{auraIsKnown = {auraId = {spellId = 1232181}}}, {auraIsKnown = {auraId = {spellId = 1226843}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 11275, rank = 6}}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGt", lhs = {remainingTime = {}}, rhs = {const = {val = "9"}}}}}}}, {and = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 11275, rank = 6}}}}}, {or = {vals = {{and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "15"}}}}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {cmp = {op = "OpLt", lhs = {remainingTime = {}}, rhs = {const = {val = "15"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "9"}}}}}}}}}}}}}}}}, castSpell = {spellId = {spellId = 11275, rank = 6}}}}, {action = {condition = {or = {vals = {{and = {vals = {{not = {val = {runeIsEquipped = {runeId = {spellId = 432271}}}}}, {cmp = {op = "OpLe", lhs = {auraRemainingTime = {auraId = {spellId = 6774, rank = 2}}}, rhs = {const = {val = "1"}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 467735}}}}}, {or = {vals = {{and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "19"}}}}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {cmp = {op = "OpLt", lhs = {remainingTime = {}}, rhs = {const = {val = "19"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "13"}}}}}}}}}}}}}, {and = {vals = {{runeIsEquipped = {runeId = {spellId = 432271}}}, {not = {val = {auraIsActive = {auraId = {spellId = 6774, rank = 2}}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "1"}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 467735}}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "10"}}}}}}}}}}, castSpell = {spellId = {spellId = 6774, rank = 2}}}}, {action = {condition = {or = {vals = {{and = {vals = {{auraIsKnown = {auraId = {spellId = 1232181}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 436611}}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "1"}}}}, {cmp = {op = "OpGt", lhs = {remainingTime = {}}, rhs = {const = {val = "5"}}}}}}}, {and = {vals = {{or = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {runeIsEquipped = {runeId = {spellId = 432276}}}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 436611}}}}}, {or = {vals = {{and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "11"}}}}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {cmp = {op = "OpLt", lhs = {remainingTime = {}}, rhs = {const = {val = "11"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "7"}}}}}}}}}}}}}}}}, castSpell = {spellId = {spellId = 412096}}}}, {action = {condition = {and = {vals = {{or = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "5"}}}}, {and = {vals = {{cmp = {op = "OpLe", lhs = {remainingTime = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}}}}}}}}}}, castSpell = {spellId = {spellId = 399963}}}}, {action = {condition = {and = {vals = {{not = {val = {auraIsActive = {auraId = {spellId = 462707}}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 425096}}}}}, {cmp = {op = "OpGe", lhs = {currentEnergy = {}}, rhs = {const = {val = "35"}}}}, {cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}}}}, castSpell = {spellId = {spellId = 1856, rank = 1}}}}, {action = {castSpell = {spellId = {spellId = 11269, rank = 6}}}}, {action = {castSpell = {spellId = {spellId = 25300, rank = 9}}}}, {action = {condition = {or = {vals = {{and = {vals = {{cmp = {op = "OpGe", lhs = {auraNumStacks = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 1214170, tag = 100}}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpLt", lhs = {currentComboPoints = {}}, rhs = {const = {val = "5"}}}}}}}}}}, castSpell = {spellId = {spellId = 425012}}}}},

        -- Tracked IDs for optimization
        spells = {1787, 1856, 6774, 11269, 11275, 25300, 399963, 412096, 425012, 425096, 432276, 436611, 462707, 467735, 1214170, 1226843, 1232181},
        items = {7676, 231287, 233985},
        auras = {},
        runes = {432271, 432276},

        -- Optional metadata
        glyphs = {},
        lastModified = "06/12/2025",
        author = "APLParser"
    }
)

ns.AddRotationToDefaults(defaults,
    SpecializationCompat:GetSpecID("Rogue", "Assassination"),
    "Rogue Assassination - 1Target_1Min_BiS_Phase8_ST_SaberSlash by APLParser",
    {
        -- Required parameters
        default = true,
        enabled = true,
        experimental = false,
        gameType = Version.GAME_TYPES.CLASSIC_ERA_SOD,
        prePull = {
            { NAG:Cast(6774), -2000 }, { NAG:Cast(13877), -1000 }
        },
        rotationString = [[
((NAG:CurrentEnergy() <= 10) or ((NAG:RemainingTime() <= 15) and (NAG:CurrentEnergy() <= 40))) and NAG:Cast(7676)
    or NAG:AutocastOtherCooldowns()
    or (((not NAG:RuneIsEquipped(432276)) and (not NAG:AuraIsActive(1787))) or (NAG:RuneIsEquipped(432276) and (not NAG:AuraIsActive(1787)) and NAG:AuraIsActive(432276, "target"))) and NAG:Cast(233985)
    or (NAG:AuraIsKnown(1226843) and (not NAG:AuraIsActive(424785, "target")) and (not NAG:AuraIsActive(11275, "target")) and (not NAG:AuraIsActive(436611, "target")) and (NAG:CurrentComboPoints() <= 4)) and NAG:Cast(425012)
    or (NAG:AuraIsKnown(1226843) and (not NAG:AuraIsActive(424785, "target")) and (not NAG:AuraIsActive(11275, "target")) and (not NAG:AuraIsActive(436611, "target")) and (NAG:CurrentComboPoints() >= 1)) and NAG:Cast(412096)
    or ((NAG:CurrentComboPoints() <= 4) and ((NAG:AuraNumStacks(424785, "target") < 3) or (NAG:AuraRemainingTime(424785, "target") < 2)) and (NAG:AuraRemainingTime(424785, "target") < (NAG:RemainingTime() + 2))) and NAG:Cast(424785)
    or (((not NAG:RuneIsEquipped(432276)) and NAG:AuraIsActive(6774) and NAG:AuraIsActive(399963)) or (NAG:RuneIsEquipped(432276) and NAG:AuraIsActive(432276, "target") and NAG:AuraIsActive(6774) and NAG:AuraIsActive(399963))) and NAG:Cast(13877)
    or ((NAG:AuraNumStacks(1214170, "target") >= 4) and (NAG:CurrentComboPoints() < 5) and (NAG:CurrentEnergy() <= 75)) and NAG:Cast(425012)
    or (((not NAG:RuneIsEquipped(432271)) and (NAG:AuraRemainingTime(6774) <= 1) and (((NAG:CurrentComboPoints() >= 4) and (NAG:RemainingTime() >= 19)) or ((NAG:CurrentComboPoints() >= 2) and (NAG:RemainingTime() < 19) and (NAG:RemainingTime() >= 13)))) or (NAG:RuneIsEquipped(432271) and (not NAG:AuraIsActive(6774)) and (NAG:CurrentComboPoints() >= 1) and (NAG:RemainingTime() >= 10))) and NAG:Cast(6774)
    or ((NAG:AuraIsKnown(1226843) and NAG:AuraIsKnown(1232181) and (not NAG:RuneIsEquipped(432271)) and (not NAG:AuraIsActive(436611, "target")) and (NAG:CurrentComboPoints() >= 1) and (NAG:RemainingTime() >= 5)) or (NAG:AuraIsKnown(1226843) and (not NAG:RuneIsEquipped(432271)) and (not NAG:AuraIsActive(436611, "target")) and (((NAG:CurrentComboPoints() >= 4) and (NAG:RemainingTime() >= 11)) or ((NAG:CurrentComboPoints() >= 2) and (NAG:RemainingTime() < 11) and (NAG:RemainingTime() >= 7))))) and NAG:Cast(412096)
    or ((not NAG:AuraIsActive(425096)) and (NAG:CurrentEnergy() >= 35) and (NAG:CurrentComboPoints() >= 5) and NAG:GCDIsReady() and (NAG:AuraNumStacks(1214170, "target") >= 5)) and NAG:StrictSequence("foo", NAG:Cast(14177), NAG:Cast(1856), NAG:Cast(399963))
    or ((NAG:CurrentComboPoints() >= 4) or ((NAG:CurrentComboPoints() >= 3) and (NAG:RemainingTime() <= 4))) and NAG:Cast(399963)
    or ((NAG:AuraIsKnown(1226843) and (NAG:CurrentComboPoints() <= 4) and (NAG:CurrentEnergy() >= 75) and (NAG:AuraRemainingTime(424785, "target") >= 8) and (NAG:AuraNumStacks(424785, "target") >= 3)) or (NAG:AuraIsKnown(1226843) and (NAG:CurrentComboPoints() <= 2) and (NAG:AuraRemainingTime(424785, "target") >= 8) and (NAG:AuraNumStacks(424785, "target") >= 3)) or (NAG:AuraIsKnown(1226843) and (NAG:CurrentComboPoints() <= 2) and (NAG:RemainingTime() <= 4) and (NAG:AuraNumStacks(424785, "target") >= 3))) and NAG:Cast(11294)
    or ((NAG:CurrentComboPoints() <= 2) or ((NAG:CurrentComboPoints() <= 4) and (NAG:CurrentEnergy() >= 75))) and NAG:Cast(424785)
        ]],

        -- New action-based format
        --prePullActions = {{action = {addComboPoints = {numPoints = "5"}}, doAtValue = {const = {val = "-4s"}}}, {action = {activateAura = {auraId = {spellId = 1787, rank = 4}}}, doAtValue = {const = {val = "-3s"}}}, {action = {castSpell = {spellId = {spellId = 6774, rank = 2}}}, doAtValue = {const = {val = "-2s"}}}, {action = {castSpell = {spellId = {spellId = 13877}}}, doAtValue = {const = {val = "-1s"}}}, {action = {castSpell = {spellId = {itemId = 215162}}}, doAtValue = {const = {val = "-0.1s"}}}},
        --aplActions = {{action = {condition = {or = {vals = {{cmp = {op = "OpLe", lhs = {currentEnergy = {}}, rhs = {const = {val = "10"}}}}, {and = {vals = {{cmp = {op = "OpLe", lhs = {remainingTime = {}}, rhs = {const = {val = "15"}}}}, {cmp = {op = "OpLe", lhs = {currentEnergy = {}}, rhs = {const = {val = "40"}}}}}}}}}}, castSpell = {spellId = {itemId = 7676}}}}, {action = {autocastOtherCooldowns = {}}}, {action = {condition = {or = {vals = {{and = {vals = {{not = {val = {runeIsEquipped = {runeId = {spellId = 432276}}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 1787, rank = 4}}}}}}}}, {and = {vals = {{runeIsEquipped = {runeId = {spellId = 432276}}}, {not = {val = {auraIsActive = {auraId = {spellId = 1787, rank = 4}}}}}, {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 432276}}}}}}}}}, castSpell = {spellId = {itemId = 233985}}}}, {action = {condition = {and = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 424785}}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 11275, rank = 6}}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 436611}}}}}, {cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}}}}, castSpell = {spellId = {spellId = 425012}}}}, {action = {condition = {and = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 424785}}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 11275, rank = 6}}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 436611}}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "1"}}}}}}}, castSpell = {spellId = {spellId = 412096}}}}, {action = {condition = {and = {vals = {{cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {or = {vals = {{cmp = {op = "OpLt", lhs = {auraNumStacks = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 424785}}}, rhs = {const = {val = "3"}}}}, {cmp = {op = "OpLt", lhs = {auraRemainingTime = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 424785}}}, rhs = {const = {val = "2"}}}}}}}, {cmp = {op = "OpLt", lhs = {auraRemainingTime = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 424785}}}, rhs = {math = {op = "OpAdd", lhs = {remainingTime = {}}, rhs = {const = {val = "2"}}}}}}}}}, castSpell = {spellId = {spellId = 424785}}}}, {action = {condition = {or = {vals = {{and = {vals = {{not = {val = {runeIsEquipped = {runeId = {spellId = 432276}}}}}, {auraIsActive = {auraId = {spellId = 6774, rank = 2}}}, {auraIsActive = {auraId = {spellId = 399963}}}}}}, {and = {vals = {{runeIsEquipped = {runeId = {spellId = 432276}}}, {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 432276}}}, {auraIsActive = {auraId = {spellId = 6774, rank = 2}}}, {auraIsActive = {auraId = {spellId = 399963}}}}}}}}}, castSpell = {spellId = {spellId = 13877}}}}, {action = {condition = {and = {vals = {{cmp = {op = "OpGe", lhs = {auraNumStacks = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 1214170, tag = 100}}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpLt", lhs = {currentComboPoints = {}}, rhs = {const = {val = "5"}}}}, {cmp = {op = "OpLe", lhs = {currentEnergy = {}}, rhs = {const = {val = "75"}}}}}}}, castSpell = {spellId = {spellId = 425012}}}}, {action = {condition = {or = {vals = {{and = {vals = {{not = {val = {runeIsEquipped = {runeId = {spellId = 432271}}}}}, {cmp = {op = "OpLe", lhs = {auraRemainingTime = {auraId = {spellId = 6774, rank = 2}}}, rhs = {const = {val = "1"}}}}, {or = {vals = {{and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "19"}}}}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {cmp = {op = "OpLt", lhs = {remainingTime = {}}, rhs = {const = {val = "19"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "13"}}}}}}}}}}}}}, {and = {vals = {{runeIsEquipped = {runeId = {spellId = 432271}}}, {not = {val = {auraIsActive = {auraId = {spellId = 6774, rank = 2}}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "1"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "10"}}}}}}}}}}, castSpell = {spellId = {spellId = 6774, rank = 2}}}}, {action = {condition = {or = {vals = {{and = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {auraIsKnown = {auraId = {spellId = 1232181}}}, {not = {val = {runeIsEquipped = {runeId = {spellId = 432271}}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 436611}}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "1"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "5"}}}}}}}, {and = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {not = {val = {runeIsEquipped = {runeId = {spellId = 432271}}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 436611}}}}}, {or = {vals = {{and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "11"}}}}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {cmp = {op = "OpLt", lhs = {remainingTime = {}}, rhs = {const = {val = "11"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "7"}}}}}}}}}}}}}}}}, castSpell = {spellId = {spellId = 412096}}}}, {hide = true, action = {condition = {or = {vals = {{and = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {auraIsKnown = {auraId = {spellId = 1232181}}}, {not = {val = {runeIsEquipped = {runeId = {spellId = 432271}}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 11275, rank = 6}}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "3"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "9"}}}}}}}, {and = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {not = {val = {runeIsEquipped = {runeId = {spellId = 432271}}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 11275, rank = 6}}}}}, {or = {vals = {{and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "15"}}}}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {cmp = {op = "OpLt", lhs = {remainingTime = {}}, rhs = {const = {val = "15"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "9"}}}}}}}}}}}}}}}}, castSpell = {spellId = {spellId = 11275, rank = 6}}}}, {action = {condition = {and = {vals = {{not = {val = {auraIsActive = {auraId = {spellId = 425096}}}}}, {cmp = {op = "OpGe", lhs = {currentEnergy = {}}, rhs = {const = {val = "35"}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "5"}}}}, {gcdIsReady = {}}, {cmp = {op = "OpGe", lhs = {auraNumStacks = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 1214170, tag = 100}}}, rhs = {const = {val = "5"}}}}}}}, strictSequence = {actions = {{castSpell = {spellId = {spellId = 14177}}}, {castSpell = {spellId = {spellId = 1856, rank = 1}}}, {castSpell = {spellId = {spellId = 399963}}}}, name = "someName74"}}}, {action = {condition = {or = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "3"}}}}, {cmp = {op = "OpLe", lhs = {remainingTime = {}}, rhs = {const = {val = "4"}}}}}}}}}}, castSpell = {spellId = {spellId = 399963}}}}, {action = {condition = {or = {vals = {{and = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {currentEnergy = {}}, rhs = {const = {val = "75"}}}}, {cmp = {op = "OpGe", lhs = {auraRemainingTime = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 424785}}}, rhs = {const = {val = "8"}}}}, {cmp = {op = "OpGe", lhs = {auraNumStacks = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 424785}}}, rhs = {const = {val = "3"}}}}}}}, {and = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {cmp = {op = "OpGe", lhs = {auraRemainingTime = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 424785}}}, rhs = {const = {val = "8"}}}}, {cmp = {op = "OpGe", lhs = {auraNumStacks = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 424785}}}, rhs = {const = {val = "3"}}}}}}}, {and = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {cmp = {op = "OpLe", lhs = {remainingTime = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {auraNumStacks = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 424785}}}, rhs = {const = {val = "3"}}}}}}}}}}, castSpell = {spellId = {spellId = 11294, rank = 8}}}}, {action = {condition = {or = {vals = {{cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {and = {vals = {{cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {currentEnergy = {}}, rhs = {const = {val = "75"}}}}}}}}}}, castSpell = {spellId = {spellId = 424785}}}}},

        -- Tracked IDs for optimization
        spells = {1787, 1856, 6774, 11275, 11294, 13877, 14177, 399963, 412096, 424785, 425012, 425096, 432276, 436611, 1214170, 1226843, 1232181},
        items = {7676, 233985},
        auras = {},
        runes = {432271, 432276},

        -- Optional metadata
        glyphs = {},
        lastModified = "06/12/2025",
        author = "APLParser"
    }
)

ns.AddRotationToDefaults(defaults,
    SpecializationCompat:GetSpecID("Rogue", "Assassination"),
    "Rogue Assassination - 1Target_1Min_BiS_Mutilate_Phase8_ST by APLParser",
    {
        -- Required parameters
        default = true,
        enabled = true,
        experimental = false,
        gameType = Version.GAME_TYPES.CLASSIC_ERA_SOD,
        prePull = {
            { NAG:Cast(6774), -2000 }, { NAG:Cast(13877), -1000 }
        },
        rotationString = [[
((NAG:CurrentEnergy() <= 10) or ((NAG:RemainingTime() <= 20) and (NAG:CurrentEnergy() <= 40))) and NAG:Cast(7676)
    or NAG:AutocastOtherCooldowns()
    or (((not NAG:RuneIsEquipped(432276)) and (not NAG:AuraIsActive(1787))) or (NAG:RuneIsEquipped(432276) and NAG:AuraIsActive(432276, "target") and (not NAG:AuraIsActive(1787)))) and NAG:Cast(233985)
    or (((not NAG:RuneIsEquipped(432276)) and NAG:AuraIsActive(6774) and NAG:AuraIsActive(399963)) or (NAG:RuneIsEquipped(432276) and NAG:AuraIsActive(432276, "target") and NAG:AuraIsActive(6774) and NAG:AuraIsActive(399963))) and NAG:Cast(13877)
    or ((NAG:AuraIsKnown(1226843) and NAG:AuraIsKnown(1232181) and (not NAG:AuraIsActive(11275, "target")) and (NAG:CurrentComboPoints() >= 3) and (NAG:RemainingTime() >= 9)) or (NAG:AuraIsKnown(1226843) and (not NAG:AuraIsActive(11275, "target")) and (((NAG:CurrentComboPoints() >= 4) and (NAG:RemainingTime() >= 15)) or ((NAG:CurrentComboPoints() >= 2) and (NAG:RemainingTime() < 15) and (NAG:RemainingTime() >= 9))))) and NAG:Cast(11275)
    or (((not NAG:RuneIsEquipped(432271)) and (NAG:AuraRemainingTime(6774) <= 1) and (((NAG:CurrentComboPoints() >= 4) and (NAG:RemainingTime() >= 19)) or ((NAG:CurrentComboPoints() >= 2) and (NAG:RemainingTime() < 19) and (NAG:RemainingTime() >= 13)))) or (NAG:RuneIsEquipped(432271) and (not NAG:AuraIsActive(6774)) and (NAG:CurrentComboPoints() >= 1) and (NAG:RemainingTime() >= 10))) and NAG:Cast(6774)
    or ((NAG:AuraIsKnown(1232181) and (NAG:AuraIsKnown(1226843) or NAG:RuneIsEquipped(432276)) and (not NAG:AuraIsActive(436611, "target")) and (NAG:CurrentComboPoints() >= 1) and (NAG:RemainingTime() >= 5)) or ((NAG:AuraIsKnown(1226843) or NAG:RuneIsEquipped(432276)) and (not NAG:AuraIsActive(436611, "target")) and (((NAG:CurrentComboPoints() >= 4) and (NAG:RemainingTime() >= 11)) or ((NAG:CurrentComboPoints() >= 2) and (NAG:RemainingTime() < 11) and (NAG:RemainingTime() >= 7))))) and NAG:Cast(412096)
    or ((not NAG:AuraIsActive(425096)) and (NAG:CurrentEnergy() >= 35) and (NAG:CurrentComboPoints() >= 5) and NAG:GCDIsReady() and (NAG:AuraNumStacks(1214170, "target") >= 5)) and NAG:StrictSequence("foo", NAG:Cast(14177), NAG:Cast(1856), NAG:Cast(399963))
    or ((NAG:CurrentComboPoints() >= 4) or ((NAG:CurrentComboPoints() >= 3) and (NAG:RemainingTime() <= 4))) and NAG:Cast(399963)
    or (NAG:CurrentComboPoints() <= 3) and NAG:Cast(399956)
    or (((NAG:AuraNumStacks(1214170, "target") >= 4) and (NAG:CurrentComboPoints() < 5)) or (NAG:AuraRemainingTime(1214170, "target") <= 1)) and NAG:Cast(425012)
        ]],

        -- New action-based format
        --prePullActions = {{action = {addComboPoints = {numPoints = "5"}}, doAtValue = {const = {val = "-4s"}}}, {action = {activateAura = {auraId = {spellId = 1787, rank = 4}}}, doAtValue = {const = {val = "-3s"}}}, {action = {castSpell = {spellId = {spellId = 6774, rank = 2}}}, doAtValue = {const = {val = "-2s"}}}, {action = {castSpell = {spellId = {spellId = 13877}}}, doAtValue = {const = {val = "-1s"}}}, {action = {castSpell = {spellId = {itemId = 215162}}}, doAtValue = {const = {val = "-0.1s"}}}},
        --aplActions = {{action = {condition = {or = {vals = {{cmp = {op = "OpLe", lhs = {currentEnergy = {}}, rhs = {const = {val = "10"}}}}, {and = {vals = {{cmp = {op = "OpLe", lhs = {remainingTime = {}}, rhs = {const = {val = "20"}}}}, {cmp = {op = "OpLe", lhs = {currentEnergy = {}}, rhs = {const = {val = "40"}}}}}}}}}}, castSpell = {spellId = {itemId = 7676}}}}, {action = {autocastOtherCooldowns = {}}}, {action = {condition = {or = {vals = {{and = {vals = {{not = {val = {runeIsEquipped = {runeId = {spellId = 432276}}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 1787, rank = 4}}}}}}}}, {and = {vals = {{runeIsEquipped = {runeId = {spellId = 432276}}}, {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 432276}}}, {not = {val = {auraIsActive = {auraId = {spellId = 1787, rank = 4}}}}}}}}}}}, castSpell = {spellId = {itemId = 233985}}}}, {action = {condition = {or = {vals = {{and = {vals = {{not = {val = {runeIsEquipped = {runeId = {spellId = 432276}}}}}, {auraIsActive = {auraId = {spellId = 6774, rank = 2}}}, {auraIsActive = {auraId = {spellId = 399963}}}}}}, {and = {vals = {{runeIsEquipped = {runeId = {spellId = 432276}}}, {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 432276}}}, {auraIsActive = {auraId = {spellId = 6774, rank = 2}}}, {auraIsActive = {auraId = {spellId = 399963}}}}}}}}}, castSpell = {spellId = {spellId = 13877}}}}, {action = {condition = {or = {vals = {{and = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {auraIsKnown = {auraId = {spellId = 1232181}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 11275, rank = 6}}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "3"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "9"}}}}}}}, {and = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 11275, rank = 6}}}}}, {or = {vals = {{and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "15"}}}}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {cmp = {op = "OpLt", lhs = {remainingTime = {}}, rhs = {const = {val = "15"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "9"}}}}}}}}}}}}}}}}, castSpell = {spellId = {spellId = 11275, rank = 6}}}}, {action = {condition = {or = {vals = {{and = {vals = {{not = {val = {runeIsEquipped = {runeId = {spellId = 432271}}}}}, {cmp = {op = "OpLe", lhs = {auraRemainingTime = {auraId = {spellId = 6774, rank = 2}}}, rhs = {const = {val = "1"}}}}, {or = {vals = {{and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "19"}}}}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {cmp = {op = "OpLt", lhs = {remainingTime = {}}, rhs = {const = {val = "19"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "13"}}}}}}}}}}}}}, {and = {vals = {{runeIsEquipped = {runeId = {spellId = 432271}}}, {not = {val = {auraIsActive = {auraId = {spellId = 6774, rank = 2}}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "1"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "10"}}}}}}}}}}, castSpell = {spellId = {spellId = 6774, rank = 2}}}}, {action = {condition = {or = {vals = {{and = {vals = {{auraIsKnown = {auraId = {spellId = 1232181}}}, {or = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {runeIsEquipped = {runeId = {spellId = 432276}}}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 436611}}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "1"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "5"}}}}}}}, {and = {vals = {{or = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {runeIsEquipped = {runeId = {spellId = 432276}}}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 436611}}}}}, {or = {vals = {{and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "11"}}}}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {cmp = {op = "OpLt", lhs = {remainingTime = {}}, rhs = {const = {val = "11"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "7"}}}}}}}}}}}}}}}}, castSpell = {spellId = {spellId = 412096}}}}, {action = {condition = {and = {vals = {{not = {val = {auraIsActive = {auraId = {spellId = 425096}}}}}, {cmp = {op = "OpGe", lhs = {currentEnergy = {}}, rhs = {const = {val = "35"}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "5"}}}}, {gcdIsReady = {}}, {cmp = {op = "OpGe", lhs = {auraNumStacks = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 1214170, tag = 100}}}, rhs = {const = {val = "5"}}}}}}}, strictSequence = {actions = {{castSpell = {spellId = {spellId = 14177}}}, {castSpell = {spellId = {spellId = 1856, rank = 1}}}, {castSpell = {spellId = {spellId = 399963}}}}, name = "someName61"}}}, {action = {condition = {or = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "3"}}}}, {cmp = {op = "OpLe", lhs = {remainingTime = {}}, rhs = {const = {val = "4"}}}}}}}}}}, castSpell = {spellId = {spellId = 399963}}}}, {action = {condition = {cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "3"}}}}, castSpell = {spellId = {spellId = 399956}}}}, {action = {condition = {or = {vals = {{and = {vals = {{cmp = {op = "OpGe", lhs = {auraNumStacks = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 1214170, tag = 100}}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpLt", lhs = {currentComboPoints = {}}, rhs = {const = {val = "5"}}}}}}}, {cmp = {op = "OpLe", lhs = {auraRemainingTime = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 1214170, tag = 100}}}, rhs = {const = {val = "1"}}}}}}}, castSpell = {spellId = {spellId = 425012}}}}},

        -- Tracked IDs for optimization
        spells = {1787, 1856, 6774, 11275, 13877, 14177, 399956, 399963, 412096, 425012, 425096, 432276, 436611, 1214170, 1226843, 1232181},
        items = {7676, 233985},
        auras = {},
        runes = {432271, 432276},

        -- Optional metadata
        glyphs = {},
        lastModified = "06/12/2025",
        author = "APLParser"
    }
)

ns.AddRotationToDefaults(defaults,
    SpecializationCompat:GetSpecID("Rogue", "Subtlety"),
    "Rogue Subtlety - 1Target_1Min_Backstab_BiS_Phase8_ST by APLParser",
    {
        -- Required parameters
        default = true,
        enabled = true,
        experimental = false,
        gameType = Version.GAME_TYPES.CLASSIC_ERA_SOD,
        prePull = {
            { NAG:Cast(6774), -1000 }
        },
        rotationString = [[
(((NAG:CurrentEnergy() <= 10) and (NAG:CurrentComboPoints() <= 4) and (NAG:TimeToEnergyTick() > 1)) or ((NAG:RemainingTime() <= 15) and (NAG:CurrentEnergy() <= 40) and (NAG:TimeToEnergyTick() > 1))) and NAG:Cast(7676)
    or (((NAG:CurrentEnergy() < 25) and (NAG:CurrentComboPoints() <= 4) and (NAG:TimeToEnergyTick() > 1) and (not NAG:AuraIsActive(467735)) and (not NAG:AuraIsActive(462707))) or ((NAG:RemainingTime() <= 15) and (NAG:CurrentEnergy() < 35) and (NAG:TimeToEnergyTick() > 1) and (not NAG:AuraIsActive(467735)) and (not NAG:AuraIsActive(462707)))) and NAG:Cast(231287)
    or NAG:AutocastOtherCooldowns()
    or (((not NAG:RuneIsEquipped(432276)) and (not NAG:AuraIsActive(1787))) or (NAG:RuneIsEquipped(432276) and NAG:AuraIsActive(432276, "target") and (not NAG:AuraIsActive(1787)))) and NAG:Cast(233985)
    or ((NAG:CurrentEnergy() >= 60) and NAG:AuraIsKnown(467735) and NAG:AuraIsActive(467735)) and NAG:Cast(25300)
    or ((NAG:AuraIsKnown(1232181) and NAG:AuraIsKnown(1226843) and (not NAG:AuraIsActive(11275, "target")) and (NAG:CurrentComboPoints() >= 4) and (NAG:RemainingTime() > 9)) or (NAG:AuraIsKnown(1226843) and (not NAG:AuraIsActive(11275, "target")) and (((NAG:CurrentComboPoints() >= 4) and (NAG:RemainingTime() >= 15)) or ((NAG:CurrentComboPoints() >= 2) and (NAG:RemainingTime() < 15) and (NAG:RemainingTime() >= 9))))) and NAG:Cast(11275)
    or (((not NAG:RuneIsEquipped(432271)) and (NAG:AuraRemainingTime(6774) <= 1) and (not NAG:AuraIsActive(467735)) and (((NAG:CurrentComboPoints() >= 4) and (NAG:RemainingTime() >= 19)) or ((NAG:CurrentComboPoints() >= 2) and (NAG:RemainingTime() < 19) and (NAG:RemainingTime() >= 13)))) or (NAG:RuneIsEquipped(432271) and (not NAG:AuraIsActive(6774)) and (NAG:CurrentComboPoints() >= 1) and (not NAG:AuraIsActive(467735)) and (NAG:RemainingTime() >= 10))) and NAG:Cast(6774)
    or ((NAG:AuraIsKnown(1232181) and (not NAG:AuraIsActive(436611, "target")) and (NAG:CurrentComboPoints() >= 1) and (NAG:RemainingTime() > 5)) or ((NAG:AuraIsKnown(1226843) or NAG:RuneIsEquipped(432276)) and (not NAG:AuraIsActive(436611, "target")) and (((NAG:CurrentComboPoints() >= 4) and (NAG:RemainingTime() >= 11)) or ((NAG:CurrentComboPoints() >= 2) and (NAG:RemainingTime() < 11) and (NAG:RemainingTime() >= 7))))) and NAG:Cast(412096)
    or (((NAG:CurrentComboPoints() >= 5) or ((NAG:RemainingTime() <= 4) and (NAG:CurrentComboPoints() >= 4)))) and NAG:Cast(399963)
    or ((not NAG:AuraIsActive(462707)) and (not NAG:AuraIsActive(425096)) and (NAG:CurrentEnergy() >= 35) and (NAG:CurrentComboPoints() <= 2)) and NAG:Cast(1856)
    or NAG:Cast(11269)
    or NAG:Cast(25300)
    or (((NAG:AuraNumStacks(1214170, "target") >= 4) and (NAG:CurrentComboPoints() < 5))) and NAG:Cast(425012)
        ]],

        -- New action-based format
        --prePullActions = {{action = {addComboPoints = {numPoints = "5"}}, doAtValue = {const = {val = "-3s"}}}, {action = {activateAura = {auraId = {spellId = 1787, rank = 4}}}, doAtValue = {const = {val = "-2s"}}}, {action = {castSpell = {spellId = {spellId = 6774, rank = 2}}}, doAtValue = {const = {val = "-1s"}}}, {action = {castSpell = {spellId = {itemId = 215162}}}, doAtValue = {const = {val = "-0.1s"}}}},
        --aplActions = {{action = {condition = {or = {vals = {{and = {vals = {{cmp = {op = "OpLe", lhs = {currentEnergy = {}}, rhs = {const = {val = "10"}}}}, {cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGt", lhs = {timeToEnergyTick = {}}, rhs = {const = {val = "1"}}}}}}}, {and = {vals = {{cmp = {op = "OpLe", lhs = {remainingTime = {}}, rhs = {const = {val = "15"}}}}, {cmp = {op = "OpLe", lhs = {currentEnergy = {}}, rhs = {const = {val = "40"}}}}, {cmp = {op = "OpGt", lhs = {timeToEnergyTick = {}}, rhs = {const = {val = "1"}}}}}}}}}}, castSpell = {spellId = {itemId = 7676}}}}, {action = {condition = {or = {vals = {{and = {vals = {{cmp = {op = "OpLt", lhs = {currentEnergy = {}}, rhs = {const = {val = "25"}}}}, {cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGt", lhs = {timeToEnergyTick = {}}, rhs = {const = {val = "1"}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 467735}}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 462707}}}}}}}}, {and = {vals = {{cmp = {op = "OpLe", lhs = {remainingTime = {}}, rhs = {const = {val = "15"}}}}, {cmp = {op = "OpLt", lhs = {currentEnergy = {}}, rhs = {const = {val = "35"}}}}, {cmp = {op = "OpGt", lhs = {timeToEnergyTick = {}}, rhs = {const = {val = "1"}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 467735}}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 462707}}}}}}}}}}}, castSpell = {spellId = {itemId = 231287}}}}, {action = {autocastOtherCooldowns = {}}}, {action = {condition = {or = {vals = {{and = {vals = {{not = {val = {runeIsEquipped = {runeId = {spellId = 432276}}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 1787, rank = 4}}}}}}}}, {and = {vals = {{runeIsEquipped = {runeId = {spellId = 432276}}}, {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 432276}}}, {not = {val = {auraIsActive = {auraId = {spellId = 1787, rank = 4}}}}}}}}}}}, castSpell = {spellId = {itemId = 233985}}}}, {action = {condition = {and = {vals = {{cmp = {op = "OpGe", lhs = {currentEnergy = {}}, rhs = {const = {val = "60"}}}}, {auraIsKnown = {auraId = {spellId = 467735}}}, {auraIsActive = {auraId = {spellId = 467735}}}}}}, castSpell = {spellId = {spellId = 25300, rank = 9}}}}, {action = {condition = {or = {vals = {{and = {vals = {{auraIsKnown = {auraId = {spellId = 1232181}}}, {auraIsKnown = {auraId = {spellId = 1226843}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 11275, rank = 6}}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGt", lhs = {remainingTime = {}}, rhs = {const = {val = "9"}}}}}}}, {and = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 11275, rank = 6}}}}}, {or = {vals = {{and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "15"}}}}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {cmp = {op = "OpLt", lhs = {remainingTime = {}}, rhs = {const = {val = "15"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "9"}}}}}}}}}}}}}}}}, castSpell = {spellId = {spellId = 11275, rank = 6}}}}, {action = {condition = {or = {vals = {{and = {vals = {{not = {val = {runeIsEquipped = {runeId = {spellId = 432271}}}}}, {cmp = {op = "OpLe", lhs = {auraRemainingTime = {auraId = {spellId = 6774, rank = 2}}}, rhs = {const = {val = "1"}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 467735}}}}}, {or = {vals = {{and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "19"}}}}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {cmp = {op = "OpLt", lhs = {remainingTime = {}}, rhs = {const = {val = "19"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "13"}}}}}}}}}}}}}, {and = {vals = {{runeIsEquipped = {runeId = {spellId = 432271}}}, {not = {val = {auraIsActive = {auraId = {spellId = 6774, rank = 2}}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "1"}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 467735}}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "10"}}}}}}}}}}, castSpell = {spellId = {spellId = 6774, rank = 2}}}}, {action = {condition = {or = {vals = {{and = {vals = {{auraIsKnown = {auraId = {spellId = 1232181}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 436611}}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "1"}}}}, {cmp = {op = "OpGt", lhs = {remainingTime = {}}, rhs = {const = {val = "5"}}}}}}}, {and = {vals = {{or = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {runeIsEquipped = {runeId = {spellId = 432276}}}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 436611}}}}}, {or = {vals = {{and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "11"}}}}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {cmp = {op = "OpLt", lhs = {remainingTime = {}}, rhs = {const = {val = "11"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "7"}}}}}}}}}}}}}}}}, castSpell = {spellId = {spellId = 412096}}}}, {action = {condition = {and = {vals = {{or = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "5"}}}}, {and = {vals = {{cmp = {op = "OpLe", lhs = {remainingTime = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}}}}}}}}}}, castSpell = {spellId = {spellId = 399963}}}}, {action = {condition = {and = {vals = {{not = {val = {auraIsActive = {auraId = {spellId = 462707}}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 425096}}}}}, {cmp = {op = "OpGe", lhs = {currentEnergy = {}}, rhs = {const = {val = "35"}}}}, {cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}}}}, castSpell = {spellId = {spellId = 1856, rank = 1}}}}, {action = {castSpell = {spellId = {spellId = 11269, rank = 6}}}}, {action = {castSpell = {spellId = {spellId = 25300, rank = 9}}}}, {action = {condition = {or = {vals = {{and = {vals = {{cmp = {op = "OpGe", lhs = {auraNumStacks = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 1214170, tag = 100}}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpLt", lhs = {currentComboPoints = {}}, rhs = {const = {val = "5"}}}}}}}}}}, castSpell = {spellId = {spellId = 425012}}}}},

        -- Tracked IDs for optimization
        spells = {1787, 1856, 6774, 11269, 11275, 25300, 399963, 412096, 425012, 425096, 432276, 436611, 462707, 467735, 1214170, 1226843, 1232181},
        items = {7676, 231287, 233985},
        auras = {},
        runes = {432271, 432276},

        -- Optional metadata
        glyphs = {},
        lastModified = "06/12/2025",
        author = "APLParser"
    }
)

ns.AddRotationToDefaults(defaults,
    SpecializationCompat:GetSpecID("Rogue", "Assassination"),
    "Rogue Assassination - 1Target_2Min_BiS_Phase8_ST_SaberSlash by APLParser",
    {
        -- Required parameters
        default = true,
        enabled = true,
        experimental = false,
        gameType = Version.GAME_TYPES.CLASSIC_ERA_SOD,
        prePull = {
            { NAG:Cast(6774), -2000 }, { NAG:Cast(13877), -1000 }
        },
        rotationString = [[
((NAG:CurrentEnergy() <= 10) or ((NAG:RemainingTime() <= 15) and (NAG:CurrentEnergy() <= 40))) and NAG:Cast(7676)
    or NAG:AutocastOtherCooldowns()
    or (((not NAG:RuneIsEquipped(432276)) and (not NAG:AuraIsActive(1787))) or (NAG:RuneIsEquipped(432276) and (not NAG:AuraIsActive(1787)) and NAG:AuraIsActive(432276, "target"))) and NAG:Cast(233985)
    or (NAG:AuraIsKnown(1226843) and (not NAG:AuraIsActive(424785, "target")) and (not NAG:AuraIsActive(11275, "target")) and (not NAG:AuraIsActive(436611, "target")) and (NAG:CurrentComboPoints() <= 4)) and NAG:Cast(425012)
    or (NAG:AuraIsKnown(1226843) and (not NAG:AuraIsActive(424785, "target")) and (not NAG:AuraIsActive(11275, "target")) and (not NAG:AuraIsActive(436611, "target")) and (NAG:CurrentComboPoints() >= 1)) and NAG:Cast(412096)
    or ((NAG:CurrentComboPoints() <= 4) and ((NAG:AuraNumStacks(424785, "target") < 3) or (NAG:AuraRemainingTime(424785, "target") < 2)) and (NAG:AuraRemainingTime(424785, "target") < (NAG:RemainingTime() + 2))) and NAG:Cast(424785)
    or (((not NAG:RuneIsEquipped(432276)) and NAG:AuraIsActive(6774) and NAG:AuraIsActive(399963)) or (NAG:RuneIsEquipped(432276) and NAG:AuraIsActive(432276, "target") and NAG:AuraIsActive(6774) and NAG:AuraIsActive(399963))) and NAG:Cast(13877)
    or ((NAG:AuraNumStacks(1214170, "target") >= 4) and (NAG:CurrentComboPoints() < 5) and (NAG:CurrentEnergy() <= 75)) and NAG:Cast(425012)
    or (((not NAG:RuneIsEquipped(432271)) and (NAG:AuraRemainingTime(6774) <= 1) and (((NAG:CurrentComboPoints() >= 4) and (NAG:RemainingTime() >= 19)) or ((NAG:CurrentComboPoints() >= 2) and (NAG:RemainingTime() < 19) and (NAG:RemainingTime() >= 13)))) or (NAG:RuneIsEquipped(432271) and (not NAG:AuraIsActive(6774)) and (NAG:CurrentComboPoints() >= 1) and (NAG:RemainingTime() >= 10))) and NAG:Cast(6774)
    or ((NAG:AuraIsKnown(1226843) and NAG:AuraIsKnown(1232181) and (not NAG:RuneIsEquipped(432271)) and (not NAG:AuraIsActive(436611, "target")) and (NAG:CurrentComboPoints() >= 1) and (NAG:RemainingTime() >= 5)) or (NAG:AuraIsKnown(1226843) and (not NAG:RuneIsEquipped(432271)) and (not NAG:AuraIsActive(436611, "target")) and (((NAG:CurrentComboPoints() >= 4) and (NAG:RemainingTime() >= 11)) or ((NAG:CurrentComboPoints() >= 2) and (NAG:RemainingTime() < 11) and (NAG:RemainingTime() >= 7))))) and NAG:Cast(412096)
    or ((not NAG:AuraIsActive(425096)) and (NAG:CurrentEnergy() >= 35) and (NAG:CurrentComboPoints() >= 5) and NAG:GCDIsReady() and (NAG:AuraNumStacks(1214170, "target") >= 5)) and NAG:StrictSequence("foo", NAG:Cast(14177), NAG:Cast(1856), NAG:Cast(399963))
    or ((NAG:CurrentComboPoints() >= 4) or ((NAG:CurrentComboPoints() >= 3) and (NAG:RemainingTime() <= 4))) and NAG:Cast(399963)
    or ((NAG:AuraIsKnown(1226843) and (NAG:CurrentComboPoints() <= 4) and (NAG:CurrentEnergy() >= 75) and (NAG:AuraRemainingTime(424785, "target") >= 8) and (NAG:AuraNumStacks(424785, "target") >= 3)) or (NAG:AuraIsKnown(1226843) and (NAG:CurrentComboPoints() <= 2) and (NAG:AuraRemainingTime(424785, "target") >= 8) and (NAG:AuraNumStacks(424785, "target") >= 3)) or (NAG:AuraIsKnown(1226843) and (NAG:CurrentComboPoints() <= 2) and (NAG:RemainingTime() <= 4) and (NAG:AuraNumStacks(424785, "target") >= 3))) and NAG:Cast(11294)
    or ((NAG:CurrentComboPoints() <= 2) or ((NAG:CurrentComboPoints() <= 4) and (NAG:CurrentEnergy() >= 75))) and NAG:Cast(424785)
        ]],

        -- New action-based format
        --prePullActions = {{action = {addComboPoints = {numPoints = "5"}}, doAtValue = {const = {val = "-4s"}}}, {action = {activateAura = {auraId = {spellId = 1787, rank = 4}}}, doAtValue = {const = {val = "-3s"}}}, {action = {castSpell = {spellId = {spellId = 6774, rank = 2}}}, doAtValue = {const = {val = "-2s"}}}, {action = {castSpell = {spellId = {spellId = 13877}}}, doAtValue = {const = {val = "-1s"}}}, {action = {castSpell = {spellId = {itemId = 215162}}}, doAtValue = {const = {val = "-0.1s"}}}},
        --aplActions = {{action = {condition = {or = {vals = {{cmp = {op = "OpLe", lhs = {currentEnergy = {}}, rhs = {const = {val = "10"}}}}, {and = {vals = {{cmp = {op = "OpLe", lhs = {remainingTime = {}}, rhs = {const = {val = "15"}}}}, {cmp = {op = "OpLe", lhs = {currentEnergy = {}}, rhs = {const = {val = "40"}}}}}}}}}}, castSpell = {spellId = {itemId = 7676}}}}, {action = {autocastOtherCooldowns = {}}}, {action = {condition = {or = {vals = {{and = {vals = {{not = {val = {runeIsEquipped = {runeId = {spellId = 432276}}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 1787, rank = 4}}}}}}}}, {and = {vals = {{runeIsEquipped = {runeId = {spellId = 432276}}}, {not = {val = {auraIsActive = {auraId = {spellId = 1787, rank = 4}}}}}, {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 432276}}}}}}}}}, castSpell = {spellId = {itemId = 233985}}}}, {action = {condition = {and = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 424785}}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 11275, rank = 6}}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 436611}}}}}, {cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}}}}, castSpell = {spellId = {spellId = 425012}}}}, {action = {condition = {and = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 424785}}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 11275, rank = 6}}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 436611}}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "1"}}}}}}}, castSpell = {spellId = {spellId = 412096}}}}, {action = {condition = {and = {vals = {{cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {or = {vals = {{cmp = {op = "OpLt", lhs = {auraNumStacks = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 424785}}}, rhs = {const = {val = "3"}}}}, {cmp = {op = "OpLt", lhs = {auraRemainingTime = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 424785}}}, rhs = {const = {val = "2"}}}}}}}, {cmp = {op = "OpLt", lhs = {auraRemainingTime = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 424785}}}, rhs = {math = {op = "OpAdd", lhs = {remainingTime = {}}, rhs = {const = {val = "2"}}}}}}}}}, castSpell = {spellId = {spellId = 424785}}}}, {action = {condition = {or = {vals = {{and = {vals = {{not = {val = {runeIsEquipped = {runeId = {spellId = 432276}}}}}, {auraIsActive = {auraId = {spellId = 6774, rank = 2}}}, {auraIsActive = {auraId = {spellId = 399963}}}}}}, {and = {vals = {{runeIsEquipped = {runeId = {spellId = 432276}}}, {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 432276}}}, {auraIsActive = {auraId = {spellId = 6774, rank = 2}}}, {auraIsActive = {auraId = {spellId = 399963}}}}}}}}}, castSpell = {spellId = {spellId = 13877}}}}, {action = {condition = {and = {vals = {{cmp = {op = "OpGe", lhs = {auraNumStacks = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 1214170, tag = 100}}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpLt", lhs = {currentComboPoints = {}}, rhs = {const = {val = "5"}}}}, {cmp = {op = "OpLe", lhs = {currentEnergy = {}}, rhs = {const = {val = "75"}}}}}}}, castSpell = {spellId = {spellId = 425012}}}}, {action = {condition = {or = {vals = {{and = {vals = {{not = {val = {runeIsEquipped = {runeId = {spellId = 432271}}}}}, {cmp = {op = "OpLe", lhs = {auraRemainingTime = {auraId = {spellId = 6774, rank = 2}}}, rhs = {const = {val = "1"}}}}, {or = {vals = {{and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "19"}}}}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {cmp = {op = "OpLt", lhs = {remainingTime = {}}, rhs = {const = {val = "19"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "13"}}}}}}}}}}}}}, {and = {vals = {{runeIsEquipped = {runeId = {spellId = 432271}}}, {not = {val = {auraIsActive = {auraId = {spellId = 6774, rank = 2}}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "1"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "10"}}}}}}}}}}, castSpell = {spellId = {spellId = 6774, rank = 2}}}}, {action = {condition = {or = {vals = {{and = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {auraIsKnown = {auraId = {spellId = 1232181}}}, {not = {val = {runeIsEquipped = {runeId = {spellId = 432271}}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 436611}}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "1"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "5"}}}}}}}, {and = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {not = {val = {runeIsEquipped = {runeId = {spellId = 432271}}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 436611}}}}}, {or = {vals = {{and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "11"}}}}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {cmp = {op = "OpLt", lhs = {remainingTime = {}}, rhs = {const = {val = "11"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "7"}}}}}}}}}}}}}}}}, castSpell = {spellId = {spellId = 412096}}}}, {hide = true, action = {condition = {or = {vals = {{and = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {auraIsKnown = {auraId = {spellId = 1232181}}}, {not = {val = {runeIsEquipped = {runeId = {spellId = 432271}}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 11275, rank = 6}}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "3"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "9"}}}}}}}, {and = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {not = {val = {runeIsEquipped = {runeId = {spellId = 432271}}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 11275, rank = 6}}}}}, {or = {vals = {{and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "15"}}}}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {cmp = {op = "OpLt", lhs = {remainingTime = {}}, rhs = {const = {val = "15"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "9"}}}}}}}}}}}}}}}}, castSpell = {spellId = {spellId = 11275, rank = 6}}}}, {action = {condition = {and = {vals = {{not = {val = {auraIsActive = {auraId = {spellId = 425096}}}}}, {cmp = {op = "OpGe", lhs = {currentEnergy = {}}, rhs = {const = {val = "35"}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "5"}}}}, {gcdIsReady = {}}, {cmp = {op = "OpGe", lhs = {auraNumStacks = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 1214170, tag = 100}}}, rhs = {const = {val = "5"}}}}}}}, strictSequence = {actions = {{castSpell = {spellId = {spellId = 14177}}}, {castSpell = {spellId = {spellId = 1856, rank = 1}}}, {castSpell = {spellId = {spellId = 399963}}}}, name = "someName497"}}}, {action = {condition = {or = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "3"}}}}, {cmp = {op = "OpLe", lhs = {remainingTime = {}}, rhs = {const = {val = "4"}}}}}}}}}}, castSpell = {spellId = {spellId = 399963}}}}, {action = {condition = {or = {vals = {{and = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {currentEnergy = {}}, rhs = {const = {val = "75"}}}}, {cmp = {op = "OpGe", lhs = {auraRemainingTime = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 424785}}}, rhs = {const = {val = "8"}}}}, {cmp = {op = "OpGe", lhs = {auraNumStacks = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 424785}}}, rhs = {const = {val = "3"}}}}}}}, {and = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {cmp = {op = "OpGe", lhs = {auraRemainingTime = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 424785}}}, rhs = {const = {val = "8"}}}}, {cmp = {op = "OpGe", lhs = {auraNumStacks = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 424785}}}, rhs = {const = {val = "3"}}}}}}}, {and = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {cmp = {op = "OpLe", lhs = {remainingTime = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {auraNumStacks = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 424785}}}, rhs = {const = {val = "3"}}}}}}}}}}, castSpell = {spellId = {spellId = 11294, rank = 8}}}}, {action = {condition = {or = {vals = {{cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {and = {vals = {{cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {currentEnergy = {}}, rhs = {const = {val = "75"}}}}}}}}}}, castSpell = {spellId = {spellId = 424785}}}}},

        -- Tracked IDs for optimization
        spells = {1787, 1856, 6774, 11275, 11294, 13877, 14177, 399963, 412096, 424785, 425012, 425096, 432276, 436611, 1214170, 1226843, 1232181},
        items = {7676, 233985},
        auras = {},
        runes = {432271, 432276},

        -- Optional metadata
        glyphs = {},
        lastModified = "06/12/2025",
        author = "APLParser"
    }
)

ns.AddRotationToDefaults(defaults,
    SpecializationCompat:GetSpecID("Rogue", "Subtlety"),
    "Rogue Subtlety - 1Target_2Min_Backstab_BiS_Phase8_ST by APLParser",
    {
        -- Required parameters
        default = true,
        enabled = true,
        experimental = false,
        gameType = Version.GAME_TYPES.CLASSIC_ERA_SOD,
        prePull = {
            { NAG:Cast(6774), -1000 }
        },
        rotationString = [[
(((NAG:CurrentEnergy() <= 10) and (NAG:CurrentComboPoints() <= 4) and (NAG:TimeToEnergyTick() > 1)) or ((NAG:RemainingTime() <= 15) and (NAG:CurrentEnergy() <= 40) and (NAG:TimeToEnergyTick() > 1))) and NAG:Cast(7676)
    or (((NAG:CurrentEnergy() < 25) and (NAG:CurrentComboPoints() <= 4) and (NAG:TimeToEnergyTick() > 1) and (not NAG:AuraIsActive(467735)) and (not NAG:AuraIsActive(462707))) or ((NAG:RemainingTime() <= 15) and (NAG:CurrentEnergy() < 35) and (NAG:TimeToEnergyTick() > 1) and (not NAG:AuraIsActive(467735)) and (not NAG:AuraIsActive(462707)))) and NAG:Cast(231287)
    or NAG:AutocastOtherCooldowns()
    or (((not NAG:RuneIsEquipped(432276)) and (not NAG:AuraIsActive(1787))) or (NAG:RuneIsEquipped(432276) and NAG:AuraIsActive(432276, "target") and (not NAG:AuraIsActive(1787)))) and NAG:Cast(233985)
    or ((NAG:CurrentEnergy() >= 60) and NAG:AuraIsKnown(467735) and NAG:AuraIsActive(467735)) and NAG:Cast(25300)
    or ((NAG:AuraIsKnown(1232181) and NAG:AuraIsKnown(1226843) and (not NAG:AuraIsActive(11275, "target")) and (NAG:CurrentComboPoints() >= 4) and (NAG:RemainingTime() > 9)) or (NAG:AuraIsKnown(1226843) and (not NAG:AuraIsActive(11275, "target")) and (((NAG:CurrentComboPoints() >= 4) and (NAG:RemainingTime() >= 15)) or ((NAG:CurrentComboPoints() >= 2) and (NAG:RemainingTime() < 15) and (NAG:RemainingTime() >= 9))))) and NAG:Cast(11275)
    or (((not NAG:RuneIsEquipped(432271)) and (NAG:AuraRemainingTime(6774) <= 1) and (not NAG:AuraIsActive(467735)) and (((NAG:CurrentComboPoints() >= 4) and (NAG:RemainingTime() >= 19)) or ((NAG:CurrentComboPoints() >= 2) and (NAG:RemainingTime() < 19) and (NAG:RemainingTime() >= 13)))) or (NAG:RuneIsEquipped(432271) and (not NAG:AuraIsActive(6774)) and (NAG:CurrentComboPoints() >= 1) and (not NAG:AuraIsActive(467735)) and (NAG:RemainingTime() >= 10))) and NAG:Cast(6774)
    or ((NAG:AuraIsKnown(1232181) and (not NAG:AuraIsActive(436611, "target")) and (NAG:CurrentComboPoints() >= 1) and (NAG:RemainingTime() > 5)) or ((NAG:AuraIsKnown(1226843) or NAG:RuneIsEquipped(432276)) and (not NAG:AuraIsActive(436611, "target")) and (((NAG:CurrentComboPoints() >= 4) and (NAG:RemainingTime() >= 11)) or ((NAG:CurrentComboPoints() >= 2) and (NAG:RemainingTime() < 11) and (NAG:RemainingTime() >= 7))))) and NAG:Cast(412096)
    or (((NAG:CurrentComboPoints() >= 5) or ((NAG:RemainingTime() <= 4) and (NAG:CurrentComboPoints() >= 4)))) and NAG:Cast(399963)
    or ((not NAG:AuraIsActive(462707)) and (not NAG:AuraIsActive(425096)) and (NAG:CurrentEnergy() >= 35) and (NAG:CurrentComboPoints() <= 2)) and NAG:Cast(1856)
    or NAG:Cast(11269)
    or NAG:Cast(25300)
    or (((NAG:AuraNumStacks(1214170, "target") >= 4) and (NAG:CurrentComboPoints() < 5))) and NAG:Cast(425012)
        ]],

        -- New action-based format
        --prePullActions = {{action = {addComboPoints = {numPoints = "5"}}, doAtValue = {const = {val = "-3s"}}}, {action = {activateAura = {auraId = {spellId = 1787, rank = 4}}}, doAtValue = {const = {val = "-2s"}}}, {action = {castSpell = {spellId = {spellId = 6774, rank = 2}}}, doAtValue = {const = {val = "-1s"}}}, {action = {castSpell = {spellId = {itemId = 215162}}}, doAtValue = {const = {val = "-0.1s"}}}},
        --aplActions = {{action = {condition = {or = {vals = {{and = {vals = {{cmp = {op = "OpLe", lhs = {currentEnergy = {}}, rhs = {const = {val = "10"}}}}, {cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGt", lhs = {timeToEnergyTick = {}}, rhs = {const = {val = "1"}}}}}}}, {and = {vals = {{cmp = {op = "OpLe", lhs = {remainingTime = {}}, rhs = {const = {val = "15"}}}}, {cmp = {op = "OpLe", lhs = {currentEnergy = {}}, rhs = {const = {val = "40"}}}}, {cmp = {op = "OpGt", lhs = {timeToEnergyTick = {}}, rhs = {const = {val = "1"}}}}}}}}}}, castSpell = {spellId = {itemId = 7676}}}}, {action = {condition = {or = {vals = {{and = {vals = {{cmp = {op = "OpLt", lhs = {currentEnergy = {}}, rhs = {const = {val = "25"}}}}, {cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGt", lhs = {timeToEnergyTick = {}}, rhs = {const = {val = "1"}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 467735}}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 462707}}}}}}}}, {and = {vals = {{cmp = {op = "OpLe", lhs = {remainingTime = {}}, rhs = {const = {val = "15"}}}}, {cmp = {op = "OpLt", lhs = {currentEnergy = {}}, rhs = {const = {val = "35"}}}}, {cmp = {op = "OpGt", lhs = {timeToEnergyTick = {}}, rhs = {const = {val = "1"}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 467735}}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 462707}}}}}}}}}}}, castSpell = {spellId = {itemId = 231287}}}}, {action = {autocastOtherCooldowns = {}}}, {action = {condition = {or = {vals = {{and = {vals = {{not = {val = {runeIsEquipped = {runeId = {spellId = 432276}}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 1787, rank = 4}}}}}}}}, {and = {vals = {{runeIsEquipped = {runeId = {spellId = 432276}}}, {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 432276}}}, {not = {val = {auraIsActive = {auraId = {spellId = 1787, rank = 4}}}}}}}}}}}, castSpell = {spellId = {itemId = 233985}}}}, {action = {condition = {and = {vals = {{cmp = {op = "OpGe", lhs = {currentEnergy = {}}, rhs = {const = {val = "60"}}}}, {auraIsKnown = {auraId = {spellId = 467735}}}, {auraIsActive = {auraId = {spellId = 467735}}}}}}, castSpell = {spellId = {spellId = 25300, rank = 9}}}}, {action = {condition = {or = {vals = {{and = {vals = {{auraIsKnown = {auraId = {spellId = 1232181}}}, {auraIsKnown = {auraId = {spellId = 1226843}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 11275, rank = 6}}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGt", lhs = {remainingTime = {}}, rhs = {const = {val = "9"}}}}}}}, {and = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 11275, rank = 6}}}}}, {or = {vals = {{and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "15"}}}}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {cmp = {op = "OpLt", lhs = {remainingTime = {}}, rhs = {const = {val = "15"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "9"}}}}}}}}}}}}}}}}, castSpell = {spellId = {spellId = 11275, rank = 6}}}}, {action = {condition = {or = {vals = {{and = {vals = {{not = {val = {runeIsEquipped = {runeId = {spellId = 432271}}}}}, {cmp = {op = "OpLe", lhs = {auraRemainingTime = {auraId = {spellId = 6774, rank = 2}}}, rhs = {const = {val = "1"}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 467735}}}}}, {or = {vals = {{and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "19"}}}}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {cmp = {op = "OpLt", lhs = {remainingTime = {}}, rhs = {const = {val = "19"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "13"}}}}}}}}}}}}}, {and = {vals = {{runeIsEquipped = {runeId = {spellId = 432271}}}, {not = {val = {auraIsActive = {auraId = {spellId = 6774, rank = 2}}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "1"}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 467735}}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "10"}}}}}}}}}}, castSpell = {spellId = {spellId = 6774, rank = 2}}}}, {action = {condition = {or = {vals = {{and = {vals = {{auraIsKnown = {auraId = {spellId = 1232181}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 436611}}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "1"}}}}, {cmp = {op = "OpGt", lhs = {remainingTime = {}}, rhs = {const = {val = "5"}}}}}}}, {and = {vals = {{or = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {runeIsEquipped = {runeId = {spellId = 432276}}}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 436611}}}}}, {or = {vals = {{and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "11"}}}}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {cmp = {op = "OpLt", lhs = {remainingTime = {}}, rhs = {const = {val = "11"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "7"}}}}}}}}}}}}}}}}, castSpell = {spellId = {spellId = 412096}}}}, {action = {condition = {and = {vals = {{or = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "5"}}}}, {and = {vals = {{cmp = {op = "OpLe", lhs = {remainingTime = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}}}}}}}}}}, castSpell = {spellId = {spellId = 399963}}}}, {action = {condition = {and = {vals = {{not = {val = {auraIsActive = {auraId = {spellId = 462707}}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 425096}}}}}, {cmp = {op = "OpGe", lhs = {currentEnergy = {}}, rhs = {const = {val = "35"}}}}, {cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}}}}, castSpell = {spellId = {spellId = 1856, rank = 1}}}}, {action = {castSpell = {spellId = {spellId = 11269, rank = 6}}}}, {action = {castSpell = {spellId = {spellId = 25300, rank = 9}}}}, {action = {condition = {or = {vals = {{and = {vals = {{cmp = {op = "OpGe", lhs = {auraNumStacks = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 1214170, tag = 100}}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpLt", lhs = {currentComboPoints = {}}, rhs = {const = {val = "5"}}}}}}}}}}, castSpell = {spellId = {spellId = 425012}}}}},

        -- Tracked IDs for optimization
        spells = {1787, 1856, 6774, 11269, 11275, 25300, 399963, 412096, 425012, 425096, 432276, 436611, 462707, 467735, 1214170, 1226843, 1232181},
        items = {7676, 231287, 233985},
        auras = {},
        runes = {432271, 432276},

        -- Optional metadata
        glyphs = {},
        lastModified = "06/12/2025",
        author = "APLParser"
    }
)

ns.AddRotationToDefaults(defaults,
    SpecializationCompat:GetSpecID("Rogue", "Assassination"),
    "Rogue Assassination - 1Target_2Min_BiS_Mutilate_Phase8_ST by APLParser",
    {
        -- Required parameters
        default = true,
        enabled = true,
        experimental = false,
        gameType = Version.GAME_TYPES.CLASSIC_ERA_SOD,
        prePull = {
            { NAG:Cast(6774), -2000 }, { NAG:Cast(13877), -1000 }
        },
        rotationString = [[
((NAG:CurrentEnergy() <= 10) or ((NAG:RemainingTime() <= 20) and (NAG:CurrentEnergy() <= 40))) and NAG:Cast(7676)
    or NAG:AutocastOtherCooldowns()
    or (((not NAG:RuneIsEquipped(432276)) and (not NAG:AuraIsActive(1787))) or (NAG:RuneIsEquipped(432276) and NAG:AuraIsActive(432276, "target") and (not NAG:AuraIsActive(1787)))) and NAG:Cast(233985)
    or (((not NAG:RuneIsEquipped(432276)) and NAG:AuraIsActive(6774) and NAG:AuraIsActive(399963)) or (NAG:RuneIsEquipped(432276) and NAG:AuraIsActive(432276, "target") and NAG:AuraIsActive(6774) and NAG:AuraIsActive(399963))) and NAG:Cast(13877)
    or ((NAG:AuraIsKnown(1226843) and NAG:AuraIsKnown(1232181) and (not NAG:AuraIsActive(11275, "target")) and (NAG:CurrentComboPoints() >= 3) and (NAG:RemainingTime() >= 9)) or (NAG:AuraIsKnown(1226843) and (not NAG:AuraIsActive(11275, "target")) and (((NAG:CurrentComboPoints() >= 4) and (NAG:RemainingTime() >= 15)) or ((NAG:CurrentComboPoints() >= 2) and (NAG:RemainingTime() < 15) and (NAG:RemainingTime() >= 9))))) and NAG:Cast(11275)
    or (((not NAG:RuneIsEquipped(432271)) and (NAG:AuraRemainingTime(6774) <= 1) and (((NAG:CurrentComboPoints() >= 4) and (NAG:RemainingTime() >= 19)) or ((NAG:CurrentComboPoints() >= 2) and (NAG:RemainingTime() < 19) and (NAG:RemainingTime() >= 13)))) or (NAG:RuneIsEquipped(432271) and (not NAG:AuraIsActive(6774)) and (NAG:CurrentComboPoints() >= 1) and (NAG:RemainingTime() >= 10))) and NAG:Cast(6774)
    or ((NAG:AuraIsKnown(1232181) and (NAG:AuraIsKnown(1226843) or NAG:RuneIsEquipped(432276)) and (not NAG:AuraIsActive(436611, "target")) and (NAG:CurrentComboPoints() >= 1) and (NAG:RemainingTime() >= 5)) or ((NAG:AuraIsKnown(1226843) or NAG:RuneIsEquipped(432276)) and (not NAG:AuraIsActive(436611, "target")) and (((NAG:CurrentComboPoints() >= 4) and (NAG:RemainingTime() >= 11)) or ((NAG:CurrentComboPoints() >= 2) and (NAG:RemainingTime() < 11) and (NAG:RemainingTime() >= 7))))) and NAG:Cast(412096)
    or ((not NAG:AuraIsActive(425096)) and (NAG:CurrentEnergy() >= 35) and (NAG:CurrentComboPoints() >= 5) and NAG:GCDIsReady() and (NAG:AuraNumStacks(1214170, "target") >= 5)) and NAG:StrictSequence("foo", NAG:Cast(14177), NAG:Cast(1856), NAG:Cast(399963))
    or ((NAG:CurrentComboPoints() >= 4) or ((NAG:CurrentComboPoints() >= 3) and (NAG:RemainingTime() <= 4))) and NAG:Cast(399963)
    or (NAG:CurrentComboPoints() <= 3) and NAG:Cast(399956)
    or (((NAG:AuraNumStacks(1214170, "target") >= 4) and (NAG:CurrentComboPoints() < 5)) or (NAG:AuraRemainingTime(1214170, "target") <= 1)) and NAG:Cast(425012)
        ]],

        -- New action-based format
        --prePullActions = {{action = {addComboPoints = {numPoints = "5"}}, doAtValue = {const = {val = "-4s"}}}, {action = {activateAura = {auraId = {spellId = 1787, rank = 4}}}, doAtValue = {const = {val = "-3s"}}}, {action = {castSpell = {spellId = {spellId = 6774, rank = 2}}}, doAtValue = {const = {val = "-2s"}}}, {action = {castSpell = {spellId = {spellId = 13877}}}, doAtValue = {const = {val = "-1s"}}}, {action = {castSpell = {spellId = {itemId = 215162}}}, doAtValue = {const = {val = "-0.1s"}}}},
        --aplActions = {{action = {condition = {or = {vals = {{cmp = {op = "OpLe", lhs = {currentEnergy = {}}, rhs = {const = {val = "10"}}}}, {and = {vals = {{cmp = {op = "OpLe", lhs = {remainingTime = {}}, rhs = {const = {val = "20"}}}}, {cmp = {op = "OpLe", lhs = {currentEnergy = {}}, rhs = {const = {val = "40"}}}}}}}}}}, castSpell = {spellId = {itemId = 7676}}}}, {action = {autocastOtherCooldowns = {}}}, {action = {condition = {or = {vals = {{and = {vals = {{not = {val = {runeIsEquipped = {runeId = {spellId = 432276}}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 1787, rank = 4}}}}}}}}, {and = {vals = {{runeIsEquipped = {runeId = {spellId = 432276}}}, {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 432276}}}, {not = {val = {auraIsActive = {auraId = {spellId = 1787, rank = 4}}}}}}}}}}}, castSpell = {spellId = {itemId = 233985}}}}, {action = {condition = {or = {vals = {{and = {vals = {{not = {val = {runeIsEquipped = {runeId = {spellId = 432276}}}}}, {auraIsActive = {auraId = {spellId = 6774, rank = 2}}}, {auraIsActive = {auraId = {spellId = 399963}}}}}}, {and = {vals = {{runeIsEquipped = {runeId = {spellId = 432276}}}, {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 432276}}}, {auraIsActive = {auraId = {spellId = 6774, rank = 2}}}, {auraIsActive = {auraId = {spellId = 399963}}}}}}}}}, castSpell = {spellId = {spellId = 13877}}}}, {action = {condition = {or = {vals = {{and = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {auraIsKnown = {auraId = {spellId = 1232181}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 11275, rank = 6}}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "3"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "9"}}}}}}}, {and = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 11275, rank = 6}}}}}, {or = {vals = {{and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "15"}}}}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {cmp = {op = "OpLt", lhs = {remainingTime = {}}, rhs = {const = {val = "15"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "9"}}}}}}}}}}}}}}}}, castSpell = {spellId = {spellId = 11275, rank = 6}}}}, {action = {condition = {or = {vals = {{and = {vals = {{not = {val = {runeIsEquipped = {runeId = {spellId = 432271}}}}}, {cmp = {op = "OpLe", lhs = {auraRemainingTime = {auraId = {spellId = 6774, rank = 2}}}, rhs = {const = {val = "1"}}}}, {or = {vals = {{and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "19"}}}}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {cmp = {op = "OpLt", lhs = {remainingTime = {}}, rhs = {const = {val = "19"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "13"}}}}}}}}}}}}}, {and = {vals = {{runeIsEquipped = {runeId = {spellId = 432271}}}, {not = {val = {auraIsActive = {auraId = {spellId = 6774, rank = 2}}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "1"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "10"}}}}}}}}}}, castSpell = {spellId = {spellId = 6774, rank = 2}}}}, {action = {condition = {or = {vals = {{and = {vals = {{auraIsKnown = {auraId = {spellId = 1232181}}}, {or = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {runeIsEquipped = {runeId = {spellId = 432276}}}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 436611}}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "1"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "5"}}}}}}}, {and = {vals = {{or = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {runeIsEquipped = {runeId = {spellId = 432276}}}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 436611}}}}}, {or = {vals = {{and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "11"}}}}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {cmp = {op = "OpLt", lhs = {remainingTime = {}}, rhs = {const = {val = "11"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "7"}}}}}}}}}}}}}}}}, castSpell = {spellId = {spellId = 412096}}}}, {action = {condition = {and = {vals = {{not = {val = {auraIsActive = {auraId = {spellId = 425096}}}}}, {cmp = {op = "OpGe", lhs = {currentEnergy = {}}, rhs = {const = {val = "35"}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "5"}}}}, {gcdIsReady = {}}, {cmp = {op = "OpGe", lhs = {auraNumStacks = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 1214170, tag = 100}}}, rhs = {const = {val = "5"}}}}}}}, strictSequence = {actions = {{castSpell = {spellId = {spellId = 14177}}}, {castSpell = {spellId = {spellId = 1856, rank = 1}}}, {castSpell = {spellId = {spellId = 399963}}}}, name = "someName691"}}}, {action = {condition = {or = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "3"}}}}, {cmp = {op = "OpLe", lhs = {remainingTime = {}}, rhs = {const = {val = "4"}}}}}}}}}}, castSpell = {spellId = {spellId = 399963}}}}, {action = {condition = {cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "3"}}}}, castSpell = {spellId = {spellId = 399956}}}}, {action = {condition = {or = {vals = {{and = {vals = {{cmp = {op = "OpGe", lhs = {auraNumStacks = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 1214170, tag = 100}}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpLt", lhs = {currentComboPoints = {}}, rhs = {const = {val = "5"}}}}}}}, {cmp = {op = "OpLe", lhs = {auraRemainingTime = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 1214170, tag = 100}}}, rhs = {const = {val = "1"}}}}}}}, castSpell = {spellId = {spellId = 425012}}}}},

        -- Tracked IDs for optimization
        spells = {1787, 1856, 6774, 11275, 13877, 14177, 399956, 399963, 412096, 425012, 425096, 432276, 436611, 1214170, 1226843, 1232181},
        items = {7676, 233985},
        auras = {},
        runes = {432271, 432276},

        -- Optional metadata
        glyphs = {},
        lastModified = "06/12/2025",
        author = "APLParser"
    }
)

ns.AddRotationToDefaults(defaults,
    SpecializationCompat:GetSpecID("Rogue", "Assassination"),
    "Rogue Assassination - 1Target_3Min_BiS_Phase8_ST_SaberSlash by APLParser",
    {
        -- Required parameters
        default = true,
        enabled = true,
        experimental = false,
        gameType = Version.GAME_TYPES.CLASSIC_ERA_SOD,
        prePull = {
            { NAG:Cast(6774), -2000 }, { NAG:Cast(13877), -1000 }
        },
        rotationString = [[
((NAG:CurrentEnergy() <= 10) or ((NAG:RemainingTime() <= 15) and (NAG:CurrentEnergy() <= 40))) and NAG:Cast(7676)
    or NAG:AutocastOtherCooldowns()
    or (((not NAG:RuneIsEquipped(432276)) and (not NAG:AuraIsActive(1787))) or (NAG:RuneIsEquipped(432276) and (not NAG:AuraIsActive(1787)) and NAG:AuraIsActive(432276, "target"))) and NAG:Cast(233985)
    or (NAG:AuraIsKnown(1226843) and (not NAG:AuraIsActive(424785, "target")) and (not NAG:AuraIsActive(11275, "target")) and (not NAG:AuraIsActive(436611, "target")) and (NAG:CurrentComboPoints() <= 4)) and NAG:Cast(425012)
    or (NAG:AuraIsKnown(1226843) and (not NAG:AuraIsActive(424785, "target")) and (not NAG:AuraIsActive(11275, "target")) and (not NAG:AuraIsActive(436611, "target")) and (NAG:CurrentComboPoints() >= 1)) and NAG:Cast(412096)
    or ((NAG:CurrentComboPoints() <= 4) and ((NAG:AuraNumStacks(424785, "target") < 3) or (NAG:AuraRemainingTime(424785, "target") < 2)) and (NAG:AuraRemainingTime(424785, "target") < (NAG:RemainingTime() + 2))) and NAG:Cast(424785)
    or (((not NAG:RuneIsEquipped(432276)) and NAG:AuraIsActive(6774) and NAG:AuraIsActive(399963)) or (NAG:RuneIsEquipped(432276) and NAG:AuraIsActive(432276, "target") and NAG:AuraIsActive(6774) and NAG:AuraIsActive(399963))) and NAG:Cast(13877)
    or ((NAG:AuraNumStacks(1214170, "target") >= 4) and (NAG:CurrentComboPoints() < 5) and (NAG:CurrentEnergy() <= 75)) and NAG:Cast(425012)
    or (((not NAG:RuneIsEquipped(432271)) and (NAG:AuraRemainingTime(6774) <= 1) and (((NAG:CurrentComboPoints() >= 4) and (NAG:RemainingTime() >= 19)) or ((NAG:CurrentComboPoints() >= 2) and (NAG:RemainingTime() < 19) and (NAG:RemainingTime() >= 13)))) or (NAG:RuneIsEquipped(432271) and (not NAG:AuraIsActive(6774)) and (NAG:CurrentComboPoints() >= 1) and (NAG:RemainingTime() >= 10))) and NAG:Cast(6774)
    or ((NAG:AuraIsKnown(1226843) and NAG:AuraIsKnown(1232181) and (not NAG:RuneIsEquipped(432271)) and (not NAG:AuraIsActive(436611, "target")) and (NAG:CurrentComboPoints() >= 1) and (NAG:RemainingTime() >= 5)) or (NAG:AuraIsKnown(1226843) and (not NAG:RuneIsEquipped(432271)) and (not NAG:AuraIsActive(436611, "target")) and (((NAG:CurrentComboPoints() >= 4) and (NAG:RemainingTime() >= 11)) or ((NAG:CurrentComboPoints() >= 2) and (NAG:RemainingTime() < 11) and (NAG:RemainingTime() >= 7))))) and NAG:Cast(412096)
    or ((not NAG:AuraIsActive(425096)) and (NAG:CurrentEnergy() >= 35) and (NAG:CurrentComboPoints() >= 5) and NAG:GCDIsReady() and (NAG:AuraNumStacks(1214170, "target") >= 5)) and NAG:StrictSequence("foo", NAG:Cast(14177), NAG:Cast(1856), NAG:Cast(399963))
    or ((NAG:CurrentComboPoints() >= 4) or ((NAG:CurrentComboPoints() >= 3) and (NAG:RemainingTime() <= 4))) and NAG:Cast(399963)
    or ((NAG:AuraIsKnown(1226843) and (NAG:CurrentComboPoints() <= 4) and (NAG:CurrentEnergy() >= 75) and (NAG:AuraRemainingTime(424785, "target") >= 8) and (NAG:AuraNumStacks(424785, "target") >= 3)) or (NAG:AuraIsKnown(1226843) and (NAG:CurrentComboPoints() <= 2) and (NAG:AuraRemainingTime(424785, "target") >= 8) and (NAG:AuraNumStacks(424785, "target") >= 3)) or (NAG:AuraIsKnown(1226843) and (NAG:CurrentComboPoints() <= 2) and (NAG:RemainingTime() <= 4) and (NAG:AuraNumStacks(424785, "target") >= 3))) and NAG:Cast(11294)
    or ((NAG:CurrentComboPoints() <= 2) or ((NAG:CurrentComboPoints() <= 4) and (NAG:CurrentEnergy() >= 75))) and NAG:Cast(424785)
        ]],

        -- New action-based format
        --prePullActions = {{action = {addComboPoints = {numPoints = "5"}}, doAtValue = {const = {val = "-4s"}}}, {action = {activateAura = {auraId = {spellId = 1787, rank = 4}}}, doAtValue = {const = {val = "-3s"}}}, {action = {castSpell = {spellId = {spellId = 6774, rank = 2}}}, doAtValue = {const = {val = "-2s"}}}, {action = {castSpell = {spellId = {spellId = 13877}}}, doAtValue = {const = {val = "-1s"}}}, {action = {castSpell = {spellId = {itemId = 215162}}}, doAtValue = {const = {val = "-0.1s"}}}},
        --aplActions = {{action = {condition = {or = {vals = {{cmp = {op = "OpLe", lhs = {currentEnergy = {}}, rhs = {const = {val = "10"}}}}, {and = {vals = {{cmp = {op = "OpLe", lhs = {remainingTime = {}}, rhs = {const = {val = "15"}}}}, {cmp = {op = "OpLe", lhs = {currentEnergy = {}}, rhs = {const = {val = "40"}}}}}}}}}}, castSpell = {spellId = {itemId = 7676}}}}, {action = {autocastOtherCooldowns = {}}}, {action = {condition = {or = {vals = {{and = {vals = {{not = {val = {runeIsEquipped = {runeId = {spellId = 432276}}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 1787, rank = 4}}}}}}}}, {and = {vals = {{runeIsEquipped = {runeId = {spellId = 432276}}}, {not = {val = {auraIsActive = {auraId = {spellId = 1787, rank = 4}}}}}, {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 432276}}}}}}}}}, castSpell = {spellId = {itemId = 233985}}}}, {action = {condition = {and = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 424785}}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 11275, rank = 6}}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 436611}}}}}, {cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}}}}, castSpell = {spellId = {spellId = 425012}}}}, {action = {condition = {and = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 424785}}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 11275, rank = 6}}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 436611}}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "1"}}}}}}}, castSpell = {spellId = {spellId = 412096}}}}, {action = {condition = {and = {vals = {{cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {or = {vals = {{cmp = {op = "OpLt", lhs = {auraNumStacks = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 424785}}}, rhs = {const = {val = "3"}}}}, {cmp = {op = "OpLt", lhs = {auraRemainingTime = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 424785}}}, rhs = {const = {val = "2"}}}}}}}, {cmp = {op = "OpLt", lhs = {auraRemainingTime = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 424785}}}, rhs = {math = {op = "OpAdd", lhs = {remainingTime = {}}, rhs = {const = {val = "2"}}}}}}}}}, castSpell = {spellId = {spellId = 424785}}}}, {action = {condition = {or = {vals = {{and = {vals = {{not = {val = {runeIsEquipped = {runeId = {spellId = 432276}}}}}, {auraIsActive = {auraId = {spellId = 6774, rank = 2}}}, {auraIsActive = {auraId = {spellId = 399963}}}}}}, {and = {vals = {{runeIsEquipped = {runeId = {spellId = 432276}}}, {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 432276}}}, {auraIsActive = {auraId = {spellId = 6774, rank = 2}}}, {auraIsActive = {auraId = {spellId = 399963}}}}}}}}}, castSpell = {spellId = {spellId = 13877}}}}, {action = {condition = {and = {vals = {{cmp = {op = "OpGe", lhs = {auraNumStacks = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 1214170, tag = 100}}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpLt", lhs = {currentComboPoints = {}}, rhs = {const = {val = "5"}}}}, {cmp = {op = "OpLe", lhs = {currentEnergy = {}}, rhs = {const = {val = "75"}}}}}}}, castSpell = {spellId = {spellId = 425012}}}}, {action = {condition = {or = {vals = {{and = {vals = {{not = {val = {runeIsEquipped = {runeId = {spellId = 432271}}}}}, {cmp = {op = "OpLe", lhs = {auraRemainingTime = {auraId = {spellId = 6774, rank = 2}}}, rhs = {const = {val = "1"}}}}, {or = {vals = {{and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "19"}}}}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {cmp = {op = "OpLt", lhs = {remainingTime = {}}, rhs = {const = {val = "19"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "13"}}}}}}}}}}}}}, {and = {vals = {{runeIsEquipped = {runeId = {spellId = 432271}}}, {not = {val = {auraIsActive = {auraId = {spellId = 6774, rank = 2}}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "1"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "10"}}}}}}}}}}, castSpell = {spellId = {spellId = 6774, rank = 2}}}}, {action = {condition = {or = {vals = {{and = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {auraIsKnown = {auraId = {spellId = 1232181}}}, {not = {val = {runeIsEquipped = {runeId = {spellId = 432271}}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 436611}}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "1"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "5"}}}}}}}, {and = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {not = {val = {runeIsEquipped = {runeId = {spellId = 432271}}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 436611}}}}}, {or = {vals = {{and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "11"}}}}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {cmp = {op = "OpLt", lhs = {remainingTime = {}}, rhs = {const = {val = "11"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "7"}}}}}}}}}}}}}}}}, castSpell = {spellId = {spellId = 412096}}}}, {hide = true, action = {condition = {or = {vals = {{and = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {auraIsKnown = {auraId = {spellId = 1232181}}}, {not = {val = {runeIsEquipped = {runeId = {spellId = 432271}}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 11275, rank = 6}}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "3"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "9"}}}}}}}, {and = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {not = {val = {runeIsEquipped = {runeId = {spellId = 432271}}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 11275, rank = 6}}}}}, {or = {vals = {{and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "15"}}}}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {cmp = {op = "OpLt", lhs = {remainingTime = {}}, rhs = {const = {val = "15"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "9"}}}}}}}}}}}}}}}}, castSpell = {spellId = {spellId = 11275, rank = 6}}}}, {action = {condition = {and = {vals = {{not = {val = {auraIsActive = {auraId = {spellId = 425096}}}}}, {cmp = {op = "OpGe", lhs = {currentEnergy = {}}, rhs = {const = {val = "35"}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "5"}}}}, {gcdIsReady = {}}, {cmp = {op = "OpGe", lhs = {auraNumStacks = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 1214170, tag = 100}}}, rhs = {const = {val = "5"}}}}}}}, strictSequence = {actions = {{castSpell = {spellId = {spellId = 14177}}}, {castSpell = {spellId = {spellId = 1856, rank = 1}}}, {castSpell = {spellId = {spellId = 399963}}}}, name = "someName222"}}}, {action = {condition = {or = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "3"}}}}, {cmp = {op = "OpLe", lhs = {remainingTime = {}}, rhs = {const = {val = "4"}}}}}}}}}}, castSpell = {spellId = {spellId = 399963}}}}, {action = {condition = {or = {vals = {{and = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {currentEnergy = {}}, rhs = {const = {val = "75"}}}}, {cmp = {op = "OpGe", lhs = {auraRemainingTime = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 424785}}}, rhs = {const = {val = "8"}}}}, {cmp = {op = "OpGe", lhs = {auraNumStacks = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 424785}}}, rhs = {const = {val = "3"}}}}}}}, {and = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {cmp = {op = "OpGe", lhs = {auraRemainingTime = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 424785}}}, rhs = {const = {val = "8"}}}}, {cmp = {op = "OpGe", lhs = {auraNumStacks = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 424785}}}, rhs = {const = {val = "3"}}}}}}}, {and = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {cmp = {op = "OpLe", lhs = {remainingTime = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {auraNumStacks = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 424785}}}, rhs = {const = {val = "3"}}}}}}}}}}, castSpell = {spellId = {spellId = 11294, rank = 8}}}}, {action = {condition = {or = {vals = {{cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {and = {vals = {{cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {currentEnergy = {}}, rhs = {const = {val = "75"}}}}}}}}}}, castSpell = {spellId = {spellId = 424785}}}}},

        -- Tracked IDs for optimization
        spells = {1787, 1856, 6774, 11275, 11294, 13877, 14177, 399963, 412096, 424785, 425012, 425096, 432276, 436611, 1214170, 1226843, 1232181},
        items = {7676, 233985},
        auras = {},
        runes = {432271, 432276},

        -- Optional metadata
        glyphs = {},
        lastModified = "06/12/2025",
        author = "APLParser"
    }
)

ns.AddRotationToDefaults(defaults,
    SpecializationCompat:GetSpecID("Rogue", "Assassination"),
    "Rogue Assassination - 1Target_3Min_BiS_Mutilate_Phase8_ST by APLParser",
    {
        -- Required parameters
        default = true,
        enabled = true,
        experimental = false,
        gameType = Version.GAME_TYPES.CLASSIC_ERA_SOD,
        prePull = {
            { NAG:Cast(6774), -2000 }, { NAG:Cast(13877), -1000 }
        },
        rotationString = [[
((NAG:CurrentEnergy() <= 10) or ((NAG:RemainingTime() <= 20) and (NAG:CurrentEnergy() <= 40))) and NAG:Cast(7676)
    or NAG:AutocastOtherCooldowns()
    or (((not NAG:RuneIsEquipped(432276)) and (not NAG:AuraIsActive(1787))) or (NAG:RuneIsEquipped(432276) and NAG:AuraIsActive(432276, "target") and (not NAG:AuraIsActive(1787)))) and NAG:Cast(233985)
    or (((not NAG:RuneIsEquipped(432276)) and NAG:AuraIsActive(6774) and NAG:AuraIsActive(399963)) or (NAG:RuneIsEquipped(432276) and NAG:AuraIsActive(432276, "target") and NAG:AuraIsActive(6774) and NAG:AuraIsActive(399963))) and NAG:Cast(13877)
    or ((NAG:AuraIsKnown(1226843) and NAG:AuraIsKnown(1232181) and (not NAG:AuraIsActive(11275, "target")) and (NAG:CurrentComboPoints() >= 3) and (NAG:RemainingTime() >= 9)) or (NAG:AuraIsKnown(1226843) and (not NAG:AuraIsActive(11275, "target")) and (((NAG:CurrentComboPoints() >= 4) and (NAG:RemainingTime() >= 15)) or ((NAG:CurrentComboPoints() >= 2) and (NAG:RemainingTime() < 15) and (NAG:RemainingTime() >= 9))))) and NAG:Cast(11275)
    or (((not NAG:RuneIsEquipped(432271)) and (NAG:AuraRemainingTime(6774) <= 1) and (((NAG:CurrentComboPoints() >= 4) and (NAG:RemainingTime() >= 19)) or ((NAG:CurrentComboPoints() >= 2) and (NAG:RemainingTime() < 19) and (NAG:RemainingTime() >= 13)))) or (NAG:RuneIsEquipped(432271) and (not NAG:AuraIsActive(6774)) and (NAG:CurrentComboPoints() >= 1) and (NAG:RemainingTime() >= 10))) and NAG:Cast(6774)
    or ((NAG:AuraIsKnown(1232181) and (NAG:AuraIsKnown(1226843) or NAG:RuneIsEquipped(432276)) and (not NAG:AuraIsActive(436611, "target")) and (NAG:CurrentComboPoints() >= 1) and (NAG:RemainingTime() >= 5)) or ((NAG:AuraIsKnown(1226843) or NAG:RuneIsEquipped(432276)) and (not NAG:AuraIsActive(436611, "target")) and (((NAG:CurrentComboPoints() >= 4) and (NAG:RemainingTime() >= 11)) or ((NAG:CurrentComboPoints() >= 2) and (NAG:RemainingTime() < 11) and (NAG:RemainingTime() >= 7))))) and NAG:Cast(412096)
    or ((not NAG:AuraIsActive(425096)) and (NAG:CurrentEnergy() >= 35) and (NAG:CurrentComboPoints() >= 5) and NAG:GCDIsReady() and (NAG:AuraNumStacks(1214170, "target") >= 5)) and NAG:StrictSequence("foo", NAG:Cast(14177), NAG:Cast(1856), NAG:Cast(399963))
    or ((NAG:CurrentComboPoints() >= 4) or ((NAG:CurrentComboPoints() >= 3) and (NAG:RemainingTime() <= 4))) and NAG:Cast(399963)
    or (NAG:CurrentComboPoints() <= 3) and NAG:Cast(399956)
    or (((NAG:AuraNumStacks(1214170, "target") >= 4) and (NAG:CurrentComboPoints() < 5)) or (NAG:AuraRemainingTime(1214170, "target") <= 1)) and NAG:Cast(425012)
        ]],

        -- New action-based format
        --prePullActions = {{action = {addComboPoints = {numPoints = "5"}}, doAtValue = {const = {val = "-4s"}}}, {action = {activateAura = {auraId = {spellId = 1787, rank = 4}}}, doAtValue = {const = {val = "-3s"}}}, {action = {castSpell = {spellId = {spellId = 6774, rank = 2}}}, doAtValue = {const = {val = "-2s"}}}, {action = {castSpell = {spellId = {spellId = 13877}}}, doAtValue = {const = {val = "-1s"}}}, {action = {castSpell = {spellId = {itemId = 215162}}}, doAtValue = {const = {val = "-0.1s"}}}},
        --aplActions = {{action = {condition = {or = {vals = {{cmp = {op = "OpLe", lhs = {currentEnergy = {}}, rhs = {const = {val = "10"}}}}, {and = {vals = {{cmp = {op = "OpLe", lhs = {remainingTime = {}}, rhs = {const = {val = "20"}}}}, {cmp = {op = "OpLe", lhs = {currentEnergy = {}}, rhs = {const = {val = "40"}}}}}}}}}}, castSpell = {spellId = {itemId = 7676}}}}, {action = {autocastOtherCooldowns = {}}}, {action = {condition = {or = {vals = {{and = {vals = {{not = {val = {runeIsEquipped = {runeId = {spellId = 432276}}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 1787, rank = 4}}}}}}}}, {and = {vals = {{runeIsEquipped = {runeId = {spellId = 432276}}}, {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 432276}}}, {not = {val = {auraIsActive = {auraId = {spellId = 1787, rank = 4}}}}}}}}}}}, castSpell = {spellId = {itemId = 233985}}}}, {action = {condition = {or = {vals = {{and = {vals = {{not = {val = {runeIsEquipped = {runeId = {spellId = 432276}}}}}, {auraIsActive = {auraId = {spellId = 6774, rank = 2}}}, {auraIsActive = {auraId = {spellId = 399963}}}}}}, {and = {vals = {{runeIsEquipped = {runeId = {spellId = 432276}}}, {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 432276}}}, {auraIsActive = {auraId = {spellId = 6774, rank = 2}}}, {auraIsActive = {auraId = {spellId = 399963}}}}}}}}}, castSpell = {spellId = {spellId = 13877}}}}, {action = {condition = {or = {vals = {{and = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {auraIsKnown = {auraId = {spellId = 1232181}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 11275, rank = 6}}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "3"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "9"}}}}}}}, {and = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 11275, rank = 6}}}}}, {or = {vals = {{and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "15"}}}}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {cmp = {op = "OpLt", lhs = {remainingTime = {}}, rhs = {const = {val = "15"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "9"}}}}}}}}}}}}}}}}, castSpell = {spellId = {spellId = 11275, rank = 6}}}}, {action = {condition = {or = {vals = {{and = {vals = {{not = {val = {runeIsEquipped = {runeId = {spellId = 432271}}}}}, {cmp = {op = "OpLe", lhs = {auraRemainingTime = {auraId = {spellId = 6774, rank = 2}}}, rhs = {const = {val = "1"}}}}, {or = {vals = {{and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "19"}}}}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {cmp = {op = "OpLt", lhs = {remainingTime = {}}, rhs = {const = {val = "19"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "13"}}}}}}}}}}}}}, {and = {vals = {{runeIsEquipped = {runeId = {spellId = 432271}}}, {not = {val = {auraIsActive = {auraId = {spellId = 6774, rank = 2}}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "1"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "10"}}}}}}}}}}, castSpell = {spellId = {spellId = 6774, rank = 2}}}}, {action = {condition = {or = {vals = {{and = {vals = {{auraIsKnown = {auraId = {spellId = 1232181}}}, {or = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {runeIsEquipped = {runeId = {spellId = 432276}}}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 436611}}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "1"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "5"}}}}}}}, {and = {vals = {{or = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {runeIsEquipped = {runeId = {spellId = 432276}}}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 436611}}}}}, {or = {vals = {{and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "11"}}}}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {cmp = {op = "OpLt", lhs = {remainingTime = {}}, rhs = {const = {val = "11"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "7"}}}}}}}}}}}}}}}}, castSpell = {spellId = {spellId = 412096}}}}, {action = {condition = {and = {vals = {{not = {val = {auraIsActive = {auraId = {spellId = 425096}}}}}, {cmp = {op = "OpGe", lhs = {currentEnergy = {}}, rhs = {const = {val = "35"}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "5"}}}}, {gcdIsReady = {}}, {cmp = {op = "OpGe", lhs = {auraNumStacks = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 1214170, tag = 100}}}, rhs = {const = {val = "5"}}}}}}}, strictSequence = {actions = {{castSpell = {spellId = {spellId = 14177}}}, {castSpell = {spellId = {spellId = 1856, rank = 1}}}, {castSpell = {spellId = {spellId = 399963}}}}, name = "someName458"}}}, {action = {condition = {or = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "3"}}}}, {cmp = {op = "OpLe", lhs = {remainingTime = {}}, rhs = {const = {val = "4"}}}}}}}}}}, castSpell = {spellId = {spellId = 399963}}}}, {action = {condition = {cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "3"}}}}, castSpell = {spellId = {spellId = 399956}}}}, {action = {condition = {or = {vals = {{and = {vals = {{cmp = {op = "OpGe", lhs = {auraNumStacks = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 1214170, tag = 100}}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpLt", lhs = {currentComboPoints = {}}, rhs = {const = {val = "5"}}}}}}}, {cmp = {op = "OpLe", lhs = {auraRemainingTime = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 1214170, tag = 100}}}, rhs = {const = {val = "1"}}}}}}}, castSpell = {spellId = {spellId = 425012}}}}},

        -- Tracked IDs for optimization
        spells = {1787, 1856, 6774, 11275, 13877, 14177, 399956, 399963, 412096, 425012, 425096, 432276, 436611, 1214170, 1226843, 1232181},
        items = {7676, 233985},
        auras = {},
        runes = {432271, 432276},

        -- Optional metadata
        glyphs = {},
        lastModified = "06/12/2025",
        author = "APLParser"
    }
)

ns.AddRotationToDefaults(defaults,
    SpecializationCompat:GetSpecID("Rogue", "Subtlety"),
    "Rogue Subtlety - 1Target_3Min_Backstab_BiS_Phase8_ST by APLParser",
    {
        -- Required parameters
        default = true,
        enabled = true,
        experimental = false,
        gameType = Version.GAME_TYPES.CLASSIC_ERA_SOD,
        prePull = {
            { NAG:Cast(6774), -1000 }
        },
        rotationString = [[
(((NAG:CurrentEnergy() <= 10) and (NAG:CurrentComboPoints() <= 4) and (NAG:TimeToEnergyTick() > 1)) or ((NAG:RemainingTime() <= 15) and (NAG:CurrentEnergy() <= 40) and (NAG:TimeToEnergyTick() > 1))) and NAG:Cast(7676)
    or (((NAG:CurrentEnergy() < 25) and (NAG:CurrentComboPoints() <= 4) and (NAG:TimeToEnergyTick() > 1) and (not NAG:AuraIsActive(467735)) and (not NAG:AuraIsActive(462707))) or ((NAG:RemainingTime() <= 15) and (NAG:CurrentEnergy() < 35) and (NAG:TimeToEnergyTick() > 1) and (not NAG:AuraIsActive(467735)) and (not NAG:AuraIsActive(462707)))) and NAG:Cast(231287)
    or NAG:AutocastOtherCooldowns()
    or (((not NAG:RuneIsEquipped(432276)) and (not NAG:AuraIsActive(1787))) or (NAG:RuneIsEquipped(432276) and NAG:AuraIsActive(432276, "target") and (not NAG:AuraIsActive(1787)))) and NAG:Cast(233985)
    or ((NAG:CurrentEnergy() >= 60) and NAG:AuraIsKnown(467735) and NAG:AuraIsActive(467735)) and NAG:Cast(25300)
    or ((NAG:AuraIsKnown(1232181) and NAG:AuraIsKnown(1226843) and (not NAG:AuraIsActive(11275, "target")) and (NAG:CurrentComboPoints() >= 4) and (NAG:RemainingTime() > 9)) or (NAG:AuraIsKnown(1226843) and (not NAG:AuraIsActive(11275, "target")) and (((NAG:CurrentComboPoints() >= 4) and (NAG:RemainingTime() >= 15)) or ((NAG:CurrentComboPoints() >= 2) and (NAG:RemainingTime() < 15) and (NAG:RemainingTime() >= 9))))) and NAG:Cast(11275)
    or (((not NAG:RuneIsEquipped(432271)) and (NAG:AuraRemainingTime(6774) <= 1) and (not NAG:AuraIsActive(467735)) and (((NAG:CurrentComboPoints() >= 4) and (NAG:RemainingTime() >= 19)) or ((NAG:CurrentComboPoints() >= 2) and (NAG:RemainingTime() < 19) and (NAG:RemainingTime() >= 13)))) or (NAG:RuneIsEquipped(432271) and (not NAG:AuraIsActive(6774)) and (NAG:CurrentComboPoints() >= 1) and (not NAG:AuraIsActive(467735)) and (NAG:RemainingTime() >= 10))) and NAG:Cast(6774)
    or ((NAG:AuraIsKnown(1232181) and (not NAG:AuraIsActive(436611, "target")) and (NAG:CurrentComboPoints() >= 1) and (NAG:RemainingTime() > 5)) or ((NAG:AuraIsKnown(1226843) or NAG:RuneIsEquipped(432276)) and (not NAG:AuraIsActive(436611, "target")) and (((NAG:CurrentComboPoints() >= 4) and (NAG:RemainingTime() >= 11)) or ((NAG:CurrentComboPoints() >= 2) and (NAG:RemainingTime() < 11) and (NAG:RemainingTime() >= 7))))) and NAG:Cast(412096)
    or (((NAG:CurrentComboPoints() >= 5) or ((NAG:RemainingTime() <= 4) and (NAG:CurrentComboPoints() >= 4)))) and NAG:Cast(399963)
    or ((not NAG:AuraIsActive(462707)) and (not NAG:AuraIsActive(425096)) and (NAG:CurrentEnergy() >= 35) and (NAG:CurrentComboPoints() <= 2)) and NAG:Cast(1856)
    or NAG:Cast(11269)
    or NAG:Cast(25300)
    or (((NAG:AuraNumStacks(1214170, "target") >= 4) and (NAG:CurrentComboPoints() < 5))) and NAG:Cast(425012)
        ]],

        -- New action-based format
        --prePullActions = {{action = {addComboPoints = {numPoints = "5"}}, doAtValue = {const = {val = "-3s"}}}, {action = {activateAura = {auraId = {spellId = 1787, rank = 4}}}, doAtValue = {const = {val = "-2s"}}}, {action = {castSpell = {spellId = {spellId = 6774, rank = 2}}}, doAtValue = {const = {val = "-1s"}}}, {action = {castSpell = {spellId = {itemId = 215162}}}, doAtValue = {const = {val = "-0.1s"}}}},
        --aplActions = {{action = {condition = {or = {vals = {{and = {vals = {{cmp = {op = "OpLe", lhs = {currentEnergy = {}}, rhs = {const = {val = "10"}}}}, {cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGt", lhs = {timeToEnergyTick = {}}, rhs = {const = {val = "1"}}}}}}}, {and = {vals = {{cmp = {op = "OpLe", lhs = {remainingTime = {}}, rhs = {const = {val = "15"}}}}, {cmp = {op = "OpLe", lhs = {currentEnergy = {}}, rhs = {const = {val = "40"}}}}, {cmp = {op = "OpGt", lhs = {timeToEnergyTick = {}}, rhs = {const = {val = "1"}}}}}}}}}}, castSpell = {spellId = {itemId = 7676}}}}, {action = {condition = {or = {vals = {{and = {vals = {{cmp = {op = "OpLt", lhs = {currentEnergy = {}}, rhs = {const = {val = "25"}}}}, {cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGt", lhs = {timeToEnergyTick = {}}, rhs = {const = {val = "1"}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 467735}}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 462707}}}}}}}}, {and = {vals = {{cmp = {op = "OpLe", lhs = {remainingTime = {}}, rhs = {const = {val = "15"}}}}, {cmp = {op = "OpLt", lhs = {currentEnergy = {}}, rhs = {const = {val = "35"}}}}, {cmp = {op = "OpGt", lhs = {timeToEnergyTick = {}}, rhs = {const = {val = "1"}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 467735}}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 462707}}}}}}}}}}}, castSpell = {spellId = {itemId = 231287}}}}, {action = {autocastOtherCooldowns = {}}}, {action = {condition = {or = {vals = {{and = {vals = {{not = {val = {runeIsEquipped = {runeId = {spellId = 432276}}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 1787, rank = 4}}}}}}}}, {and = {vals = {{runeIsEquipped = {runeId = {spellId = 432276}}}, {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 432276}}}, {not = {val = {auraIsActive = {auraId = {spellId = 1787, rank = 4}}}}}}}}}}}, castSpell = {spellId = {itemId = 233985}}}}, {action = {condition = {and = {vals = {{cmp = {op = "OpGe", lhs = {currentEnergy = {}}, rhs = {const = {val = "60"}}}}, {auraIsKnown = {auraId = {spellId = 467735}}}, {auraIsActive = {auraId = {spellId = 467735}}}}}}, castSpell = {spellId = {spellId = 25300, rank = 9}}}}, {action = {condition = {or = {vals = {{and = {vals = {{auraIsKnown = {auraId = {spellId = 1232181}}}, {auraIsKnown = {auraId = {spellId = 1226843}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 11275, rank = 6}}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGt", lhs = {remainingTime = {}}, rhs = {const = {val = "9"}}}}}}}, {and = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 11275, rank = 6}}}}}, {or = {vals = {{and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "15"}}}}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {cmp = {op = "OpLt", lhs = {remainingTime = {}}, rhs = {const = {val = "15"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "9"}}}}}}}}}}}}}}}}, castSpell = {spellId = {spellId = 11275, rank = 6}}}}, {action = {condition = {or = {vals = {{and = {vals = {{not = {val = {runeIsEquipped = {runeId = {spellId = 432271}}}}}, {cmp = {op = "OpLe", lhs = {auraRemainingTime = {auraId = {spellId = 6774, rank = 2}}}, rhs = {const = {val = "1"}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 467735}}}}}, {or = {vals = {{and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "19"}}}}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {cmp = {op = "OpLt", lhs = {remainingTime = {}}, rhs = {const = {val = "19"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "13"}}}}}}}}}}}}}, {and = {vals = {{runeIsEquipped = {runeId = {spellId = 432271}}}, {not = {val = {auraIsActive = {auraId = {spellId = 6774, rank = 2}}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "1"}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 467735}}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "10"}}}}}}}}}}, castSpell = {spellId = {spellId = 6774, rank = 2}}}}, {action = {condition = {or = {vals = {{and = {vals = {{auraIsKnown = {auraId = {spellId = 1232181}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 436611}}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "1"}}}}, {cmp = {op = "OpGt", lhs = {remainingTime = {}}, rhs = {const = {val = "5"}}}}}}}, {and = {vals = {{or = {vals = {{auraIsKnown = {auraId = {spellId = 1226843}}}, {runeIsEquipped = {runeId = {spellId = 432276}}}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 436611}}}}}, {or = {vals = {{and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "11"}}}}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {cmp = {op = "OpLt", lhs = {remainingTime = {}}, rhs = {const = {val = "11"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "7"}}}}}}}}}}}}}}}}, castSpell = {spellId = {spellId = 412096}}}}, {action = {condition = {and = {vals = {{or = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "5"}}}}, {and = {vals = {{cmp = {op = "OpLe", lhs = {remainingTime = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}}}}}}}}}}, castSpell = {spellId = {spellId = 399963}}}}, {action = {condition = {and = {vals = {{not = {val = {auraIsActive = {auraId = {spellId = 462707}}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 425096}}}}}, {cmp = {op = "OpGe", lhs = {currentEnergy = {}}, rhs = {const = {val = "35"}}}}, {cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}}}}, castSpell = {spellId = {spellId = 1856, rank = 1}}}}, {action = {castSpell = {spellId = {spellId = 11269, rank = 6}}}}, {action = {castSpell = {spellId = {spellId = 25300, rank = 9}}}}, {action = {condition = {or = {vals = {{and = {vals = {{cmp = {op = "OpGe", lhs = {auraNumStacks = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 1214170, tag = 100}}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpLt", lhs = {currentComboPoints = {}}, rhs = {const = {val = "5"}}}}}}}}}}, castSpell = {spellId = {spellId = 425012}}}}},

        -- Tracked IDs for optimization
        spells = {1787, 1856, 6774, 11269, 11275, 25300, 399963, 412096, 425012, 425096, 432276, 436611, 462707, 467735, 1214170, 1226843, 1232181},
        items = {7676, 231287, 233985},
        auras = {},
        runes = {432271, 432276},

        -- Optional metadata
        glyphs = {},
        lastModified = "06/12/2025",
        author = "APLParser"
    }
)

ns.AddRotationToDefaults(defaults,
    SpecializationCompat:GetSpecID("Rogue", "Assassination"),
    "Rogue Assassination - 2Target_1Min_BiS_Cleave_Phase8_SaberSlash by APLParser",
    {
        -- Required parameters
        default = true,
        enabled = true,
        experimental = false,
        gameType = Version.GAME_TYPES.CLASSIC_ERA_SOD,
        prePull = {
            { NAG:Cast(6774), -2000 }, { NAG:Cast(13877), -1000 }
        },
        rotationString = [[
((NAG:CurrentEnergy() <= 10) or ((NAG:RemainingTime() <= 15) and (NAG:CurrentEnergy() <= 40))) and NAG:Cast(7676)
    or NAG:AutocastOtherCooldowns()
    or (((not NAG:RuneIsEquipped(432276)) and (not NAG:AuraIsActive(1787))) or (NAG:RuneIsEquipped(432276) and (not NAG:AuraIsActive(1787)) and NAG:AuraIsActive(432276, "target"))) and NAG:Cast(233985)
    or ((NAG:CurrentComboPoints() <= 4) and ((NAG:AuraNumStacks(424785, "target") < 3) or (NAG:AuraRemainingTime(424785, "target") < 2)) and (NAG:AuraRemainingTime(424785, "target") < (NAG:RemainingTime() + 2))) and NAG:Cast(424785)
    or (((not NAG:RuneIsEquipped(432276)) and NAG:AuraIsActive(6774) and NAG:AuraIsActive(399963)) or (NAG:RuneIsEquipped(432276) and NAG:AuraIsActive(432276, "target") and NAG:AuraIsActive(6774) and NAG:AuraIsActive(399963))) and NAG:Cast(13877)
    or ((NAG:AuraNumStacks(1214170, "target") >= 4) and (NAG:CurrentComboPoints() < 5) and (NAG:CurrentEnergy() <= 75)) and NAG:Cast(425012)
    or (((not NAG:RuneIsEquipped(432271)) and (NAG:AuraRemainingTime(6774) <= 1) and (NAG:CurrentComboPoints() >= 4) and (NAG:RemainingTime() >= 10)) or (NAG:RuneIsEquipped(432271) and (not NAG:AuraIsActive(6774)) and (NAG:CurrentComboPoints() >= 1))) and NAG:Cast(6774)
    or ((not NAG:AuraIsActive(425096)) and (NAG:CurrentEnergy() >= 35) and (NAG:CurrentComboPoints() == 5) and NAG:GCDIsReady() and (NAG:AuraNumStacks(1214170, "target") == 5)) and NAG:StrictSequence("foo", NAG:Cast(14177), NAG:Cast(1856), NAG:Cast(399963))
    or ((NAG:CurrentComboPoints() == 5) or ((NAG:CurrentComboPoints() >= 4) and (NAG:CurrentEnergy() >= 25)) or ((NAG:CurrentComboPoints() >= 3) and (NAG:RemainingTime() <= 4))) and NAG:Cast(399963)
    or ((NAG:CurrentComboPoints() <= 2) or ((NAG:CurrentComboPoints() <= 4) and (NAG:CurrentEnergy() >= 75))) and NAG:Cast(424785)
        ]],

        -- New action-based format
        --prePullActions = {{action = {addComboPoints = {numPoints = "5"}}, doAtValue = {const = {val = "-4s"}}}, {action = {activateAura = {auraId = {spellId = 1787, rank = 4}}}, doAtValue = {const = {val = "-3s"}}}, {action = {castSpell = {spellId = {spellId = 6774, rank = 2}}}, doAtValue = {const = {val = "-2s"}}}, {action = {castSpell = {spellId = {spellId = 13877}}}, doAtValue = {const = {val = "-1s"}}}, {action = {castSpell = {spellId = {itemId = 215162}}}, doAtValue = {const = {val = "-0.1s"}}}},
        --aplActions = {{action = {condition = {or = {vals = {{cmp = {op = "OpLe", lhs = {currentEnergy = {}}, rhs = {const = {val = "10"}}}}, {and = {vals = {{cmp = {op = "OpLe", lhs = {remainingTime = {}}, rhs = {const = {val = "15"}}}}, {cmp = {op = "OpLe", lhs = {currentEnergy = {}}, rhs = {const = {val = "40"}}}}}}}}}}, castSpell = {spellId = {itemId = 7676}}}}, {action = {autocastOtherCooldowns = {}}}, {action = {condition = {or = {vals = {{and = {vals = {{not = {val = {runeIsEquipped = {runeId = {spellId = 432276}}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 1787, rank = 4}}}}}}}}, {and = {vals = {{runeIsEquipped = {runeId = {spellId = 432276}}}, {not = {val = {auraIsActive = {auraId = {spellId = 1787, rank = 4}}}}}, {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 432276}}}}}}}}}, castSpell = {spellId = {itemId = 233985}}}}, {action = {condition = {and = {vals = {{cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {or = {vals = {{cmp = {op = "OpLt", lhs = {auraNumStacks = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 424785}}}, rhs = {const = {val = "3"}}}}, {cmp = {op = "OpLt", lhs = {auraRemainingTime = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 424785}}}, rhs = {const = {val = "2"}}}}}}}, {cmp = {op = "OpLt", lhs = {auraRemainingTime = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 424785}}}, rhs = {math = {op = "OpAdd", lhs = {remainingTime = {}}, rhs = {const = {val = "2"}}}}}}}}}, castSpell = {spellId = {spellId = 424785}}}}, {action = {condition = {or = {vals = {{and = {vals = {{not = {val = {runeIsEquipped = {runeId = {spellId = 432276}}}}}, {auraIsActive = {auraId = {spellId = 6774, rank = 2}}}, {auraIsActive = {auraId = {spellId = 399963}}}}}}, {and = {vals = {{runeIsEquipped = {runeId = {spellId = 432276}}}, {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 432276}}}, {auraIsActive = {auraId = {spellId = 6774, rank = 2}}}, {auraIsActive = {auraId = {spellId = 399963}}}}}}}}}, castSpell = {spellId = {spellId = 13877}}}}, {action = {condition = {and = {vals = {{cmp = {op = "OpGe", lhs = {auraNumStacks = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 1214170, tag = 100}}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpLt", lhs = {currentComboPoints = {}}, rhs = {const = {val = "5"}}}}, {cmp = {op = "OpLe", lhs = {currentEnergy = {}}, rhs = {const = {val = "75"}}}}}}}, castSpell = {spellId = {spellId = 425012}}}}, {action = {condition = {or = {vals = {{and = {vals = {{not = {val = {runeIsEquipped = {runeId = {spellId = 432271}}}}}, {cmp = {op = "OpLe", lhs = {auraRemainingTime = {auraId = {spellId = 6774, rank = 2}}}, rhs = {const = {val = "1"}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "10"}}}}}}}, {and = {vals = {{runeIsEquipped = {runeId = {spellId = 432271}}}, {not = {val = {auraIsActive = {auraId = {spellId = 6774, rank = 2}}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "1"}}}}}}}}}}, castSpell = {spellId = {spellId = 6774, rank = 2}}}}, {action = {condition = {and = {vals = {{not = {val = {auraIsActive = {auraId = {spellId = 425096}}}}}, {cmp = {op = "OpGe", lhs = {currentEnergy = {}}, rhs = {const = {val = "35"}}}}, {cmp = {op = "OpEq", lhs = {currentComboPoints = {}}, rhs = {const = {val = "5"}}}}, {gcdIsReady = {}}, {cmp = {op = "OpEq", lhs = {auraNumStacks = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 1214170, tag = 100}}}, rhs = {const = {val = "5"}}}}}}}, strictSequence = {actions = {{castSpell = {spellId = {spellId = 14177}}}, {castSpell = {spellId = {spellId = 1856, rank = 1}}}, {castSpell = {spellId = {spellId = 399963}}}}, name = "someName902"}}}, {action = {condition = {or = {vals = {{cmp = {op = "OpEq", lhs = {currentComboPoints = {}}, rhs = {const = {val = "5"}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {currentEnergy = {}}, rhs = {const = {val = "25"}}}}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "3"}}}}, {cmp = {op = "OpLe", lhs = {remainingTime = {}}, rhs = {const = {val = "4"}}}}}}}}}}, castSpell = {spellId = {spellId = 399963}}}}, {hide = true, action = {condition = {or = {vals = {{and = {vals = {{cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {currentEnergy = {}}, rhs = {const = {val = "75"}}}}, {cmp = {op = "OpGe", lhs = {auraRemainingTime = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 424785}}}, rhs = {const = {val = "8"}}}}}}}, {and = {vals = {{cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {cmp = {op = "OpGe", lhs = {auraRemainingTime = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 424785}}}, rhs = {const = {val = "8"}}}}}}}, {and = {vals = {{cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {cmp = {op = "OpLe", lhs = {remainingTime = {}}, rhs = {const = {val = "4"}}}}}}}}}}, castSpell = {spellId = {spellId = 11294, rank = 8}}}}, {action = {condition = {or = {vals = {{cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {and = {vals = {{cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {currentEnergy = {}}, rhs = {const = {val = "75"}}}}}}}}}}, castSpell = {spellId = {spellId = 424785}}}}},

        -- Tracked IDs for optimization
        spells = {1787, 1856, 6774, 13877, 14177, 399963, 424785, 425012, 425096, 432276, 1214170},
        items = {7676, 233985},
        auras = {},
        runes = {432271, 432276},

        -- Optional metadata
        glyphs = {},
        lastModified = "06/12/2025",
        author = "APLParser"
    }
)

ns.AddRotationToDefaults(defaults,
    SpecializationCompat:GetSpecID("Rogue", "Assassination"),
    "Rogue Assassination - 2Target_1Min_BiS_Cleave_Mutilate_Phase8 by APLParser",
    {
        -- Required parameters
        default = true,
        enabled = true,
        experimental = false,
        gameType = Version.GAME_TYPES.CLASSIC_ERA_SOD,
        prePull = {
            { NAG:Cast(6774), -2000 }, { NAG:Cast(13877), -1000 }
        },
        rotationString = [[
((NAG:CurrentEnergy() <= 10) or ((NAG:RemainingTime() <= 20) and (NAG:CurrentEnergy() <= 40))) and NAG:Cast(7676)
    or NAG:AutocastOtherCooldowns()
    or (((not NAG:RuneIsEquipped(432276)) and (not NAG:AuraIsActive(1787))) or (NAG:RuneIsEquipped(432276) and NAG:AuraIsActive(432276, "target") and (not NAG:AuraIsActive(1787)))) and NAG:Cast(233985)
    or (((not NAG:RuneIsEquipped(432276)) and NAG:AuraIsActive(6774) and NAG:AuraIsActive(399963)) or (NAG:RuneIsEquipped(432276) and NAG:AuraIsActive(432276, "target") and NAG:AuraIsActive(6774) and NAG:AuraIsActive(399963))) and NAG:Cast(13877)
    or (((not NAG:RuneIsEquipped(432271)) and (NAG:AuraRemainingTime(6774) <= 1) and (NAG:CurrentComboPoints() >= 4) and (NAG:RemainingTime() >= 10)) or (NAG:RuneIsEquipped(432271) and (not NAG:AuraIsActive(6774)) and (NAG:CurrentComboPoints() >= 1))) and NAG:Cast(6774)
    or (NAG:RuneIsEquipped(432276) and (not NAG:AuraIsActive(432276, "target")) and (NAG:CurrentComboPoints() >= 4) and (NAG:RemainingTime() >= 5)) and NAG:Cast(412096)
    or ((not NAG:AuraIsActive(425096)) and (NAG:CurrentEnergy() >= 35) and (NAG:CurrentComboPoints() == 5) and NAG:GCDIsReady() and (NAG:AuraNumStacks(1214170, "target") == 5)) and NAG:StrictSequence("foo", NAG:Cast(14177), NAG:Cast(1856), NAG:Cast(399963))
    or ((NAG:CurrentComboPoints() >= 5) or ((NAG:CurrentComboPoints() >= 4) and (NAG:CurrentEnergy() >= 25)) or ((NAG:CurrentComboPoints() >= 3) and (NAG:RemainingTime() <= 4))) and NAG:Cast(399963)
    or (NAG:CurrentComboPoints() <= 3) and NAG:Cast(399956)
    or (((NAG:AuraNumStacks(1214170, "target") >= 4) and (NAG:CurrentComboPoints() < 5)) or (NAG:AuraRemainingTime(1214170, "target") <= 1)) and NAG:Cast(425012)
        ]],

        -- New action-based format
        --prePullActions = {{action = {addComboPoints = {numPoints = "5"}}, doAtValue = {const = {val = "-4s"}}}, {action = {activateAura = {auraId = {spellId = 1787, rank = 4}}}, doAtValue = {const = {val = "-3s"}}}, {action = {castSpell = {spellId = {spellId = 6774, rank = 2}}}, doAtValue = {const = {val = "-2s"}}}, {action = {castSpell = {spellId = {spellId = 13877}}}, doAtValue = {const = {val = "-1s"}}}, {action = {castSpell = {spellId = {itemId = 215162}}}, doAtValue = {const = {val = "-0.1s"}}}},
        --aplActions = {{action = {condition = {or = {vals = {{cmp = {op = "OpLe", lhs = {currentEnergy = {}}, rhs = {const = {val = "10"}}}}, {and = {vals = {{cmp = {op = "OpLe", lhs = {remainingTime = {}}, rhs = {const = {val = "20"}}}}, {cmp = {op = "OpLe", lhs = {currentEnergy = {}}, rhs = {const = {val = "40"}}}}}}}}}}, castSpell = {spellId = {itemId = 7676}}}}, {action = {autocastOtherCooldowns = {}}}, {action = {condition = {or = {vals = {{and = {vals = {{not = {val = {runeIsEquipped = {runeId = {spellId = 432276}}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 1787, rank = 4}}}}}}}}, {and = {vals = {{runeIsEquipped = {runeId = {spellId = 432276}}}, {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 432276}}}, {not = {val = {auraIsActive = {auraId = {spellId = 1787, rank = 4}}}}}}}}}}}, castSpell = {spellId = {itemId = 233985}}}}, {action = {condition = {or = {vals = {{and = {vals = {{not = {val = {runeIsEquipped = {runeId = {spellId = 432276}}}}}, {auraIsActive = {auraId = {spellId = 6774, rank = 2}}}, {auraIsActive = {auraId = {spellId = 399963}}}}}}, {and = {vals = {{runeIsEquipped = {runeId = {spellId = 432276}}}, {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 432276}}}, {auraIsActive = {auraId = {spellId = 6774, rank = 2}}}, {auraIsActive = {auraId = {spellId = 399963}}}}}}}}}, castSpell = {spellId = {spellId = 13877}}}}, {action = {condition = {or = {vals = {{and = {vals = {{not = {val = {runeIsEquipped = {runeId = {spellId = 432271}}}}}, {cmp = {op = "OpLe", lhs = {auraRemainingTime = {auraId = {spellId = 6774, rank = 2}}}, rhs = {const = {val = "1"}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "10"}}}}}}}, {and = {vals = {{runeIsEquipped = {runeId = {spellId = 432271}}}, {not = {val = {auraIsActive = {auraId = {spellId = 6774, rank = 2}}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "1"}}}}}}}}}}, castSpell = {spellId = {spellId = 6774, rank = 2}}}}, {action = {condition = {and = {vals = {{runeIsEquipped = {runeId = {spellId = 432276}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 432276}}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "5"}}}}}}}, castSpell = {spellId = {spellId = 412096}}}}, {action = {condition = {and = {vals = {{not = {val = {auraIsActive = {auraId = {spellId = 425096}}}}}, {cmp = {op = "OpGe", lhs = {currentEnergy = {}}, rhs = {const = {val = "35"}}}}, {cmp = {op = "OpEq", lhs = {currentComboPoints = {}}, rhs = {const = {val = "5"}}}}, {gcdIsReady = {}}, {cmp = {op = "OpEq", lhs = {auraNumStacks = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 1214170, tag = 100}}}, rhs = {const = {val = "5"}}}}}}}, strictSequence = {actions = {{castSpell = {spellId = {spellId = 14177}}}, {castSpell = {spellId = {spellId = 1856, rank = 1}}}, {castSpell = {spellId = {spellId = 399963}}}}, name = "someName847"}}}, {action = {condition = {or = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "5"}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {currentEnergy = {}}, rhs = {const = {val = "25"}}}}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "3"}}}}, {cmp = {op = "OpLe", lhs = {remainingTime = {}}, rhs = {const = {val = "4"}}}}}}}}}}, castSpell = {spellId = {spellId = 399963}}}}, {action = {condition = {cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "3"}}}}, castSpell = {spellId = {spellId = 399956}}}}, {action = {condition = {or = {vals = {{and = {vals = {{cmp = {op = "OpGe", lhs = {auraNumStacks = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 1214170, tag = 100}}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpLt", lhs = {currentComboPoints = {}}, rhs = {const = {val = "5"}}}}}}}, {cmp = {op = "OpLe", lhs = {auraRemainingTime = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 1214170, tag = 100}}}, rhs = {const = {val = "1"}}}}}}}, castSpell = {spellId = {spellId = 425012}}}}},

        -- Tracked IDs for optimization
        spells = {1787, 1856, 6774, 13877, 14177, 399956, 399963, 412096, 425012, 425096, 432276, 1214170},
        items = {7676, 233985},
        auras = {},
        runes = {432271, 432276},

        -- Optional metadata
        glyphs = {},
        lastModified = "06/12/2025",
        author = "APLParser"
    }
)

ns.AddRotationToDefaults(defaults,
    SpecializationCompat:GetSpecID("Rogue", "Subtlety"),
    "Rogue Subtlety - 2Target_1Min_Backstab_BiS_Cleave_Phase8 by APLParser",
    {
        -- Required parameters
        default = true,
        enabled = true,
        experimental = false,
        gameType = Version.GAME_TYPES.CLASSIC_ERA_SOD,
        prePull = {
            { NAG:Cast(6774), -1000 }
        },
        rotationString = [[
(((NAG:CurrentEnergy() <= 10) and (NAG:CurrentComboPoints() <= 4) and (NAG:TimeToEnergyTick() > 1)) or ((NAG:RemainingTime() <= 15) and (NAG:CurrentEnergy() <= 40) and (NAG:TimeToEnergyTick() > 1))) and NAG:Cast(7676)
    or (((NAG:CurrentEnergy() < 25) and (NAG:CurrentComboPoints() <= 4) and (NAG:TimeToEnergyTick() > 1) and (not NAG:AuraIsActive(467735)) and (not NAG:AuraIsActive(462707))) or ((NAG:RemainingTime() <= 15) and (NAG:CurrentEnergy() < 35) and (NAG:TimeToEnergyTick() > 1) and (not NAG:AuraIsActive(467735)) and (not NAG:AuraIsActive(462707)))) and NAG:Cast(231287)
    or NAG:AutocastOtherCooldowns()
    or (((not NAG:RuneIsEquipped(432276)) and (not NAG:AuraIsActive(1787))) or (NAG:RuneIsEquipped(432276) and NAG:AuraIsActive(432276, "target") and (not NAG:AuraIsActive(1787)))) and NAG:Cast(233985)
    or ((NAG:CurrentEnergy() >= 60) and NAG:AuraIsActive(467735)) and NAG:Cast(25300)
    or (((NAG:CurrentComboPoints() >= 5) and (NAG:RemainingTime() > 12) and (not NAG:AuraIsActive(436611, "target"))) or ((NAG:CurrentComboPoints() >= 3) and (NAG:RemainingTime() >= 6) and (NAG:RemainingTime() <= 12) and (not NAG:AuraIsActive(432276, "target")))) and NAG:Cast(412096)
    or (((not NAG:RuneIsEquipped(432271)) and (NAG:AuraRemainingTime(6774) <= 1) and (NAG:CurrentComboPoints() >= 4) and (NAG:RemainingTime() >= 10) and (not NAG:AuraIsActive(467735))) or (NAG:RuneIsEquipped(432271) and (not NAG:AuraIsActive(6774)) and (NAG:CurrentComboPoints() >= 1) and (not NAG:AuraIsActive(467735)))) and NAG:Cast(6774)
    or (((NAG:CurrentComboPoints() >= 5) and (NAG:RemainingTime() > 16) and (not NAG:AuraIsActive(11275, "target"))) or ((NAG:CurrentComboPoints() >= 3) and (NAG:RemainingTime() >= 10) and (NAG:RemainingTime() <= 16) and (not NAG:AuraIsActive(11275, "target")))) and NAG:Cast(11275)
    or ((NAG:AuraNumStacks(1214170, "target") >= 4) and ((NAG:CurrentComboPoints() >= 5) or ((NAG:RemainingTime() <= 4) and (NAG:CurrentComboPoints() >= 4)))) and NAG:Cast(399963)
    or ((not NAG:AuraIsActive(462707)) and (not NAG:AuraIsActive(425096)) and (NAG:CurrentEnergy() >= 35) and (NAG:CurrentComboPoints() <= 2)) and NAG:Cast(1856)
    or NAG:Cast(11269)
    or NAG:Cast(25300)
    or (not NAG:SpellIsReady(1856)) and NAG:Cast(14185)
    or (((NAG:AuraNumStacks(1214170, "target") >= 4) and (NAG:CurrentComboPoints() < 5)) or (NAG:AuraRemainingTime(1214170, "target") <= 1)) and NAG:Cast(425012)
        ]],

        -- New action-based format
        --prePullActions = {{action = {addComboPoints = {numPoints = "5"}}, doAtValue = {const = {val = "-3s"}}}, {action = {activateAura = {auraId = {spellId = 1787, rank = 4}}}, doAtValue = {const = {val = "-2s"}}}, {action = {castSpell = {spellId = {spellId = 6774, rank = 2}}}, doAtValue = {const = {val = "-1s"}}}, {action = {castSpell = {spellId = {itemId = 215162}}}, doAtValue = {const = {val = "-0.1s"}}}},
        --aplActions = {{action = {condition = {or = {vals = {{and = {vals = {{cmp = {op = "OpLe", lhs = {currentEnergy = {}}, rhs = {const = {val = "10"}}}}, {cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGt", lhs = {timeToEnergyTick = {}}, rhs = {const = {val = "1"}}}}}}}, {and = {vals = {{cmp = {op = "OpLe", lhs = {remainingTime = {}}, rhs = {const = {val = "15"}}}}, {cmp = {op = "OpLe", lhs = {currentEnergy = {}}, rhs = {const = {val = "40"}}}}, {cmp = {op = "OpGt", lhs = {timeToEnergyTick = {}}, rhs = {const = {val = "1"}}}}}}}}}}, castSpell = {spellId = {itemId = 7676}}}}, {action = {condition = {or = {vals = {{and = {vals = {{cmp = {op = "OpLt", lhs = {currentEnergy = {}}, rhs = {const = {val = "25"}}}}, {cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGt", lhs = {timeToEnergyTick = {}}, rhs = {const = {val = "1"}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 467735}}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 462707}}}}}}}}, {and = {vals = {{cmp = {op = "OpLe", lhs = {remainingTime = {}}, rhs = {const = {val = "15"}}}}, {cmp = {op = "OpLt", lhs = {currentEnergy = {}}, rhs = {const = {val = "35"}}}}, {cmp = {op = "OpGt", lhs = {timeToEnergyTick = {}}, rhs = {const = {val = "1"}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 467735}}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 462707}}}}}}}}}}}, castSpell = {spellId = {itemId = 231287}}}}, {action = {autocastOtherCooldowns = {}}}, {action = {condition = {or = {vals = {{and = {vals = {{not = {val = {runeIsEquipped = {runeId = {spellId = 432276}}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 1787, rank = 4}}}}}}}}, {and = {vals = {{runeIsEquipped = {runeId = {spellId = 432276}}}, {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 432276}}}, {not = {val = {auraIsActive = {auraId = {spellId = 1787, rank = 4}}}}}}}}}}}, castSpell = {spellId = {itemId = 233985}}}}, {action = {condition = {and = {vals = {{cmp = {op = "OpGe", lhs = {currentEnergy = {}}, rhs = {const = {val = "60"}}}}, {auraIsActive = {auraId = {spellId = 467735}}}}}}, castSpell = {spellId = {spellId = 25300, rank = 9}}}}, {action = {condition = {or = {vals = {{and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "5"}}}}, {cmp = {op = "OpGt", lhs = {remainingTime = {}}, rhs = {const = {val = "12"}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 436611}}}}}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "3"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "6"}}}}, {cmp = {op = "OpLe", lhs = {remainingTime = {}}, rhs = {const = {val = "12"}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 432276}}}}}}}}}}}, castSpell = {spellId = {spellId = 412096}}}}, {action = {condition = {or = {vals = {{and = {vals = {{not = {val = {runeIsEquipped = {runeId = {spellId = 432271}}}}}, {cmp = {op = "OpLe", lhs = {auraRemainingTime = {auraId = {spellId = 6774, rank = 2}}}, rhs = {const = {val = "1"}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "10"}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 467735}}}}}}}}, {and = {vals = {{runeIsEquipped = {runeId = {spellId = 432271}}}, {not = {val = {auraIsActive = {auraId = {spellId = 6774, rank = 2}}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "1"}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 467735}}}}}}}}}}}, castSpell = {spellId = {spellId = 6774, rank = 2}}}}, {action = {condition = {or = {vals = {{and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "5"}}}}, {cmp = {op = "OpGt", lhs = {remainingTime = {}}, rhs = {const = {val = "16"}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 11275, rank = 6}}}}}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "3"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "10"}}}}, {cmp = {op = "OpLe", lhs = {remainingTime = {}}, rhs = {const = {val = "16"}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 11275, rank = 6}}}}}}}}}}}, castSpell = {spellId = {spellId = 11275, rank = 6}}}}, {action = {condition = {and = {vals = {{cmp = {op = "OpGe", lhs = {auraNumStacks = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 1214170, tag = 100}}}, rhs = {const = {val = "4"}}}}, {or = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "5"}}}}, {and = {vals = {{cmp = {op = "OpLe", lhs = {remainingTime = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}}}}}}}}}}, castSpell = {spellId = {spellId = 399963}}}}, {action = {condition = {and = {vals = {{not = {val = {auraIsActive = {auraId = {spellId = 462707}}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 425096}}}}}, {cmp = {op = "OpGe", lhs = {currentEnergy = {}}, rhs = {const = {val = "35"}}}}, {cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}}}}, castSpell = {spellId = {spellId = 1856, rank = 1}}}}, {action = {castSpell = {spellId = {spellId = 11269, rank = 6}}}}, {action = {castSpell = {spellId = {spellId = 25300, rank = 9}}}}, {action = {condition = {not = {val = {spellIsReady = {spellId = {spellId = 1856, rank = 1}}}}}, castSpell = {spellId = {spellId = 14185}}}}, {action = {condition = {or = {vals = {{and = {vals = {{cmp = {op = "OpGe", lhs = {auraNumStacks = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 1214170, tag = 100}}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpLt", lhs = {currentComboPoints = {}}, rhs = {const = {val = "5"}}}}}}}, {cmp = {op = "OpLe", lhs = {auraRemainingTime = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 1214170, tag = 100}}}, rhs = {const = {val = "1"}}}}}}}, castSpell = {spellId = {spellId = 425012}}}}},

        -- Tracked IDs for optimization
        spells = {1787, 1856, 6774, 11269, 11275, 14185, 25300, 399963, 412096, 425012, 425096, 432276, 436611, 462707, 467735, 1214170},
        items = {7676, 231287, 233985},
        auras = {},
        runes = {432271, 432276},

        -- Optional metadata
        glyphs = {},
        lastModified = "06/12/2025",
        author = "APLParser"
    }
)

ns.AddRotationToDefaults(defaults,
    SpecializationCompat:GetSpecID("Rogue", "Assassination"),
    "Rogue Assassination - 3Target_1Min_BiS_Cleave_Phase8_SaberSlash by APLParser",
    {
        -- Required parameters
        default = true,
        enabled = true,
        experimental = false,
        gameType = Version.GAME_TYPES.CLASSIC_ERA_SOD,
        prePull = {
            { NAG:Cast(6774), -2000 }, { NAG:Cast(13877), -1000 }
        },
        rotationString = [[
((NAG:CurrentEnergy() <= 10) or ((NAG:RemainingTime() <= 15) and (NAG:CurrentEnergy() <= 40))) and NAG:Cast(7676)
    or NAG:AutocastOtherCooldowns()
    or (((not NAG:RuneIsEquipped(432276)) and (not NAG:AuraIsActive(1787))) or (NAG:RuneIsEquipped(432276) and (not NAG:AuraIsActive(1787)) and NAG:AuraIsActive(432276, "target"))) and NAG:Cast(233985)
    or ((NAG:CurrentComboPoints() <= 4) and ((NAG:AuraNumStacks(424785, "target") < 3) or (NAG:AuraRemainingTime(424785, "target") < 2)) and (NAG:AuraRemainingTime(424785, "target") < (NAG:RemainingTime() + 2))) and NAG:Cast(424785)
    or (((not NAG:RuneIsEquipped(432276)) and NAG:AuraIsActive(6774) and NAG:AuraIsActive(399963)) or (NAG:RuneIsEquipped(432276) and NAG:AuraIsActive(432276, "target") and NAG:AuraIsActive(6774) and NAG:AuraIsActive(399963))) and NAG:Cast(13877)
    or ((NAG:AuraNumStacks(1214170, "target") >= 4) and (NAG:CurrentComboPoints() < 5) and (NAG:CurrentEnergy() <= 75)) and NAG:Cast(425012)
    or (((not NAG:RuneIsEquipped(432271)) and (NAG:AuraRemainingTime(6774) <= 1) and (NAG:CurrentComboPoints() >= 4) and (NAG:RemainingTime() >= 10)) or (NAG:RuneIsEquipped(432271) and (not NAG:AuraIsActive(6774)) and (NAG:CurrentComboPoints() >= 1))) and NAG:Cast(6774)
    or ((not NAG:AuraIsActive(425096)) and (NAG:CurrentEnergy() >= 35) and (NAG:CurrentComboPoints() == 5) and NAG:GCDIsReady() and (NAG:AuraNumStacks(1214170, "target") == 5)) and NAG:StrictSequence("foo", NAG:Cast(14177), NAG:Cast(1856), NAG:Cast(399963))
    or ((NAG:CurrentComboPoints() == 5) or ((NAG:CurrentComboPoints() >= 4) and (NAG:CurrentEnergy() >= 25)) or ((NAG:CurrentComboPoints() >= 3) and (NAG:RemainingTime() <= 4))) and NAG:Cast(399963)
    or ((NAG:CurrentComboPoints() <= 2) or ((NAG:CurrentComboPoints() <= 4) and (NAG:CurrentEnergy() >= 75))) and NAG:Cast(424785)
        ]],

        -- New action-based format
        --prePullActions = {{action = {addComboPoints = {numPoints = "5"}}, doAtValue = {const = {val = "-4s"}}}, {action = {activateAura = {auraId = {spellId = 1787, rank = 4}}}, doAtValue = {const = {val = "-3s"}}}, {action = {castSpell = {spellId = {spellId = 6774, rank = 2}}}, doAtValue = {const = {val = "-2s"}}}, {action = {castSpell = {spellId = {spellId = 13877}}}, doAtValue = {const = {val = "-1s"}}}, {action = {castSpell = {spellId = {itemId = 215162}}}, doAtValue = {const = {val = "-0.1s"}}}},
        --aplActions = {{action = {condition = {or = {vals = {{cmp = {op = "OpLe", lhs = {currentEnergy = {}}, rhs = {const = {val = "10"}}}}, {and = {vals = {{cmp = {op = "OpLe", lhs = {remainingTime = {}}, rhs = {const = {val = "15"}}}}, {cmp = {op = "OpLe", lhs = {currentEnergy = {}}, rhs = {const = {val = "40"}}}}}}}}}}, castSpell = {spellId = {itemId = 7676}}}}, {action = {autocastOtherCooldowns = {}}}, {action = {condition = {or = {vals = {{and = {vals = {{not = {val = {runeIsEquipped = {runeId = {spellId = 432276}}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 1787, rank = 4}}}}}}}}, {and = {vals = {{runeIsEquipped = {runeId = {spellId = 432276}}}, {not = {val = {auraIsActive = {auraId = {spellId = 1787, rank = 4}}}}}, {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 432276}}}}}}}}}, castSpell = {spellId = {itemId = 233985}}}}, {action = {condition = {and = {vals = {{cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {or = {vals = {{cmp = {op = "OpLt", lhs = {auraNumStacks = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 424785}}}, rhs = {const = {val = "3"}}}}, {cmp = {op = "OpLt", lhs = {auraRemainingTime = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 424785}}}, rhs = {const = {val = "2"}}}}}}}, {cmp = {op = "OpLt", lhs = {auraRemainingTime = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 424785}}}, rhs = {math = {op = "OpAdd", lhs = {remainingTime = {}}, rhs = {const = {val = "2"}}}}}}}}}, castSpell = {spellId = {spellId = 424785}}}}, {action = {condition = {or = {vals = {{and = {vals = {{not = {val = {runeIsEquipped = {runeId = {spellId = 432276}}}}}, {auraIsActive = {auraId = {spellId = 6774, rank = 2}}}, {auraIsActive = {auraId = {spellId = 399963}}}}}}, {and = {vals = {{runeIsEquipped = {runeId = {spellId = 432276}}}, {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 432276}}}, {auraIsActive = {auraId = {spellId = 6774, rank = 2}}}, {auraIsActive = {auraId = {spellId = 399963}}}}}}}}}, castSpell = {spellId = {spellId = 13877}}}}, {action = {condition = {and = {vals = {{cmp = {op = "OpGe", lhs = {auraNumStacks = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 1214170, tag = 100}}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpLt", lhs = {currentComboPoints = {}}, rhs = {const = {val = "5"}}}}, {cmp = {op = "OpLe", lhs = {currentEnergy = {}}, rhs = {const = {val = "75"}}}}}}}, castSpell = {spellId = {spellId = 425012}}}}, {action = {condition = {or = {vals = {{and = {vals = {{not = {val = {runeIsEquipped = {runeId = {spellId = 432271}}}}}, {cmp = {op = "OpLe", lhs = {auraRemainingTime = {auraId = {spellId = 6774, rank = 2}}}, rhs = {const = {val = "1"}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "10"}}}}}}}, {and = {vals = {{runeIsEquipped = {runeId = {spellId = 432271}}}, {not = {val = {auraIsActive = {auraId = {spellId = 6774, rank = 2}}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "1"}}}}}}}}}}, castSpell = {spellId = {spellId = 6774, rank = 2}}}}, {action = {condition = {and = {vals = {{not = {val = {auraIsActive = {auraId = {spellId = 425096}}}}}, {cmp = {op = "OpGe", lhs = {currentEnergy = {}}, rhs = {const = {val = "35"}}}}, {cmp = {op = "OpEq", lhs = {currentComboPoints = {}}, rhs = {const = {val = "5"}}}}, {gcdIsReady = {}}, {cmp = {op = "OpEq", lhs = {auraNumStacks = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 1214170, tag = 100}}}, rhs = {const = {val = "5"}}}}}}}, strictSequence = {actions = {{castSpell = {spellId = {spellId = 14177}}}, {castSpell = {spellId = {spellId = 1856, rank = 1}}}, {castSpell = {spellId = {spellId = 399963}}}}, name = "someName120"}}}, {action = {condition = {or = {vals = {{cmp = {op = "OpEq", lhs = {currentComboPoints = {}}, rhs = {const = {val = "5"}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {currentEnergy = {}}, rhs = {const = {val = "25"}}}}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "3"}}}}, {cmp = {op = "OpLe", lhs = {remainingTime = {}}, rhs = {const = {val = "4"}}}}}}}}}}, castSpell = {spellId = {spellId = 399963}}}}, {hide = true, action = {condition = {or = {vals = {{and = {vals = {{cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {currentEnergy = {}}, rhs = {const = {val = "75"}}}}, {cmp = {op = "OpGe", lhs = {auraRemainingTime = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 424785}}}, rhs = {const = {val = "8"}}}}}}}, {and = {vals = {{cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {cmp = {op = "OpGe", lhs = {auraRemainingTime = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 424785}}}, rhs = {const = {val = "8"}}}}}}}, {and = {vals = {{cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {cmp = {op = "OpLe", lhs = {remainingTime = {}}, rhs = {const = {val = "4"}}}}}}}}}}, castSpell = {spellId = {spellId = 11294, rank = 8}}}}, {action = {condition = {or = {vals = {{cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}, {and = {vals = {{cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {currentEnergy = {}}, rhs = {const = {val = "75"}}}}}}}}}}, castSpell = {spellId = {spellId = 424785}}}}},

        -- Tracked IDs for optimization
        spells = {1787, 1856, 6774, 13877, 14177, 399963, 424785, 425012, 425096, 432276, 1214170},
        items = {7676, 233985},
        auras = {},
        runes = {432271, 432276},

        -- Optional metadata
        glyphs = {},
        lastModified = "06/12/2025",
        author = "APLParser"
    }
)

ns.AddRotationToDefaults(defaults,
    SpecializationCompat:GetSpecID("Rogue", "Assassination"),
    "Rogue Assassination - 3Target_1Min_BiS_Cleave_Mutilate_Phase8 by APLParser",
    {
        -- Required parameters
        default = true,
        enabled = true,
        experimental = false,
        gameType = Version.GAME_TYPES.CLASSIC_ERA_SOD,
        prePull = {
            { NAG:Cast(6774), -2000 }, { NAG:Cast(13877), -1000 }
        },
        rotationString = [[
((NAG:CurrentEnergy() <= 10) or ((NAG:RemainingTime() <= 20) and (NAG:CurrentEnergy() <= 40))) and NAG:Cast(7676)
    or NAG:AutocastOtherCooldowns()
    or (((not NAG:RuneIsEquipped(432276)) and (not NAG:AuraIsActive(1787))) or (NAG:RuneIsEquipped(432276) and NAG:AuraIsActive(432276, "target") and (not NAG:AuraIsActive(1787)))) and NAG:Cast(233985)
    or (((not NAG:RuneIsEquipped(432276)) and NAG:AuraIsActive(6774) and NAG:AuraIsActive(399963)) or (NAG:RuneIsEquipped(432276) and NAG:AuraIsActive(432276, "target") and NAG:AuraIsActive(6774) and NAG:AuraIsActive(399963))) and NAG:Cast(13877)
    or (((not NAG:RuneIsEquipped(432271)) and (NAG:AuraRemainingTime(6774) <= 1) and (NAG:CurrentComboPoints() >= 4) and (NAG:RemainingTime() >= 10)) or (NAG:RuneIsEquipped(432271) and (not NAG:AuraIsActive(6774)) and (NAG:CurrentComboPoints() >= 1))) and NAG:Cast(6774)
    or (NAG:RuneIsEquipped(432276) and (not NAG:AuraIsActive(432276, "target")) and (NAG:CurrentComboPoints() >= 4) and (NAG:RemainingTime() >= 5)) and NAG:Cast(412096)
    or ((not NAG:AuraIsActive(425096)) and (NAG:CurrentEnergy() >= 35) and (NAG:CurrentComboPoints() == 5) and NAG:GCDIsReady() and (NAG:AuraNumStacks(1214170, "target") == 5)) and NAG:StrictSequence("foo", NAG:Cast(14177), NAG:Cast(1856), NAG:Cast(399963))
    or ((NAG:CurrentComboPoints() >= 5) or ((NAG:CurrentComboPoints() >= 4) and (NAG:CurrentEnergy() >= 25)) or ((NAG:CurrentComboPoints() >= 3) and (NAG:RemainingTime() <= 4))) and NAG:Cast(399963)
    or (NAG:CurrentComboPoints() <= 3) and NAG:Cast(399956)
    or (((NAG:AuraNumStacks(1214170, "target") >= 4) and (NAG:CurrentComboPoints() < 5)) or (NAG:AuraRemainingTime(1214170, "target") <= 1)) and NAG:Cast(425012)
        ]],

        -- New action-based format
        --prePullActions = {{action = {addComboPoints = {numPoints = "5"}}, doAtValue = {const = {val = "-4s"}}}, {action = {activateAura = {auraId = {spellId = 1787, rank = 4}}}, doAtValue = {const = {val = "-3s"}}}, {action = {castSpell = {spellId = {spellId = 6774, rank = 2}}}, doAtValue = {const = {val = "-2s"}}}, {action = {castSpell = {spellId = {spellId = 13877}}}, doAtValue = {const = {val = "-1s"}}}, {action = {castSpell = {spellId = {itemId = 215162}}}, doAtValue = {const = {val = "-0.1s"}}}},
        --aplActions = {{action = {condition = {or = {vals = {{cmp = {op = "OpLe", lhs = {currentEnergy = {}}, rhs = {const = {val = "10"}}}}, {and = {vals = {{cmp = {op = "OpLe", lhs = {remainingTime = {}}, rhs = {const = {val = "20"}}}}, {cmp = {op = "OpLe", lhs = {currentEnergy = {}}, rhs = {const = {val = "40"}}}}}}}}}}, castSpell = {spellId = {itemId = 7676}}}}, {action = {autocastOtherCooldowns = {}}}, {action = {condition = {or = {vals = {{and = {vals = {{not = {val = {runeIsEquipped = {runeId = {spellId = 432276}}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 1787, rank = 4}}}}}}}}, {and = {vals = {{runeIsEquipped = {runeId = {spellId = 432276}}}, {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 432276}}}, {not = {val = {auraIsActive = {auraId = {spellId = 1787, rank = 4}}}}}}}}}}}, castSpell = {spellId = {itemId = 233985}}}}, {action = {condition = {or = {vals = {{and = {vals = {{not = {val = {runeIsEquipped = {runeId = {spellId = 432276}}}}}, {auraIsActive = {auraId = {spellId = 6774, rank = 2}}}, {auraIsActive = {auraId = {spellId = 399963}}}}}}, {and = {vals = {{runeIsEquipped = {runeId = {spellId = 432276}}}, {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 432276}}}, {auraIsActive = {auraId = {spellId = 6774, rank = 2}}}, {auraIsActive = {auraId = {spellId = 399963}}}}}}}}}, castSpell = {spellId = {spellId = 13877}}}}, {action = {condition = {or = {vals = {{and = {vals = {{not = {val = {runeIsEquipped = {runeId = {spellId = 432271}}}}}, {cmp = {op = "OpLe", lhs = {auraRemainingTime = {auraId = {spellId = 6774, rank = 2}}}, rhs = {const = {val = "1"}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "10"}}}}}}}, {and = {vals = {{runeIsEquipped = {runeId = {spellId = 432271}}}, {not = {val = {auraIsActive = {auraId = {spellId = 6774, rank = 2}}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "1"}}}}}}}}}}, castSpell = {spellId = {spellId = 6774, rank = 2}}}}, {action = {condition = {and = {vals = {{runeIsEquipped = {runeId = {spellId = 432276}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 432276}}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "5"}}}}}}}, castSpell = {spellId = {spellId = 412096}}}}, {action = {condition = {and = {vals = {{not = {val = {auraIsActive = {auraId = {spellId = 425096}}}}}, {cmp = {op = "OpGe", lhs = {currentEnergy = {}}, rhs = {const = {val = "35"}}}}, {cmp = {op = "OpEq", lhs = {currentComboPoints = {}}, rhs = {const = {val = "5"}}}}, {gcdIsReady = {}}, {cmp = {op = "OpEq", lhs = {auraNumStacks = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 1214170, tag = 100}}}, rhs = {const = {val = "5"}}}}}}}, strictSequence = {actions = {{castSpell = {spellId = {spellId = 14177}}}, {castSpell = {spellId = {spellId = 1856, rank = 1}}}, {castSpell = {spellId = {spellId = 399963}}}}, name = "someName425"}}}, {action = {condition = {or = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "5"}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {currentEnergy = {}}, rhs = {const = {val = "25"}}}}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "3"}}}}, {cmp = {op = "OpLe", lhs = {remainingTime = {}}, rhs = {const = {val = "4"}}}}}}}}}}, castSpell = {spellId = {spellId = 399963}}}}, {action = {condition = {cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "3"}}}}, castSpell = {spellId = {spellId = 399956}}}}, {action = {condition = {or = {vals = {{and = {vals = {{cmp = {op = "OpGe", lhs = {auraNumStacks = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 1214170, tag = 100}}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpLt", lhs = {currentComboPoints = {}}, rhs = {const = {val = "5"}}}}}}}, {cmp = {op = "OpLe", lhs = {auraRemainingTime = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 1214170, tag = 100}}}, rhs = {const = {val = "1"}}}}}}}, castSpell = {spellId = {spellId = 425012}}}}},

        -- Tracked IDs for optimization
        spells = {1787, 1856, 6774, 13877, 14177, 399956, 399963, 412096, 425012, 425096, 432276, 1214170},
        items = {7676, 233985},
        auras = {},
        runes = {432271, 432276},

        -- Optional metadata
        glyphs = {},
        lastModified = "06/12/2025",
        author = "APLParser"
    }
)

ns.AddRotationToDefaults(defaults,
    SpecializationCompat:GetSpecID("Rogue", "Subtlety"),
    "Rogue Subtlety - 3Target_1Min_Backstab_BiS_Cleave_Phase8 by APLParser",
    {
        -- Required parameters
        default = true,
        enabled = true,
        experimental = false,
        gameType = Version.GAME_TYPES.CLASSIC_ERA_SOD,
        prePull = {
            { NAG:Cast(6774), -1000 }
        },
        rotationString = [[
(((NAG:CurrentEnergy() <= 10) and (NAG:CurrentComboPoints() <= 4) and (NAG:TimeToEnergyTick() > 1)) or ((NAG:RemainingTime() <= 15) and (NAG:CurrentEnergy() <= 40) and (NAG:TimeToEnergyTick() > 1))) and NAG:Cast(7676)
    or (((NAG:CurrentEnergy() < 25) and (NAG:CurrentComboPoints() <= 4) and (NAG:TimeToEnergyTick() > 1) and (not NAG:AuraIsActive(467735)) and (not NAG:AuraIsActive(462707))) or ((NAG:RemainingTime() <= 15) and (NAG:CurrentEnergy() < 35) and (NAG:TimeToEnergyTick() > 1) and (not NAG:AuraIsActive(467735)) and (not NAG:AuraIsActive(462707)))) and NAG:Cast(231287)
    or NAG:AutocastOtherCooldowns()
    or (((not NAG:RuneIsEquipped(432276)) and (not NAG:AuraIsActive(1787))) or (NAG:RuneIsEquipped(432276) and NAG:AuraIsActive(432276, "target") and (not NAG:AuraIsActive(1787)))) and NAG:Cast(233985)
    or ((NAG:CurrentEnergy() >= 60) and NAG:AuraIsActive(467735)) and NAG:Cast(25300)
    or (((NAG:CurrentComboPoints() >= 5) and (NAG:RemainingTime() > 12) and (not NAG:AuraIsActive(436611, "target"))) or ((NAG:CurrentComboPoints() >= 3) and (NAG:RemainingTime() >= 6) and (NAG:RemainingTime() <= 12) and (not NAG:AuraIsActive(432276, "target")))) and NAG:Cast(412096)
    or (((not NAG:RuneIsEquipped(432271)) and (NAG:AuraRemainingTime(6774) <= 1) and (NAG:CurrentComboPoints() >= 4) and (NAG:RemainingTime() >= 10) and (not NAG:AuraIsActive(467735))) or (NAG:RuneIsEquipped(432271) and (not NAG:AuraIsActive(6774)) and (NAG:CurrentComboPoints() >= 1) and (not NAG:AuraIsActive(467735)))) and NAG:Cast(6774)
    or (((NAG:CurrentComboPoints() >= 5) and (NAG:RemainingTime() > 16) and (not NAG:AuraIsActive(11275, "target"))) or ((NAG:CurrentComboPoints() >= 3) and (NAG:RemainingTime() >= 10) and (NAG:RemainingTime() <= 16) and (not NAG:AuraIsActive(11275, "target")))) and NAG:Cast(11275)
    or ((NAG:AuraNumStacks(1214170, "target") >= 4) and ((NAG:CurrentComboPoints() >= 5) or ((NAG:RemainingTime() <= 4) and (NAG:CurrentComboPoints() >= 4)))) and NAG:Cast(399963)
    or ((not NAG:AuraIsActive(462707)) and (not NAG:AuraIsActive(425096)) and (NAG:CurrentEnergy() >= 35) and (NAG:CurrentComboPoints() <= 2)) and NAG:Cast(1856)
    or NAG:Cast(11269)
    or NAG:Cast(25300)
    or (not NAG:SpellIsReady(1856)) and NAG:Cast(14185)
    or (((NAG:AuraNumStacks(1214170, "target") >= 4) and (NAG:CurrentComboPoints() < 5)) or (NAG:AuraRemainingTime(1214170, "target") <= 1)) and NAG:Cast(425012)
        ]],

        -- New action-based format
        --prePullActions = {{action = {addComboPoints = {numPoints = "5"}}, doAtValue = {const = {val = "-3s"}}}, {action = {activateAura = {auraId = {spellId = 1787, rank = 4}}}, doAtValue = {const = {val = "-2s"}}}, {action = {castSpell = {spellId = {spellId = 6774, rank = 2}}}, doAtValue = {const = {val = "-1s"}}}, {action = {castSpell = {spellId = {itemId = 215162}}}, doAtValue = {const = {val = "-0.1s"}}}},
        --aplActions = {{action = {condition = {or = {vals = {{and = {vals = {{cmp = {op = "OpLe", lhs = {currentEnergy = {}}, rhs = {const = {val = "10"}}}}, {cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGt", lhs = {timeToEnergyTick = {}}, rhs = {const = {val = "1"}}}}}}}, {and = {vals = {{cmp = {op = "OpLe", lhs = {remainingTime = {}}, rhs = {const = {val = "15"}}}}, {cmp = {op = "OpLe", lhs = {currentEnergy = {}}, rhs = {const = {val = "40"}}}}, {cmp = {op = "OpGt", lhs = {timeToEnergyTick = {}}, rhs = {const = {val = "1"}}}}}}}}}}, castSpell = {spellId = {itemId = 7676}}}}, {action = {condition = {or = {vals = {{and = {vals = {{cmp = {op = "OpLt", lhs = {currentEnergy = {}}, rhs = {const = {val = "25"}}}}, {cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGt", lhs = {timeToEnergyTick = {}}, rhs = {const = {val = "1"}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 467735}}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 462707}}}}}}}}, {and = {vals = {{cmp = {op = "OpLe", lhs = {remainingTime = {}}, rhs = {const = {val = "15"}}}}, {cmp = {op = "OpLt", lhs = {currentEnergy = {}}, rhs = {const = {val = "35"}}}}, {cmp = {op = "OpGt", lhs = {timeToEnergyTick = {}}, rhs = {const = {val = "1"}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 467735}}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 462707}}}}}}}}}}}, castSpell = {spellId = {itemId = 231287}}}}, {action = {autocastOtherCooldowns = {}}}, {action = {condition = {or = {vals = {{and = {vals = {{not = {val = {runeIsEquipped = {runeId = {spellId = 432276}}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 1787, rank = 4}}}}}}}}, {and = {vals = {{runeIsEquipped = {runeId = {spellId = 432276}}}, {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 432276}}}, {not = {val = {auraIsActive = {auraId = {spellId = 1787, rank = 4}}}}}}}}}}}, castSpell = {spellId = {itemId = 233985}}}}, {action = {condition = {and = {vals = {{cmp = {op = "OpGe", lhs = {currentEnergy = {}}, rhs = {const = {val = "60"}}}}, {auraIsActive = {auraId = {spellId = 467735}}}}}}, castSpell = {spellId = {spellId = 25300, rank = 9}}}}, {action = {condition = {or = {vals = {{and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "5"}}}}, {cmp = {op = "OpGt", lhs = {remainingTime = {}}, rhs = {const = {val = "12"}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 436611}}}}}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "3"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "6"}}}}, {cmp = {op = "OpLe", lhs = {remainingTime = {}}, rhs = {const = {val = "12"}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 432276}}}}}}}}}}}, castSpell = {spellId = {spellId = 412096}}}}, {action = {condition = {or = {vals = {{and = {vals = {{not = {val = {runeIsEquipped = {runeId = {spellId = 432271}}}}}, {cmp = {op = "OpLe", lhs = {auraRemainingTime = {auraId = {spellId = 6774, rank = 2}}}, rhs = {const = {val = "1"}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "10"}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 467735}}}}}}}}, {and = {vals = {{runeIsEquipped = {runeId = {spellId = 432271}}}, {not = {val = {auraIsActive = {auraId = {spellId = 6774, rank = 2}}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "1"}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 467735}}}}}}}}}}}, castSpell = {spellId = {spellId = 6774, rank = 2}}}}, {action = {condition = {or = {vals = {{and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "5"}}}}, {cmp = {op = "OpGt", lhs = {remainingTime = {}}, rhs = {const = {val = "16"}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 11275, rank = 6}}}}}}}}, {and = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "3"}}}}, {cmp = {op = "OpGe", lhs = {remainingTime = {}}, rhs = {const = {val = "10"}}}}, {cmp = {op = "OpLe", lhs = {remainingTime = {}}, rhs = {const = {val = "16"}}}}, {not = {val = {auraIsActive = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 11275, rank = 6}}}}}}}}}}}, castSpell = {spellId = {spellId = 11275, rank = 6}}}}, {action = {condition = {and = {vals = {{cmp = {op = "OpGe", lhs = {auraNumStacks = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 1214170, tag = 100}}}, rhs = {const = {val = "4"}}}}, {or = {vals = {{cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "5"}}}}, {and = {vals = {{cmp = {op = "OpLe", lhs = {remainingTime = {}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpGe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "4"}}}}}}}}}}}}}, castSpell = {spellId = {spellId = 399963}}}}, {action = {condition = {and = {vals = {{not = {val = {auraIsActive = {auraId = {spellId = 462707}}}}}, {not = {val = {auraIsActive = {auraId = {spellId = 425096}}}}}, {cmp = {op = "OpGe", lhs = {currentEnergy = {}}, rhs = {const = {val = "35"}}}}, {cmp = {op = "OpLe", lhs = {currentComboPoints = {}}, rhs = {const = {val = "2"}}}}}}}, castSpell = {spellId = {spellId = 1856, rank = 1}}}}, {action = {castSpell = {spellId = {spellId = 11269, rank = 6}}}}, {action = {castSpell = {spellId = {spellId = 25300, rank = 9}}}}, {action = {condition = {not = {val = {spellIsReady = {spellId = {spellId = 1856, rank = 1}}}}}, castSpell = {spellId = {spellId = 14185}}}}, {action = {condition = {or = {vals = {{and = {vals = {{cmp = {op = "OpGe", lhs = {auraNumStacks = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 1214170, tag = 100}}}, rhs = {const = {val = "4"}}}}, {cmp = {op = "OpLt", lhs = {currentComboPoints = {}}, rhs = {const = {val = "5"}}}}}}}, {cmp = {op = "OpLe", lhs = {auraRemainingTime = {sourceUnit = {type = "CurrentTarget"}, auraId = {spellId = 1214170, tag = 100}}}, rhs = {const = {val = "1"}}}}}}}, castSpell = {spellId = {spellId = 425012}}}}},

        -- Tracked IDs for optimization
        spells = {1787, 1856, 6774, 11269, 11275, 14185, 25300, 399963, 412096, 425012, 425096, 432276, 436611, 462707, 467735, 1214170},
        items = {7676, 231287, 233985},
        auras = {},
        runes = {432271, 432276},

        -- Optional metadata
        glyphs = {},
        lastModified = "06/12/2025",
        author = "APLParser"
    }
)

--- @class ROGUE : ClassBase
local ROGUE = NAG:CreateClassModule("ROGUE", defaults)

if not ROGUE then return end
NAG.Class = ROGUE
